<html><head><meta http-equiv="Content-Type" content="text/html; charset=utf-8"/><title>MPI</title><style>
/* cspell:disable-file */
/* webkit printing magic: print all background colors */
html {
	-webkit-print-color-adjust: exact;
}
* {
	box-sizing: border-box;
	-webkit-print-color-adjust: exact;
}

html,
body {
	margin: 0;
	padding: 0;
}
@media only screen {
	body {
		margin: 2em auto;
		max-width: 900px;
		color: rgb(55, 53, 47);
	}
}

body {
	line-height: 1.5;
	white-space: pre-wrap;
}

a,
a.visited {
	color: inherit;
	text-decoration: underline;
}

.pdf-relative-link-path {
	font-size: 80%;
	color: #444;
}

h1,
h2,
h3 {
	letter-spacing: -0.01em;
	line-height: 1.2;
	font-weight: 600;
	margin-bottom: 0;
}

.page-title {
	font-size: 2.5rem;
	font-weight: 700;
	margin-top: 0;
	margin-bottom: 0.75em;
}

h1 {
	font-size: 1.875rem;
	margin-top: 1.875rem;
}

h2 {
	font-size: 1.5rem;
	margin-top: 1.5rem;
}

h3 {
	font-size: 1.25rem;
	margin-top: 1.25rem;
}

.source {
	border: 1px solid #ddd;
	border-radius: 3px;
	padding: 1.5em;
	word-break: break-all;
}

.callout {
	border-radius: 3px;
	padding: 1rem;
}

figure {
	margin: 1.25em 0;
	page-break-inside: avoid;
}

figcaption {
	opacity: 0.5;
	font-size: 85%;
	margin-top: 0.5em;
}

mark {
	background-color: transparent;
}

.indented {
	padding-left: 1.5em;
}

hr {
	background: transparent;
	display: block;
	width: 100%;
	height: 1px;
	visibility: visible;
	border: none;
	border-bottom: 1px solid rgba(55, 53, 47, 0.09);
}

img {
	max-width: 100%;
}

@media only print {
	img {
		max-height: 100vh;
		object-fit: contain;
	}
}

@page {
	margin: 1in;
}

.collection-content {
	font-size: 0.875rem;
}

.column-list {
	display: flex;
	justify-content: space-between;
}

.column {
	padding: 0 1em;
}

.column:first-child {
	padding-left: 0;
}

.column:last-child {
	padding-right: 0;
}

.table_of_contents-item {
	display: block;
	font-size: 0.875rem;
	line-height: 1.3;
	padding: 0.125rem;
}

.table_of_contents-indent-1 {
	margin-left: 1.5rem;
}

.table_of_contents-indent-2 {
	margin-left: 3rem;
}

.table_of_contents-indent-3 {
	margin-left: 4.5rem;
}

.table_of_contents-link {
	text-decoration: none;
	opacity: 0.7;
	border-bottom: 1px solid rgba(55, 53, 47, 0.18);
}

table,
th,
td {
	border: 1px solid rgba(55, 53, 47, 0.09);
	border-collapse: collapse;
}

table {
	border-left: none;
	border-right: none;
}

th,
td {
	font-weight: normal;
	padding: 0.25em 0.5em;
	line-height: 1.5;
	min-height: 1.5em;
	text-align: left;
}

th {
	color: rgba(55, 53, 47, 0.6);
}

ol,
ul {
	margin: 0;
	margin-block-start: 0.6em;
	margin-block-end: 0.6em;
}

li > ol:first-child,
li > ul:first-child {
	margin-block-start: 0.6em;
}

ul > li {
	list-style: disc;
}

ul.to-do-list {
	text-indent: -1.7em;
}

ul.to-do-list > li {
	list-style: none;
}

.to-do-children-checked {
	text-decoration: line-through;
	opacity: 0.375;
}

ul.toggle > li {
	list-style: none;
}

ul {
	padding-inline-start: 1.7em;
}

ul > li {
	padding-left: 0.1em;
}

ol {
	padding-inline-start: 1.6em;
}

ol > li {
	padding-left: 0.2em;
}

.mono ol {
	padding-inline-start: 2em;
}

.mono ol > li {
	text-indent: -0.4em;
}

.toggle {
	padding-inline-start: 0em;
	list-style-type: none;
}

/* Indent toggle children */
.toggle > li > details {
	padding-left: 1.7em;
}

.toggle > li > details > summary {
	margin-left: -1.1em;
}

.selected-value {
	display: inline-block;
	padding: 0 0.5em;
	background: rgba(206, 205, 202, 0.5);
	border-radius: 3px;
	margin-right: 0.5em;
	margin-top: 0.3em;
	margin-bottom: 0.3em;
	white-space: nowrap;
}

.collection-title {
	display: inline-block;
	margin-right: 1em;
}

.simple-table {
	margin-top: 1em;
	font-size: 0.875rem;
	empty-cells: show;
}
.simple-table td {
	height: 29px;
	min-width: 120px;
}

.simple-table th {
	height: 29px;
	min-width: 120px;
}

.simple-table-header-color {
	background: rgb(247, 246, 243);
	color: black;
}
.simple-table-header {
	font-weight: 500;
}

time {
	opacity: 0.5;
}

.icon {
	display: inline-block;
	max-width: 1.2em;
	max-height: 1.2em;
	text-decoration: none;
	vertical-align: text-bottom;
	margin-right: 0.5em;
}

img.icon {
	border-radius: 3px;
}

.user-icon {
	width: 1.5em;
	height: 1.5em;
	border-radius: 100%;
	margin-right: 0.5rem;
}

.user-icon-inner {
	font-size: 0.8em;
}

.text-icon {
	border: 1px solid #000;
	text-align: center;
}

.page-cover-image {
	display: block;
	object-fit: cover;
	width: 100%;
	max-height: 30vh;
}

.page-header-icon {
	font-size: 3rem;
	margin-bottom: 1rem;
}

.page-header-icon-with-cover {
	margin-top: -0.72em;
	margin-left: 0.07em;
}

.page-header-icon img {
	border-radius: 3px;
}

.link-to-page {
	margin: 1em 0;
	padding: 0;
	border: none;
	font-weight: 500;
}

p > .user {
	opacity: 0.5;
}

td > .user,
td > time {
	white-space: nowrap;
}

input[type="checkbox"] {
	transform: scale(1.5);
	margin-right: 0.6em;
	vertical-align: middle;
}

p {
	margin-top: 0.5em;
	margin-bottom: 0.5em;
}

.image {
	border: none;
	margin: 1.5em 0;
	padding: 0;
	border-radius: 0;
	text-align: center;
}

.code,
code {
	background: rgba(135, 131, 120, 0.15);
	border-radius: 3px;
	padding: 0.2em 0.4em;
	border-radius: 3px;
	font-size: 85%;
	tab-size: 2;
}

code {
	color: #eb5757;
}

.code {
	padding: 1.5em 1em;
}

.code-wrap {
	white-space: pre-wrap;
	word-break: break-all;
}

.code > code {
	background: none;
	padding: 0;
	font-size: 100%;
	color: inherit;
}

blockquote {
	font-size: 1.25em;
	margin: 1em 0;
	padding-left: 1em;
	border-left: 3px solid rgb(55, 53, 47);
}

.bookmark {
	text-decoration: none;
	max-height: 8em;
	padding: 0;
	display: flex;
	width: 100%;
	align-items: stretch;
}

.bookmark-title {
	font-size: 0.85em;
	overflow: hidden;
	text-overflow: ellipsis;
	height: 1.75em;
	white-space: nowrap;
}

.bookmark-text {
	display: flex;
	flex-direction: column;
}

.bookmark-info {
	flex: 4 1 180px;
	padding: 12px 14px 14px;
	display: flex;
	flex-direction: column;
	justify-content: space-between;
}

.bookmark-image {
	width: 33%;
	flex: 1 1 180px;
	display: block;
	position: relative;
	object-fit: cover;
	border-radius: 1px;
}

.bookmark-description {
	color: rgba(55, 53, 47, 0.6);
	font-size: 0.75em;
	overflow: hidden;
	max-height: 4.5em;
	word-break: break-word;
}

.bookmark-href {
	font-size: 0.75em;
	margin-top: 0.25em;
}

.sans { font-family: ui-sans-serif, -apple-system, BlinkMacSystemFont, "Segoe UI", Helvetica, "Apple Color Emoji", Arial, sans-serif, "Segoe UI Emoji", "Segoe UI Symbol"; }
.code { font-family: "SFMono-Regular", Menlo, Consolas, "PT Mono", "Liberation Mono", Courier, monospace; }
.serif { font-family: Lyon-Text, Georgia, ui-serif, serif; }
.mono { font-family: iawriter-mono, Nitti, Menlo, Courier, monospace; }
.pdf .sans { font-family: Inter, ui-sans-serif, -apple-system, BlinkMacSystemFont, "Segoe UI", Helvetica, "Apple Color Emoji", Arial, sans-serif, "Segoe UI Emoji", "Segoe UI Symbol", 'Twemoji', 'Noto Color Emoji', 'Noto Sans CJK JP'; }
.pdf:lang(zh-CN) .sans { font-family: Inter, ui-sans-serif, -apple-system, BlinkMacSystemFont, "Segoe UI", Helvetica, "Apple Color Emoji", Arial, sans-serif, "Segoe UI Emoji", "Segoe UI Symbol", 'Twemoji', 'Noto Color Emoji', 'Noto Sans CJK SC'; }
.pdf:lang(zh-TW) .sans { font-family: Inter, ui-sans-serif, -apple-system, BlinkMacSystemFont, "Segoe UI", Helvetica, "Apple Color Emoji", Arial, sans-serif, "Segoe UI Emoji", "Segoe UI Symbol", 'Twemoji', 'Noto Color Emoji', 'Noto Sans CJK TC'; }
.pdf:lang(ko-KR) .sans { font-family: Inter, ui-sans-serif, -apple-system, BlinkMacSystemFont, "Segoe UI", Helvetica, "Apple Color Emoji", Arial, sans-serif, "Segoe UI Emoji", "Segoe UI Symbol", 'Twemoji', 'Noto Color Emoji', 'Noto Sans CJK KR'; }
.pdf .code { font-family: Source Code Pro, "SFMono-Regular", Menlo, Consolas, "PT Mono", "Liberation Mono", Courier, monospace, 'Twemoji', 'Noto Color Emoji', 'Noto Sans Mono CJK JP'; }
.pdf:lang(zh-CN) .code { font-family: Source Code Pro, "SFMono-Regular", Menlo, Consolas, "PT Mono", "Liberation Mono", Courier, monospace, 'Twemoji', 'Noto Color Emoji', 'Noto Sans Mono CJK SC'; }
.pdf:lang(zh-TW) .code { font-family: Source Code Pro, "SFMono-Regular", Menlo, Consolas, "PT Mono", "Liberation Mono", Courier, monospace, 'Twemoji', 'Noto Color Emoji', 'Noto Sans Mono CJK TC'; }
.pdf:lang(ko-KR) .code { font-family: Source Code Pro, "SFMono-Regular", Menlo, Consolas, "PT Mono", "Liberation Mono", Courier, monospace, 'Twemoji', 'Noto Color Emoji', 'Noto Sans Mono CJK KR'; }
.pdf .serif { font-family: PT Serif, Lyon-Text, Georgia, ui-serif, serif, 'Twemoji', 'Noto Color Emoji', 'Noto Serif CJK JP'; }
.pdf:lang(zh-CN) .serif { font-family: PT Serif, Lyon-Text, Georgia, ui-serif, serif, 'Twemoji', 'Noto Color Emoji', 'Noto Serif CJK SC'; }
.pdf:lang(zh-TW) .serif { font-family: PT Serif, Lyon-Text, Georgia, ui-serif, serif, 'Twemoji', 'Noto Color Emoji', 'Noto Serif CJK TC'; }
.pdf:lang(ko-KR) .serif { font-family: PT Serif, Lyon-Text, Georgia, ui-serif, serif, 'Twemoji', 'Noto Color Emoji', 'Noto Serif CJK KR'; }
.pdf .mono { font-family: PT Mono, iawriter-mono, Nitti, Menlo, Courier, monospace, 'Twemoji', 'Noto Color Emoji', 'Noto Sans Mono CJK JP'; }
.pdf:lang(zh-CN) .mono { font-family: PT Mono, iawriter-mono, Nitti, Menlo, Courier, monospace, 'Twemoji', 'Noto Color Emoji', 'Noto Sans Mono CJK SC'; }
.pdf:lang(zh-TW) .mono { font-family: PT Mono, iawriter-mono, Nitti, Menlo, Courier, monospace, 'Twemoji', 'Noto Color Emoji', 'Noto Sans Mono CJK TC'; }
.pdf:lang(ko-KR) .mono { font-family: PT Mono, iawriter-mono, Nitti, Menlo, Courier, monospace, 'Twemoji', 'Noto Color Emoji', 'Noto Sans Mono CJK KR'; }
.highlight-default {
	color: rgba(55, 53, 47, 1);
}
.highlight-gray {
	color: rgba(120, 119, 116, 1);
	fill: rgba(120, 119, 116, 1);
}
.highlight-brown {
	color: rgba(159, 107, 83, 1);
	fill: rgba(159, 107, 83, 1);
}
.highlight-orange {
	color: rgba(217, 115, 13, 1);
	fill: rgba(217, 115, 13, 1);
}
.highlight-yellow {
	color: rgba(203, 145, 47, 1);
	fill: rgba(203, 145, 47, 1);
}
.highlight-teal {
	color: rgba(68, 131, 97, 1);
	fill: rgba(68, 131, 97, 1);
}
.highlight-blue {
	color: rgba(51, 126, 169, 1);
	fill: rgba(51, 126, 169, 1);
}
.highlight-purple {
	color: rgba(144, 101, 176, 1);
	fill: rgba(144, 101, 176, 1);
}
.highlight-pink {
	color: rgba(193, 76, 138, 1);
	fill: rgba(193, 76, 138, 1);
}
.highlight-red {
	color: rgba(212, 76, 71, 1);
	fill: rgba(212, 76, 71, 1);
}
.highlight-gray_background {
	background: rgba(241, 241, 239, 1);
}
.highlight-brown_background {
	background: rgba(244, 238, 238, 1);
}
.highlight-orange_background {
	background: rgba(251, 236, 221, 1);
}
.highlight-yellow_background {
	background: rgba(251, 243, 219, 1);
}
.highlight-teal_background {
	background: rgba(237, 243, 236, 1);
}
.highlight-blue_background {
	background: rgba(231, 243, 248, 1);
}
.highlight-purple_background {
	background: rgba(244, 240, 247, 0.8);
}
.highlight-pink_background {
	background: rgba(249, 238, 243, 0.8);
}
.highlight-red_background {
	background: rgba(253, 235, 236, 1);
}
.block-color-default {
	color: inherit;
	fill: inherit;
}
.block-color-gray {
	color: rgba(120, 119, 116, 1);
	fill: rgba(120, 119, 116, 1);
}
.block-color-brown {
	color: rgba(159, 107, 83, 1);
	fill: rgba(159, 107, 83, 1);
}
.block-color-orange {
	color: rgba(217, 115, 13, 1);
	fill: rgba(217, 115, 13, 1);
}
.block-color-yellow {
	color: rgba(203, 145, 47, 1);
	fill: rgba(203, 145, 47, 1);
}
.block-color-teal {
	color: rgba(68, 131, 97, 1);
	fill: rgba(68, 131, 97, 1);
}
.block-color-blue {
	color: rgba(51, 126, 169, 1);
	fill: rgba(51, 126, 169, 1);
}
.block-color-purple {
	color: rgba(144, 101, 176, 1);
	fill: rgba(144, 101, 176, 1);
}
.block-color-pink {
	color: rgba(193, 76, 138, 1);
	fill: rgba(193, 76, 138, 1);
}
.block-color-red {
	color: rgba(212, 76, 71, 1);
	fill: rgba(212, 76, 71, 1);
}
.block-color-gray_background {
	background: rgba(241, 241, 239, 1);
}
.block-color-brown_background {
	background: rgba(244, 238, 238, 1);
}
.block-color-orange_background {
	background: rgba(251, 236, 221, 1);
}
.block-color-yellow_background {
	background: rgba(251, 243, 219, 1);
}
.block-color-teal_background {
	background: rgba(237, 243, 236, 1);
}
.block-color-blue_background {
	background: rgba(231, 243, 248, 1);
}
.block-color-purple_background {
	background: rgba(244, 240, 247, 0.8);
}
.block-color-pink_background {
	background: rgba(249, 238, 243, 0.8);
}
.block-color-red_background {
	background: rgba(253, 235, 236, 1);
}
.select-value-color-pink { background-color: rgba(245, 224, 233, 1); }
.select-value-color-purple { background-color: rgba(232, 222, 238, 1); }
.select-value-color-green { background-color: rgba(219, 237, 219, 1); }
.select-value-color-gray { background-color: rgba(227, 226, 224, 1); }
.select-value-color-opaquegray { background-color: rgba(255, 255, 255, 0.0375); }
.select-value-color-orange { background-color: rgba(250, 222, 201, 1); }
.select-value-color-brown { background-color: rgba(238, 224, 218, 1); }
.select-value-color-red { background-color: rgba(255, 226, 221, 1); }
.select-value-color-yellow { background-color: rgba(253, 236, 200, 1); }
.select-value-color-blue { background-color: rgba(211, 229, 239, 1); }

.checkbox {
	display: inline-flex;
	vertical-align: text-bottom;
	width: 16;
	height: 16;
	background-size: 16px;
	margin-left: 2px;
	margin-right: 5px;
}

.checkbox-on {
	background-image: url("data:image/svg+xml;charset=UTF-8,%3Csvg%20width%3D%2216%22%20height%3D%2216%22%20viewBox%3D%220%200%2016%2016%22%20fill%3D%22none%22%20xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22%3E%0A%3Crect%20width%3D%2216%22%20height%3D%2216%22%20fill%3D%22%2358A9D7%22%2F%3E%0A%3Cpath%20d%3D%22M6.71429%2012.2852L14%204.9995L12.7143%203.71436L6.71429%209.71378L3.28571%206.2831L2%207.57092L6.71429%2012.2852Z%22%20fill%3D%22white%22%2F%3E%0A%3C%2Fsvg%3E");
}

.checkbox-off {
	background-image: url("data:image/svg+xml;charset=UTF-8,%3Csvg%20width%3D%2216%22%20height%3D%2216%22%20viewBox%3D%220%200%2016%2016%22%20fill%3D%22none%22%20xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22%3E%0A%3Crect%20x%3D%220.75%22%20y%3D%220.75%22%20width%3D%2214.5%22%20height%3D%2214.5%22%20fill%3D%22white%22%20stroke%3D%22%2336352F%22%20stroke-width%3D%221.5%22%2F%3E%0A%3C%2Fsvg%3E");
}
	
</style></head><body><article id="72068f7d-370a-4815-972d-9621a10519f0" class="page sans"><header><h1 class="page-title">MPI</h1></header><div class="page-body"><ul id="aff08c57-0100-4d1f-9508-e1a3c315d3a1" class="toggle"><li><details open=""><summary>CLI commands for compiling</summary><p id="950c0e0e-b6a8-4b7d-a878-fae953cdc441" class="">On batch systems:<mark class="highlight-gray"> </mark><mark class="highlight-gray"><code>slurm srun</code></mark>, <mark class="highlight-gray"><code>sbatch</code></mark></p><pre id="faa5b8ea-d2c3-4e03-86de-6619dcd4a860" class="code"><code>mpicc, mpif77, mpif90 – like cc, f77, f90
mpirun –np &lt;procs&gt; &lt;program&gt; … &lt;program options&gt; // -np means only one node </code></pre><p id="c0504e4e-4558-4c25-bae5-c3496244201b" class="">Starts <mark class="highlight-gray"><code>&lt;procs&gt;</code></mark> number of MPI processes executing same <mark class="highlight-gray"><code>&lt;program&gt;</code></mark> on available resources (processors, cores, threads, ...)</p><p id="27dfdd3b-3565-4516-8afc-67c9b901088d" class="">
</p><p id="37d435f9-c308-4ca9-8f74-7da1a2eb17e6" class=""><mark class="highlight-gray"><code>&lt;program&gt;</code></mark> executes:</p><pre id="5f0ce0a0-fe88-4b63-89c4-2a736848bf98" class="code"><code>MPI_Init(&amp;argc,&amp;argv);
// sets up internal data structures, incl:
...
MPI_Comm_size(MPI_COMM_WORLD,&amp;size);</code></pre><p id="af190c94-abcb-4329-a56e-3a2968bf749e" class="">
</p></details></li></ul><p id="91ae6c2c-d51e-4d47-a7ca-9fcc005fae63" class=""><a href="https://hpc-tutorials.llnl.gov/mpi/">https://hpc-tutorials.llnl.gov/mpi/</a></p><p id="05f3e1e7-eddb-482f-8fe3-5f27fca54bf2" class=""><a href="https://curc.readthedocs.io/en/latest/programming/MPI-C.html">https://curc.readthedocs.io/en/latest/programming/MPI-C.html</a></p><p id="23c318d2-0353-4e9b-bde4-ecb434cef8ed" class="">
</p><p id="6ee8ff9d-b5af-4d5b-bed0-c94aab35075e" class="">
</p><nav id="9a2a5114-8249-44c7-9c8c-6a4207eb4480" class="block-color-gray table_of_contents"><div class="table_of_contents-item table_of_contents-indent-0"><a class="table_of_contents-link" href="#68c0edf7-ef6f-4899-9c7a-004f277c8cc3">Models</a></div><div class="table_of_contents-item table_of_contents-indent-1"><a class="table_of_contents-link" href="#dd1ddad2-a3fe-422d-8a3a-dcfbf5210a95">Message-passing model</a></div><div class="table_of_contents-item table_of_contents-indent-1"><a class="table_of_contents-link" href="#64b6fc94-4c1c-42e3-8835-1e2802aa9053">MPI model</a></div><div class="table_of_contents-item table_of_contents-indent-0"><a class="table_of_contents-link" href="#fa98ecde-b31f-41cf-a8e0-28276a12f6cb">MPI Concepts</a></div><div class="table_of_contents-item table_of_contents-indent-0"><a class="table_of_contents-link" href="#1329fe38-0898-4fbc-af66-5ff2664a4f07">Basic library routines</a></div><div class="table_of_contents-item table_of_contents-indent-0"><a class="table_of_contents-link" href="#f9bdb4ab-358c-40d2-9677-95896641588d">Point-to-point communication</a></div><div class="table_of_contents-item table_of_contents-indent-1"><a class="table_of_contents-link" href="#62d210f6-3793-4830-9817-a2963463055f">Sending</a></div><div class="table_of_contents-item table_of_contents-indent-1"><a class="table_of_contents-link" href="#2747afdc-a51a-43f9-a273-767ce62dab1f">Receiving</a></div><div class="table_of_contents-item table_of_contents-indent-1"><a class="table_of_contents-link" href="#049a56c1-254e-4db4-b009-24c173a6f0db">Examples</a></div><div class="table_of_contents-item table_of_contents-indent-1"><a class="table_of_contents-link" href="#05dd7151-9963-4f80-a135-c21c14ee36f0">Safe programming</a></div><div class="table_of_contents-item table_of_contents-indent-0"><a class="table_of_contents-link" href="#737e5c78-dc4d-4cc2-86ed-5a8ef9d20578">Datatypes</a></div><div class="table_of_contents-item table_of_contents-indent-0"><a class="table_of_contents-link" href="#5acadf24-b55d-4a98-b6c9-d1459f6cb662">One-sided communication</a></div><div class="table_of_contents-item table_of_contents-indent-1"><a class="table_of_contents-link" href="#539c47b6-747a-4a59-ac88-365cdcfd97b0">Window, Epoch model</a></div><div class="table_of_contents-item table_of_contents-indent-1"><a class="table_of_contents-link" href="#9a99a997-820b-4a64-be3a-ddb1c4ab929d">Origin, Target</a></div><div class="table_of_contents-item table_of_contents-indent-1"><a class="table_of_contents-link" href="#20d7fa1d-4903-46d2-84c3-97628c63459d">Epoch model, synchronization</a></div><div class="table_of_contents-item table_of_contents-indent-0"><a class="table_of_contents-link" href="#c7a60ca7-aa60-454f-b939-47277e95e925">Collective communication</a></div><div class="table_of_contents-item table_of_contents-indent-1"><a class="table_of_contents-link" href="#74f1ca93-47c4-463a-8dc5-2f08ac1d84c6">Overview</a></div><div class="table_of_contents-item table_of_contents-indent-1"><a class="table_of_contents-link" href="#d32c5f7b-f711-47c0-a753-71c905e690a9">Operations</a></div><div class="table_of_contents-item table_of_contents-indent-1"><a class="table_of_contents-link" href="#7245c26a-71d3-498e-b1ed-d28f1463f64e">Reduction collectives</a></div><div class="table_of_contents-item table_of_contents-indent-1"><a class="table_of_contents-link" href="#dd1f3af5-47eb-4b8d-bfdd-372b89fa066b">Scan collectives</a></div></nav><p id="fc394e03-b8d3-4739-bb6f-a7b33142f2b8" class="">
</p><p id="cd3a556f-d2e5-4c50-8973-32e3debab37f" class="">
</p><h1 id="68c0edf7-ef6f-4899-9c7a-004f277c8cc3" class="">Models</h1><h2 id="dd1ddad2-a3fe-422d-8a3a-dcfbf5210a95" class="">Message-passing model</h2><p id="e449f8d1-a968-4b63-b775-b5d8b6badd17" class=""><mark class="highlight-blue">Message-passing parallel abstraction / programming model</mark><div class="indented"><p id="2a520e2d-570b-4a4c-8895-272ac0c21590" class=""><em>“Message passing paradigm”</em></p><p id="17663a64-dd7e-4690-b272-d7e9b9e5bf62" class=""><em>“shared-nothing programming model”</em></p><p id="3882e39c-7958-47d4-93ed-2d96ef554ef5" class="">Finite set of processes with local memory, program (no shared memory).</p><p id="7ec334b6-9b6d-48b6-9d9e-89b27452ef8e" class="">Explicit communication: Sending, receiving messages.<div class="indented"><ul id="104b4ff3-bfad-4db3-bf7a-a85ce032c4b3" class="bulleted-list"><li style="list-style-type:disc">Fully connected network: all processes are connected and can communicate.</li></ul><ul id="f4b5b0de-7eda-48a6-afa8-507fe8404fa0" class="bulleted-list"><li style="list-style-type:disc">Communication can be one-sided (otherwise always both parties are involved).</li></ul><ul id="3896bc44-2664-4f38-b880-c997b8e7c094" class="bulleted-list"><li style="list-style-type:disc">We abstract over medium (physical network properties = communication network) and routing algorithm.</li></ul></div></p><p id="49f0ba6f-77bf-4340-8387-3cbcaf11f147" class="">No implicit synchronization between processes (nothing else is shared).</p></div></p><figure id="4062e78e-6b9a-459d-9d96-e0101a736c57" class="image"><a href="MPI%2072068f7d370a4815972d9621a10519f0/Untitled.png"><img style="width:288px" src="MPI%2072068f7d370a4815972d9621a10519f0/Untitled.png"/></a></figure><p id="92ae8600-6717-4175-8ee6-4c13d6f18b38" class=""><mark class="highlight-blue">Advantages</mark><div class="indented"><p id="cc1dfcd6-6c54-43ca-917f-edde4e3365d1" class="">All data exchange is explicit, deterministic<div class="indented"><p id="d8e4f6bb-cf1b-4ad2-8059-d66fdef09aef" class="">We known: when, what, where</p><p id="91a57023-6152-496e-a84d-ca608c2d0e2b" class="">Reasoning about correctness, no race conditions</p></div></p></div></p><p id="023d79c5-c189-4216-8d8d-ee7d396a8b64" class="">
</p><p id="e29e31af-eb1c-475d-bae9-a62bf189d37d" class=""><mark class="highlight-blue">Performance model</mark><div class="indented"><p id="c3fc2af1-d586-4d55-ab7a-4f5b0d7143b7" class="">Communication = expensive (do it rarely and with large messages)</p><p id="12e87ba6-e5a9-4ab0-a405-550f65b32b85" class="">Local computation = cheap</p></div></p><p id="5232726f-664d-48d0-aa14-41f6ed4ba93e" class="">
</p><h2 id="64b6fc94-4c1c-42e3-8835-1e2802aa9053" class="">MPI model</h2><p id="d4a049be-0899-4932-ba58-235e37bad132" class=""><mark class="highlight-blue">Message passing interface MPI</mark><div class="indented"><p id="4b6c3f19-000a-456b-b3d6-33a854990d44" class="">Library</p><p id="cbcc6934-f986-48f9-8aa2-113df479c71a" class="">Standard for parallel programming in given model (no performance model).</p><p id="ff2de5cc-ef79-4bba-bce2-db9478137546" class="">Used for distributed applications with non-trivial algorithms that require communication.</p><p id="24aabdd6-3db6-4dc8-8c33-9263a141b628" class="">Implemented efficiently and can coexist with other parallel interfaces (OpenMP, threads, ...)<div class="indented"><p id="49c434f1-7ae4-4c95-8a1e-f6d6c2e757ca" class="">communication inside library isolated from communication outside library.</p></div></p><p id="24ecf979-4d62-406c-a351-0eafb5939cf9" class="">support SPMD, MIMD<div class="indented"><p id="6ef19ad0-094f-49a4-b054-984e4209f608" class="">= loosely synchronous, all processes run the same program, processes distinguish themselves by their rank (process ID)</p><p id="f86c619a-de15-4807-a43c-89b950f5759e" class="">MIMD consists of application with different compiled programs.</p><p id="b2914a1d-130e-4687-b1d2-7f0c1d5cb14c" class="">(In this lecture only SPMD)</p></div></p><p id="ec3cfa84-4448-4c90-a836-9a8cdf80792a" class="">
</p></div></p><p id="f2b25474-1cf8-4776-8adf-92fa978673d4" class=""><mark class="highlight-blue">MPI programming model</mark><div class="indented"><p id="7a4885cb-4e23-45bb-a47e-a6b0ae9cd771" class="">Physical processors can run multiple MPI processes (but usually only one, therefore static).<div class="indented"><p id="242668eb-4929-4ae2-9f96-d389c8a62b6f" class="">Binding processes to processors is not part of the MPI.</p></div></p><hr id="b3e2e185-7583-4d07-bca3-c9669a21e968"/><ol type="1" id="0e5529ea-e12c-4851-95dc-e124f0eaf997" class="numbered-list" start="1"><li>Processes with rank <style>@import url('https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.13.2/katex.min.css')</style><span data-token-index="0" contenteditable="false" class="notion-text-equation-token" style="user-select:all;-webkit-user-select:all;-moz-user-select:all"><span></span><span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mstyle mathsize="0.9em"><mo stretchy="false">[</mo><mn>0</mn><mo separator="true">;</mo><mtext> </mtext><mi>p</mi><mo>−</mo><mn>1</mn><mo stretchy="false">]</mo></mstyle></mrow><annotation encoding="application/x-tex">\small [0;~p-1]</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.9em;vertical-align:-0.225em;"></span><span class="mopen sizing reset-size6 size5">[</span><span class="mord sizing reset-size6 size5">0</span><span class="mpunct sizing reset-size6 size5">;</span><span class="mspace nobreak sizing reset-size6 size5"> </span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathnormal sizing reset-size6 size5">p</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin sizing reset-size6 size5">−</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.9em;vertical-align:-0.225em;"></span><span class="mord sizing reset-size6 size5">1</span><span class="mclose sizing reset-size6 size5">]</span></span></span></span></span><span>﻿</span></span> in communication domain, can communicate.</li></ol><ol type="1" id="8fd99106-2be6-4166-a78f-13f416c06404" class="numbered-list" start="2"><li>≥1 communication domains possible (created relative to default domain).</li></ol><ol type="1" id="2fb812e8-3b21-4be1-809c-dbe76426af18" class="numbered-list" start="3"><li>Processes operate only on local data - all communication explicit (and also reliable, ordered).</li></ol><ol type="1" id="b002a648-c47a-4b16-be3a-eee62612e117" class="numbered-list" start="4"><li>Three basic communication models:<ol type="i" id="ef3d871f-60ae-40c8-82f3-f7e4864e969f" class="numbered-list" start="1"><li>Point-to-point communication</li></ol><ol type="i" id="57afd369-6517-46c6-a5d2-886ed4b66eed" class="numbered-list" start="2"><li>One-sided communication</li></ol><ol type="i" id="0354afae-b0e9-4541-9482-58e97f49d63c" class="numbered-list" start="3"><li>Collective operations</li></ol></li></ol><ol type="1" id="d753f566-2649-446a-a24c-0d2a7c809a6e" class="numbered-list" start="5"><li>Communication domains can reflect physical topology of network</li></ol><ol type="1" id="a704bf86-e7f1-45b8-adbe-1668fe018626" class="numbered-list" start="6"><li>No communication cost model</li></ol></div></p><p id="fbaa8dd7-65e0-479e-983a-96e476d25720" class="">
</p><p id="4a5cfa62-24f6-43b7-a2b9-a6335ffc603e" class=""><mark class="highlight-blue">MPI communication models</mark><div class="indented"><ol type="i" id="6c68ade4-939b-47e7-b4b5-825e5ccf6908" class="numbered-list" start="1"><li>Point-to-point communication (different modes)<p id="269aa15f-1039-4f05-bac9-b003a8df5658" class="">non-local and local completion</p><p id="b8f8259f-aedf-4e68-9931-0799ec1d0f37" class=""><style>@import url('https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.13.2/katex.min.css')</style><span data-token-index="0" contenteditable="false" class="notion-text-equation-token" style="user-select:all;-webkit-user-select:all;-moz-user-select:all"><span></span><span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mstyle mathcolor="pink"><mstyle mathsize="0.9em"><mtext>MPI-Send</mtext><mo>⟹</mo><mtext>MPI-Recv</mtext></mstyle></mstyle></mrow><annotation encoding="application/x-tex">\color{pink}\small \text{MPI-Send} \Longrightarrow \text{MPI-Recv}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.646596em;vertical-align:-0.0216em;"></span><span class="mord text sizing reset-size6 size5" style="color:pink;"><span class="mord" style="color:pink;">MPI-Send</span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel sizing reset-size6 size5" style="color:pink;">⟹</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.614997em;vertical-align:0em;"></span><span class="mord text sizing reset-size6 size5" style="color:pink;"><span class="mord" style="color:pink;">MPI-Recv</span></span></span></span></span></span><span>﻿</span></span></p></li></ol><ol type="i" id="e55ed2d4-81b2-4c5d-9d7f-8c536aa0381a" class="numbered-list" start="2"><li>One-sided communication (different synchronization mechanisms)<p id="0cc770d9-62de-43bb-9928-78f09e8ac7fc" class="">local completion</p><p id="4edc23d9-3501-41f3-895b-6ce62659154e" class=""><style>@import url('https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.13.2/katex.min.css')</style><span data-token-index="0" contenteditable="false" class="notion-text-equation-token" style="user-select:all;-webkit-user-select:all;-moz-user-select:all"><span></span><span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mstyle mathcolor="pink"><mstyle mathsize="0.9em"><mtext>MPI-Put</mtext><mo>⟹</mo></mstyle></mstyle></mrow><annotation encoding="application/x-tex">\color{pink}\small \text{MPI-Put} \Longrightarrow</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.636597em;vertical-align:-0.0216em;"></span><span class="mord text sizing reset-size6 size5" style="color:pink;"><span class="mord" style="color:pink;">MPI-Put</span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel sizing reset-size6 size5" style="color:pink;">⟹</span></span></span></span></span><span>﻿</span></span></p></li></ol><ol type="i" id="d63e4035-ef43-4df5-9cde-214409453905" class="numbered-list" start="3"><li>Collective operations (can be non-blocking)<p id="e7f50bb3-a9de-4cce-a034-4b5989eca4e8" class="">non-local completion</p><p id="c3c1e0c4-a78e-4721-8de4-8fecfa56652d" class=""><style>@import url('https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.13.2/katex.min.css')</style><span data-token-index="0" contenteditable="false" class="notion-text-equation-token" style="user-select:all;-webkit-user-select:all;-moz-user-select:all"><span></span><span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mstyle mathcolor="pink"><mstyle mathsize="0.9em"><mtext>MPI-Bcast</mtext><mo>⟹</mo><mi>a</mi><mpadded voffset="0.3em"><mstyle scriptlevel="0" displaystyle="false"><mstyle scriptlevel="0" displaystyle="false"><mi>b</mi></mstyle></mstyle></mpadded><mi>c</mi></mstyle></mstyle></mrow><annotation encoding="application/x-tex">\color{pink}\small \text{MPI-Bcast} \Longrightarrow a\raisebox{0.3em}{$b$}c</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.636597em;vertical-align:-0.0216em;"></span><span class="mord text sizing reset-size6 size5" style="color:pink;"><span class="mord" style="color:pink;">MPI-Bcast</span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel sizing reset-size6 size5" style="color:pink;">⟹</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.894996em;vertical-align:0em;"></span><span class="mord mathnormal sizing reset-size6 size5" style="color:pink;">a</span><span class="vlist-t sizing reset-size6 size5"><span class="vlist-r"><span class="vlist" style="height:0.99444em;"><span style="top:-3.1999999999999997em;"><span class="pstrut" style="height:2.9em;"></span><span class="mord" style="color:pink;"><span class="mord mathnormal" style="color:pink;">b</span></span></span></span></span></span><span class="mord mathnormal sizing reset-size6 size5" style="color:pink;">c</span></span></span></span></span><span>﻿</span></span></p></li></ol><ol type="i" id="0839b75c-7403-4138-96b9-0a0fea96476b" class="block-color-gray numbered-list" start="4"><li>Other operations (not in this lecture)<p id="ea2fcb22-6309-4b03-a38e-8d38b1e671ba" class="">parallel I/O, spawning processes, virtual topologies, ...</p></li></ol><hr id="f50cfe2e-ba97-49b1-873f-c9a2aa3e3a7d"/><p id="87e69fdc-d9d1-44c4-a84c-d5743ef3160a" class="">Rule:<div class="indented"><p id="06b5707c-bfd1-4eea-bb55-a21c1475e270" class="">All messages sent must be received, else <mark class="highlight-gray"><code>MPI_Finalize()</code></mark> may not terminate because there are pending communications.</p></div></p></div></p><p id="6d59294b-159d-42b0-807e-e9a69ff6cf09" class="">
</p><p id="7a627d3c-3cc2-4d1d-b9b3-28bc5db1c72e" class=""><mark class="highlight-blue">Deadlocks in MPI</mark><div class="indented"><p id="bdb23bf6-7b8b-4438-b98f-ab49a322bdea" class="">Possible forms:<div class="indented"><ol type="a" id="bc7ea15a-17b8-4b82-b487-5d6329e23b08" class="numbered-list" start="1"><li>All processes waiting for event that can not happen</li></ol><ol type="a" id="d4e4ab51-563b-4598-95e0-b1240d06b73a" class="numbered-list" start="2"><li>Process <style>@import url('https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.13.2/katex.min.css')</style><span data-token-index="0" contenteditable="false" class="notion-text-equation-token" style="user-select:all;-webkit-user-select:all;-moz-user-select:all"><span></span><span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mstyle mathsize="0.9em"><mi>i</mi></mstyle></mrow><annotation encoding="application/x-tex">\small i</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.593568em;vertical-align:0em;"></span><span class="mord mathnormal sizing reset-size6 size5">i</span></span></span></span></span><span>﻿</span></span> waiting for <style>@import url('https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.13.2/katex.min.css')</style><span data-token-index="0" contenteditable="false" class="notion-text-equation-token" style="user-select:all;-webkit-user-select:all;-moz-user-select:all"><span></span><span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mstyle mathsize="0.9em"><mi>j</mi></mstyle></mrow><annotation encoding="application/x-tex">\small j</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.768564em;vertical-align:-0.174996em;"></span><span class="mord mathnormal sizing reset-size6 size5" style="margin-right:0.05724em;">j</span></span></span></span></span><span>﻿</span></span>,<p id="d69c5004-8a55-47f0-9da9-0fa7874985ea" class=""><style>@import url('https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.13.2/katex.min.css')</style><span data-token-index="0" contenteditable="false" class="notion-text-equation-token" style="user-select:all;-webkit-user-select:all;-moz-user-select:all"><span></span><span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mstyle mathsize="0.9em"><mi>j</mi></mstyle></mrow><annotation encoding="application/x-tex">\small j</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.768564em;vertical-align:-0.174996em;"></span><span class="mord mathnormal sizing reset-size6 size5" style="margin-right:0.05724em;">j</span></span></span></span></span><span>﻿</span></span> waiting for <style>@import url('https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.13.2/katex.min.css')</style><span data-token-index="0" contenteditable="false" class="notion-text-equation-token" style="user-select:all;-webkit-user-select:all;-moz-user-select:all"><span></span><span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mstyle mathsize="0.9em"><mi>i</mi></mstyle></mrow><annotation encoding="application/x-tex">\small i</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.593568em;vertical-align:0em;"></span><span class="mord mathnormal sizing reset-size6 size5">i</span></span></span></span></span><span>﻿</span></span></p></li></ol><ol type="a" id="d86e8b25-6af8-4be7-913f-e0f5167ed783" class="numbered-list" start="3"><li>Process <style>@import url('https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.13.2/katex.min.css')</style><span data-token-index="0" contenteditable="false" class="notion-text-equation-token" style="user-select:all;-webkit-user-select:all;-moz-user-select:all"><span></span><span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mstyle mathsize="0.9em"><mi>i</mi></mstyle></mrow><annotation encoding="application/x-tex">\small i</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.593568em;vertical-align:0em;"></span><span class="mord mathnormal sizing reset-size6 size5">i</span></span></span></span></span><span>﻿</span></span> waiting for <style>@import url('https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.13.2/katex.min.css')</style><span data-token-index="0" contenteditable="false" class="notion-text-equation-token" style="user-select:all;-webkit-user-select:all;-moz-user-select:all"><span></span><span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mstyle mathsize="0.9em"><mi>i</mi><mo>+</mo><mn>1</mn></mstyle></mrow><annotation encoding="application/x-tex">\small i+1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.668565em;vertical-align:-0.07499700000000001em;"></span><span class="mord mathnormal sizing reset-size6 size5">i</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin sizing reset-size6 size5">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.5799960000000001em;vertical-align:0em;"></span><span class="mord sizing reset-size6 size5">1</span></span></span></span></span><span>﻿</span></span>,<p id="c466cc05-93fd-4812-ba4d-c425ea661c92" class=""><style>@import url('https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.13.2/katex.min.css')</style><span data-token-index="0" contenteditable="false" class="notion-text-equation-token" style="user-select:all;-webkit-user-select:all;-moz-user-select:all"><span></span><span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mstyle mathsize="0.9em"><mi>i</mi><mo>+</mo><mn>1</mn></mstyle></mrow><annotation encoding="application/x-tex">\small i+1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.668565em;vertical-align:-0.07499700000000001em;"></span><span class="mord mathnormal sizing reset-size6 size5">i</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin sizing reset-size6 size5">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.5799960000000001em;vertical-align:0em;"></span><span class="mord sizing reset-size6 size5">1</span></span></span></span></span><span>﻿</span></span> waiting for <style>@import url('https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.13.2/katex.min.css')</style><span data-token-index="0" contenteditable="false" class="notion-text-equation-token" style="user-select:all;-webkit-user-select:all;-moz-user-select:all"><span></span><span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mstyle mathsize="0.9em"><mi>i</mi><mo>+</mo><mn>2</mn></mstyle></mrow><annotation encoding="application/x-tex">\small i+2</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.668565em;vertical-align:-0.07499700000000001em;"></span><span class="mord mathnormal sizing reset-size6 size5">i</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin sizing reset-size6 size5">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.5799960000000001em;vertical-align:0em;"></span><span class="mord sizing reset-size6 size5">2</span></span></span></span></span><span>﻿</span></span>,</p><p id="21e3817c-c25f-4c47-9538-4a51f82d16d8" class=""><style>@import url('https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.13.2/katex.min.css')</style><span data-token-index="0" contenteditable="false" class="notion-text-equation-token" style="user-select:all;-webkit-user-select:all;-moz-user-select:all"><span></span><span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo>…</mo></mrow><annotation encoding="application/x-tex">\dots</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.12em;vertical-align:0em;"></span><span class="minner">…</span></span></span></span></span><span>﻿</span></span></p></li></ol></div></p></div></p><p id="313112b7-9155-472a-ba3e-cdaff43d1d32" class=""><mark class="highlight-blue">Unsafe programs in MPI</mark><div class="indented"><p id="b92f4ee8-f25d-4ea5-88ea-b2f05e9d1eb4" class="">An MPI program is <em>unsafe</em> if termination depends on implementation of library (ie. buffering of <mark class="highlight-gray"><code>MPI_Send</code></mark>), concrete context (ie. processes and communication).</p><p id="f1410283-28f8-4741-b922-347ea3def93c" class="">It may or may not deadlock.</p><p id="28d40d58-5cef-4838-b1cb-e7a0432de039" class="">Not portable (different libraries implemented differently).</p></div></p><p id="19ae1263-57bf-45d5-a1a1-19506404fb60" class="">
</p><p id="89f4da92-86ea-448c-9fd4-ed0296f528c7" class="">
</p><h1 id="fa98ecde-b31f-41cf-a8e0-28276a12f6cb" class="">MPI Concepts</h1><p id="bb6eb250-89a2-46b6-9df0-dec7412fef53" class=""><mark class="highlight-blue">Communicator object </mark><code><mark class="highlight-blue">comm</mark></code><mark class="highlight-blue"> (= communication domain)</mark><div class="indented"><p id="071ab70b-a156-44f5-a9b6-12ec651651e4" class="">Communicators are static objects that cannot change.<div class="indented"><p id="86049e6c-cb1b-4e14-9d39-7fe65d7aacda" class="">Processes cannot be moved around in them - we can only create new comms from old ones (and free them after the usage).</p></div></p><p id="ad788146-8744-453d-a85b-beee97fa1338" class="">Predefined communicators:<div class="indented"><p id="bc09c52f-156d-416d-b4a8-571fecf4da09" class=""><mark class="highlight-gray"><code>MPI_COMM_WORLD</code></mark><mark class="highlight-gray"> </mark>= Initial communicator, contains set of processes that all can communicate with eachother, communication context.</p><p id="ef4ce15c-a22d-4c12-a7f6-f2ffec058af3" class=""><mark class="highlight-gray"><code>MPI_COMM_SELF</code></mark> = Singleton communicator with only process (itself)</p><p id="b0039863-3d32-41b7-8107-2f2d5690987e" class=""><mark class="highlight-gray"><code>MPI_COMM_NULL</code></mark> = No or invalid communicator</p></div></p><hr id="92acdce5-a6f1-47d0-811e-e688df3031e3"/><p id="2ead0f6d-192d-4051-afad-e627d242fd45" class="">Rules:<div class="indented"><ol type="1" id="8438e7c6-5a4d-4e8b-818e-d730044934db" class="numbered-list" start="1"><li>Communication in MPI is always relative to comm</li></ol><ol type="1" id="e36cb00e-f248-4d4f-a85a-350115e8e9cb" class="numbered-list" start="2"><li>Process ranks = id + communicator they are in</li></ol></div></p></div></p><figure id="bf581388-c617-4444-8837-061a419255f6" class="image"><a href="MPI%2072068f7d370a4815972d9621a10519f0/Untitled%201.png"><img style="width:144px" src="MPI%2072068f7d370a4815972d9621a10519f0/Untitled%201.png"/></a></figure><p id="f496a987-2412-49af-9c51-3a5ec37ce887" class="">
</p><p id="98e6f949-75da-4a99-b8eb-7a3b3bc91436" class=""><mark class="highlight-blue">Handle</mark><div class="indented"><p id="57240be8-e8d5-4402-8f5b-c60fe582a925" class="">special MPI typedef.</p><p id="d090c344-0a8f-4c60-8a31-047dd077f974" class="">Handles are opaque (not transparent) - the internal datastructures can only be accessed through the operations defined on them.</p><hr id="5f78f27a-5b69-4e95-b48c-824f04a02289"/><p id="bdb1ec4a-f380-4415-9429-5f2af32ffc35" class="">TL;DR: they are the prefixes of library routines.</p><p id="1de281f1-cd5a-4e1e-b057-3f550de2794b" class=""><mark class="highlight-gray">ie. </mark><mark class="highlight-gray"><code>MPI_COMM_WORLD</code></mark><mark class="highlight-gray"> has handle </mark><code><mark class="highlight-gray">MPI_Comm</mark></code><mark class="highlight-gray"> and is used to access the current comm of a process and perform operations on it.</mark></p></div></p><p id="ffceb746-c1da-455a-805e-f3aae7969455" class="">
</p><p id="eff1a561-ac5e-4045-80d1-95d2a4c049b5" class=""><mark class="highlight-blue">MPI handles</mark><div class="indented"><p id="80c1f4bb-e222-47ca-a06d-de5daefe797c" class=""><mark class="highlight-teal"><code>MPI_Comm</code></mark><mark class="highlight-teal"> - communicators (global)</mark><div class="indented"><p id="32c0b607-2571-4e41-8474-3eaf10ccad23" class="">can be manipulated with collective operations (ie. <mark class="highlight-gray"><code>MPI_Comm_split</code></mark>, <mark class="highlight-gray"><code>MPI_Comm_dup</code></mark>, ...)</p></div></p><p id="6bbb8019-5c1b-4949-a86b-ad389786cb1a" class=""><mark class="highlight-teal"><code>MPI_Group</code></mark><mark class="highlight-teal"> - process groups (local)</mark><div class="indented"><p id="9bed1840-b8e4-4b0b-9e29-1afc2385e631" class="">ordered set of processes used for one-sided communication</p><ul id="76bd798a-9542-48c9-8de8-1c83fd623489" class="toggle"><li><details open=""><summary>can be manipulated locally</summary><pre id="1dc70f6f-e6a3-420f-aa12-f66d18891113" class="code"><code>MPI_Group_union
MPI_Group_intersection
MPI_Group_incl, MPI_Group_excl
MPI_Group_translate_ranks
MPI_Group_compare
...</code></pre></details></li></ul></div></p><p id="546b080a-4374-415b-9e27-30d1a06fc511" class=""><mark class="highlight-teal"><code>MPI_Win</code></mark><mark class="highlight-teal"> - windows for one-sided communication (distributed)</mark></p><p id="9310b0eb-deda-4062-bb21-4cb3737c8cd5" class=""><mark class="highlight-teal"><code>MPI_Datatype</code></mark><mark class="highlight-teal"> - Description of data layouts</mark><div class="indented"><p id="822b051b-b471-43ce-a290-ffe960001234" class="">describe unit of communication.</p></div></p><p id="8836285d-0f83-45ed-94db-bc984e30e94d" class=""><mark class="highlight-teal"><code>MPI_Op</code></mark><mark class="highlight-teal"> - Binary operations</mark></p><p id="e18986b8-9ace-4419-a279-12fd15886564" class=""><mark class="highlight-teal"><code>MPI_Request</code></mark><mark class="highlight-teal"> - Request handle for point-to-point</mark></p><p id="e7fdb430-b2ad-49bf-b226-2fd0ccd3dc7e" class=""><mark class="highlight-teal"><code>MPI_Status</code></mark><mark class="highlight-teal"> - Communication status</mark><div class="indented"><p id="9b730e4d-3f31-4395-9c9a-47a3fb490ea6" class="">Information on what was received.</p></div></p><p id="2d973110-9f95-4265-b402-f94f5ae70a55" class=""><mark class="highlight-teal"><code>MPI_Errhandler</code></mark></p><p id="549c8dfa-dcb1-4dc7-b46a-f654f149bbf7" class=""><style>@import url('https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.13.2/katex.min.css')</style><span data-token-index="0" contenteditable="false" class="notion-text-equation-token" style="user-select:all;-webkit-user-select:all;-moz-user-select:all"><span></span><span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo>…</mo></mrow><annotation encoding="application/x-tex">\dots</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.12em;vertical-align:0em;"></span><span class="minner">…</span></span></span></span></span><span>﻿</span></span></p></div></p><p id="e2e43b7b-7754-476a-84d0-c05e0a57e300" class="">
</p><p id="6b43052d-5411-4510-ba4b-f31881766bc0" class="">
</p><h1 id="1329fe38-0898-4fbc-af66-5ff2664a4f07" class="">Basic library routines</h1><p id="7df436c1-7d8c-4691-8af5-65721e8ac9c1" class=""><mark class="highlight-blue">Function arguments</mark><div class="indented"><p id="45ff373b-232b-4fb5-9c5c-236339d18805" class=""><em>OUT arguments</em>	pointers</p><p id="9df58ff3-d2e4-4c7a-b754-19c2f185b969" class=""><em>IN arguments</em>		pointers, values</p><p id="26c690e1-f710-45b1-a546-418088b7ec15" class=""><em>Handles			</em>special MPI typedef’s</p><ul id="4e93b48b-7479-4e4f-a486-c3b83530e514" class="toggle"><li><details open=""><summary>Example</summary><pre id="16c5fe1f-661f-4748-b581-e074bb0d9dfc" class="code"><code>int MPI_Reduce(
	void *sendbuf, // IN
	void *recvbuf, // OUT
	int count, // IN
	MPI_Datatype datatype, // IN (handle)
	MPI_Op op, // IN (handle)
	int root, // IN
	MPI_Comm comm // IN (handle)
);</code></pre></details></li></ul></div></p><p id="40cc65c5-2e1b-4a8b-8552-7f83a7453af0" class="">
</p><p id="b2568296-f5f7-49ef-af3d-cb702a092d7b" class=""><mark class="highlight-blue">Error-status</mark><div class="indented"><p id="6320f874-b398-4caf-8d76-9903b93303bb" class="">Good practice: checking error status</p><pre id="857c2eea-fb15-44ca-8000-c7e998363688" class="code"><code>err = MPI_&lt;some MPI function&gt;(…); // returns ie. MPI_SUCCESS</code></pre><ul id="f9fcfb58-dabb-4942-aa71-49ba783d0b1d" class="toggle"><li><details open=""><summary>List of all error codes</summary><p id="d4f02e93-1620-4d7e-9cce-cd7c4d4c11dc" class="">One can also define new ones.</p><pre id="9f52197e-6b8f-4f90-9202-0aca6f2dd908" class="code"><code>MPI_SUCCESS
MPI_ERR_BUFFER
MPI_ERR_COUNT
MPI_ERR_TYPE
MPI_ERR_TAG
MPI_ERR_COUNT
MPI_ERR_RANK
…
MPI_ERR_UNKNOWN
MPI_ERR_TRUNCATE // sometimes returned for point-to-point
…
MPI_ERR_WIN
MPI_ERR_LASTCODE</code></pre><p id="0d9180c1-3d0b-4546-864a-ee3f2d0435e7" class="">
</p></details></li></ul></div></p><p id="18e6fe38-32c6-48f6-abf5-12dc2cb014e3" class=""><mark class="highlight-blue">Calling with try-catch similar function</mark><div class="indented"><p id="ba422ab3-65cc-45d7-8371-5e7a72aa224f" class=""><mark class="highlight-gray"><code>errhandle</code></mark>: handle to function that will be called on error (but usually it doesn’t work and the function will just abort)</p><pre id="6c347ee8-32e0-4d89-a6f4-4a08f62ad2c4" class="code"><code>MPI_Comm_set_errhandler(comm,errhandle)</code></pre></div></p><p id="c6d5356b-71e8-4813-8013-aa2d3cb5341e" class="">
</p><p id="aa86ce48-abb2-4628-8a8f-2be07072dd9d" class=""><mark class="highlight-blue">First and last coll of MPI in application (only called once)</mark><div class="indented"><pre id="3916928f-2fda-43d6-83e0-c936daa05c53" class="code"><code>MPI_Init(&amp;argc,&amp;argv);
MPI_Finalize();</code></pre></div></p><p id="1d340ac1-8c55-4376-9342-7600a2e39e1f" class="">
</p><p id="9257530c-c9c2-4998-ae52-0dcf9f088f41" class=""><mark class="highlight-blue">Size of communicator and process rank</mark><div class="indented"><pre id="1f851576-3543-45e9-9b70-b64e60127ca1" class="code"><code>MPI_Comm_rank(MPI_COMM_WORLD,&amp;rank);
MPI_Comm_size(MPI_COMM_WORLD,&amp;size);</code></pre><hr id="484f0db8-d6a4-42b3-8319-093b8638af81"/><ul id="e766e340-7e79-485c-bf82-b9994e4c0ed8" class="toggle"><li><details open=""><summary>Example: Check rank and size of communicator</summary><pre id="b1f104c5-6b11-456f-9349-6cb1dfb18b2f" class="code"><code>#include &lt;mpi.h&gt;

int main(int argc, char *argv[]) {
	int rank, size;
	MPI_Init(&amp;argc, &amp;argv); // first call, performed by all -&gt; MPI_Initialized(flag)

	MPI_Comm_size(MPI_COMM_WORLD, &amp;size);
	MPI_Comm_rank(MPI_COMM_WORLD, &amp;rank); // Who am I?

	fprintf(stdout,&quot;Here is %d out of %d\n&quot;, rank, size);

	MPI_Finalize(); // last call, performed by all -&gt; MPI_Finalized(flag)
	return 0;
}</code></pre><p id="4e153784-09e4-4420-9c03-23ab4c77eea2" class="">
</p></details></li></ul><ul id="39dad302-ce80-43f3-b88f-bff6db503b16" class="toggle"><li><details open=""><summary>Example: Assign task to processor</summary><pre id="9248e096-af6e-47e8-b3a3-80ca4f638337" class="code"><code>MPI_Comm_size(MPI_COMM_WORLD,&amp;size);
MPI_Comm_rank(MPI_COMM_WORLD,&amp;rank);

if (size&lt;10 || size&gt;1000000) MPI_Abort(comm,errcode);

if (rank==0) {
	// code for rank 0; may be special
} else if (rank%2==0) {
	// remainder even ranks
} else if (rank==7) {
	// another special one
} else {
	// all other (odd) processes…
}</code></pre></details></li></ul></div></p><p id="b04ac0b0-cd22-45a3-bac2-8a2065e4076a" class="">
</p><p id="6a5c08d0-f0f9-484d-9362-ee9601151ced" class=""><mark class="highlight-blue">Benchmarking</mark><div class="indented"><pre id="5a5f4331-7b22-4361-b377-35e4a9b331ff" class="code"><code>MPI_Barrier(MPI_COMM_WORLD); // synchronize processes (semantically)
double point_in_time = MPI_Wtime(); // get time</code></pre></div></p><p id="f249445b-825d-4dde-b271-271a6778249c" class="">
</p><p id="04a9403b-7d1c-43e0-a19a-edcb2387605a" class=""><mark class="highlight-blue">Freeing memory for communicators</mark><div class="indented"><p id="bb1351e8-89bd-4707-ac5c-84d5ab0328d4" class="">Frees any allocated communicator after use.</p><pre id="98d4ad9d-0cd7-4545-8165-77715def8f90" class="code"><code>MPI_Comm_free(&amp;comm);</code></pre><p id="636b9d33-8c0a-485d-913e-65f4c4ee1e90" class=""><mark class="highlight-gray">(</mark><mark class="highlight-gray"><code>MPI_COMM_WORLD</code></mark><mark class="highlight-gray">, </mark><mark class="highlight-gray"><code>MPI_COMM_SELF</code></mark><mark class="highlight-gray"> can not be freed)</mark></p></div></p><p id="97b492d1-858c-4a8e-a429-031df9d87f00" class="">
</p><p id="7b824727-d0f5-45f0-9aa3-52be72e0ab02" class="">
</p><h1 id="f9bdb4ab-358c-40d2-9677-95896641588d" class="">Point-to-point communication</h1><p id="5305765d-f308-4a2b-a89f-eed864856fbf" class=""><mark class="highlight-blue">Point-to-point communication</mark><div class="indented"><p id="9459b0ab-f4fe-47cd-998c-f27f7df4b759" class="">Two processes communicate explicitly.</p><p id="0718696f-228e-4060-a5ae-a613927355c1" class="">Both involved as: sender, receiver.</p></div></p><figure id="41e21793-b4eb-410e-9dcd-f26e3af7349f" class="image"><a href="MPI%2072068f7d370a4815972d9621a10519f0/Untitled%202.png"><img style="width:144px" src="MPI%2072068f7d370a4815972d9621a10519f0/Untitled%202.png"/></a></figure><p id="a2267f06-9331-480d-9844-96ee595da936" class=""><mark class="highlight-blue">General properties</mark><div class="indented"><p id="5fbf732b-542c-44cb-9bc2-7c666defbec6" class="">Deadlock free		Message is eventually received (with matching operations)</p><p id="fb09fdb3-4ae7-42fc-9ec9-7fe41d98475b" class="">Non-overtaking	Messages sent to the same destination arrive there in sent order.</p><p id="8dbb7acd-e42b-4dca-bc89-cc23696fcbc2" class="">				Different order can be enforced with tags.</p><p id="39143332-4c69-4a16-b771-3b049d2929c6" class="">Reliable			Messages don’t get lost, content can be trusted.</p></div></p><p id="46974a44-d667-4b24-94f1-7942b6c2a642" class="">
</p><h2 id="62d210f6-3793-4830-9817-a2963463055f" class="">Sending</h2><p id="f75f51de-0b9f-4337-b6eb-12897516dabe" class=""><mark class="highlight-blue">Sender</mark><div class="indented"><p id="a24b7a4d-ffc9-4e7f-bdc0-7449c187920f" class="">Completion is non-local:<div class="indented"><p id="021f442b-a880-4f4f-adf7-b8cff437c13d" class="">Call return may depend on receiving rank having initiated receive operation.</p><p id="c0328edc-4500-4477-9761-d9a67f79461b" class="">The local completion depends on implementation (can be done so that the sender returns fast).</p></div></p><p id="5cbd07b0-4e80-48f3-98a7-2dfda2b5d0c4" class="">Operation is blocking:<div class="indented"><p id="ffdc5983-e7e4-4e8e-855e-b28ea166ada7" class=""><mark class="highlight-gray"><code>MPI_Send</code></mark><mark class="highlight-gray"> </mark>returns back to caller of function, when <mark class="highlight-gray"><code>sendbuf</code></mark><mark class="highlight-gray"> </mark>is safe to be reused again (not necessarily when message is received).</p></div></p><p id="f33ce80f-7715-4ee7-a615-ff05270c5d00" class="">Operation is non-overtaking:<div class="indented"><p id="588abd8e-4f65-4d75-a999-da50b9be7ed4" class="">Messages sent to the same destination arrive there in sent order.</p></div></p><pre id="beb43daa-d160-4c11-86bc-9aa80b5426c7" class="code"><code>MPI_Send(
	void *sendbuf, // pointer to data to be sent
	int count, // number of units to be sent
	MPI_Datatype datatype, // datatype of unit (unchecked, programmers responsibility)
	int dest, // rank of receiver
	int tag, // type of message
	MPI_Comm comm // communicator (in which both are placed)
);</code></pre><p id="b55e90c7-5d33-4068-af8a-0414f4a1ad6b" class="">Convention: Buffer size must be divisible by 3.</p></div></p><p id="12eeee93-102c-4507-9ccf-5cc229d2e196" class="">
</p><p id="c59c3809-f6fb-4f59-8a33-4511158b6c3d" class=""><mark class="highlight-blue">Multiple implementations in library</mark><div class="indented"><p id="5c7eb1cf-f8bd-4b97-9a8d-e26c69402ec7" class=""><mark class="highlight-gray"><code>MPI_Send</code></mark><mark class="highlight-gray">	</mark>standard - returns when buffer can be used</p><p id="9be9ab36-7200-4c3b-ae02-e1c3f5d0e371" class=""><mark class="highlight-gray"><code>MPI_Ssend</code></mark>	synchronous - returns when buffer can be used and recipient received</p><p id="2c14bf02-3f42-44ef-ac7a-a4d75a7232f4" class=""><mark class="highlight-gray"><code>MPI_Bsend</code></mark>	buffered - returns immediately (also copies data to immediate buffer)</p><p id="fd0dce71-31b5-445a-a69a-8ac57e87d337" class=""><mark class="highlight-gray"><code>MPI_Rsend</code></mark>	ready - precondition: receive must have been posted (acknowledgement)</p><p id="a58131a4-2c8f-42f6-bf05-aecd8c59f609" class=""><mark class="highlight-gray"><code>MPI_Isend</code></mark>	immediate - returns immediately</p></div></p><p id="266ddabd-47d7-4f08-a882-4490d80b92a4" class="">
</p><h2 id="2747afdc-a51a-43f9-a273-767ce62dab1f" class="">Receiving</h2><p id="f0e058a7-f9e3-4964-9164-a73cb769f9cc" class=""><mark class="highlight-blue">Recipient</mark><div class="indented"><p id="9b80c02d-04c5-40ef-b61f-5a2a2d2a075a" class="">Operation is blocking:<div class="indented"><p id="4e6804a5-02a0-460c-a7ea-ac1277868082" class=""><mark class="highlight-gray"><code>MPI_Recv</code></mark><mark class="highlight-gray"> </mark>returns back to caller of function, when message has been received (Can take forever → deadlock).</p><p id="aab2eab5-7cb7-4331-8bb8-146b568da6c1" class="">Then stores status in given pointer (ie. status is <mark class="highlight-gray"><code>MPI_ERR_TRUNCATE</code></mark><mark class="highlight-gray"> </mark>if buffer of receiver is not large enough).</p></div></p><pre id="729baa27-516d-4e6b-84eb-79a427be711e" class="code"><code>MPI_Recv(
	// ... same as above
	MPI_Status *status // status of received message
);</code></pre><p id="7d2aac10-e521-440c-aff2-ef48be60d68c" class=""><mark class="highlight-teal">Wildcards:</mark> Can accept message from any rank with <code><mark class="highlight-gray">MPI_ANY_SOURCE</mark></code><mark class="highlight-gray"><mark class="highlight-gray"> </mark></mark>and any tag with <code><mark class="highlight-gray"><mark class="highlight-gray">MPI_ANY_TAG</mark></mark></code> (but leads to non-determinism).</p><p id="e150c1e1-b1c5-4594-8cbd-e20ea91a9f76" class="">Convention: Buffer size must be divisible by 3.</p></div></p><p id="538964ec-51e3-4351-8fa8-f71d244674e0" class="">
</p><p id="7f0ec931-d7c1-415a-8955-43df8ad9346b" class=""><mark class="highlight-blue">Multiple implementations in library</mark><div class="indented"><p id="b4774a54-69ee-47dc-9202-0458e0cf9d41" class=""><mark class="highlight-gray"><code>MPI_Rece</code></mark><mark class="highlight-gray">	</mark>Standard - blocking</p><p id="538ca71f-a1e4-4f41-a8b9-a4ede72337c0" class=""><mark class="highlight-gray"><code>MPI_IRecv</code></mark>	Immediate - nonblocking</p></div></p><p id="9e061465-d085-4f65-866b-11f8bfcb07d2" class="">
</p><p id="53a0a28d-a1f0-4e15-b16f-511a83d1a4ef" class=""><mark class="highlight-blue">Counting received data</mark><div class="indented"><pre id="5f185986-947f-4f5e-94ca-76e5c188caeb" class="code"><code>MPI_Get_count(status,datatype,count);
MPI_Get_elements(status,datatype,count);</code></pre><p id="26846eb3-5762-4566-ba34-2cb72bd55fb4" class="">Both are equivalent for basic datatypes such as <mark class="highlight-gray"><code>MPI_INT</code></mark>, ...</p><hr id="fef0eca3-1024-41f1-838b-798bf125901a"/><ul id="c4d3c4c7-02f7-4e3c-a920-73436b62d7e1" class="toggle"><li><details open=""><summary>Example</summary><pre id="8fa064f7-f124-480b-b928-0c3d38a7807c" class="code"><code>#include &lt;assert.h&gt;

int recvbuf[600]; // large enough
count = 600; // equal or larger to what is being sent

MPI_Status status;
success = MPI_Recv(recvbuf,count,MPI_INT,2,THISMSG,comm,&amp;status);

int realcount;
MPI_Get_count(status,MPI_INT,&amp;realcount);
// possibly realcount&lt;count;
assert(realcount&lt;=count);</code></pre></details></li></ul></div></p><p id="0bba5095-7c41-4c9f-90e5-3c9e676a3a7a" class="">
</p><p id="4318575f-e5cd-4c8d-a3cd-098a6467054e" class=""><mark class="highlight-blue">Sources of non-determinism</mark><div class="indented"><p id="39c62494-603b-4423-bdb2-cee5a45c474f" class="">Deterministic messages are non-overtaking (messages sent arrive at destination in same order).</p><ol type="1" id="c6b9eb7a-9cec-45da-b26d-2f19f37037f8" class="numbered-list" start="1"><li>Wildcards<pre id="ffcaf5be-2248-4100-ba21-b0a24c055da8" class="code"><code>MPI_Recv(..., MPI_ANY_SOURCE, MPI_ANY_TAG, ...);</code></pre><p id="8c30cba7-815f-455b-9917-b6562f8a0148" class="">Any message, from any sender at any time</p></li></ol><ol type="1" id="84d6f505-75e8-432c-ae21-a013e124bef4" class="numbered-list" start="2"><li>Probe<pre id="ce65c77b-77b6-4bbd-9a3e-7ab5f034625f" class="code"><code>MPI_Probe(source,tag,comm,&amp;status); // blocking
MPI_Iprobe(source,tag,comm,&amp;flag,&amp;status); // nonblocking</code></pre><p id="8da83862-4c9a-41ea-9d0c-632e03aea423" class="">Stops blocking, when message with given source, and tag in comm have arrived and is ready for reception <mark class="highlight-gray">(</mark><mark class="highlight-gray"><code>MPI_Recv()</code></mark><mark class="highlight-gray"> then can be called without blocking)</mark>.</p><p id="873baaba-d6f9-42ba-8ff2-6e67bdc68aa4" class=""><code><mark class="highlight-gray">flag == 1</mark></code> means message with source and tag ready for reception in comm (then <mark class="highlight-gray"><code>status</code></mark> is also updated).</p><hr id="65314aa5-31ab-429f-b5d6-aaffe3debab6"/><ul id="0a5cd875-7388-47f7-b215-93edad781587" class="toggle"><li><details open=""><summary>Example</summary><pre id="2a02d50d-306a-46b9-8cd9-7cb8834a867e" class="code"><code>#include &lt;assert.h&gt;

MPI_Status status;
int tag = 777;

MPI_Probe(MPI_ANY_SOURCE,tag,comm,&amp;status);
// blocking call - returns when message with tag 777 has arrived
assert(status.MPI_TAG==tag);

int source = status.MPI_SOURCE;
int count;
MPI_Get_count(status,MPI_INT,&amp;count); // get count
recvbuf = (int*)malloc(count*sizeof(int)); // allocate
MPI_Recv(recvbuf,count,MPI_INT,source,tag,comm,MPI_STATUS_IGNORE);</code></pre></details></li></ul></li></ol></div></p><p id="dc5d2552-6eab-4781-91d5-94fdfc2d4fa7" class="">
</p><h2 id="049a56c1-254e-4db4-b009-24c173a6f0db" class="">Examples</h2><p id="44d5f1ef-4676-4a42-abd3-71a2503228ac" class=""><mark class="highlight-blue">Examples</mark><div class="indented"><ul id="39588f2c-f0c2-4600-8c68-ad917d53a3a1" class="toggle"><li><details open=""><summary>Example: Sending double and integer</summary><pre id="15529a6b-ffe9-4b3c-be4a-a0e9b7a89db1" class="code"><code>int a[N];
float area;
MPI_Send(a,N,MPI_INT,j,TAG1,MPI_COMM_WORLD); // send a
MPI_Send(&amp;area,1,MPI_FLOAT,j,TAG2,MPI_COMM_WORLD); // send area</code></pre><p id="141ecbbe-2387-45bb-b645-c84456a571b5" class="">	<style>@import url('https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.13.2/katex.min.css')</style><span data-token-index="0" contenteditable="false" class="notion-text-equation-token" style="user-select:all;-webkit-user-select:all;-moz-user-select:all"><span></span><span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mstyle mathsize="1.2em"><mo>↓</mo></mstyle></mrow><annotation encoding="application/x-tex">\large \downarrow </annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.066656em;vertical-align:-0.23332799999999998em;"></span><span class="mrel sizing reset-size6 size7">↓</span></span></span></span></span><span>﻿</span></span></p><pre id="08733d35-32a5-498f-bedd-3c4deaa01209" class="code"><code>int a[N];
float area;
MPI_Recv(a,N,MPI_INT,j,TAG1,MPI_COMM_WORLD); // receive a
MPI_Recv(&amp;area,1,MPI_FLOAT,j,TAG2,MPI_COMM_WORLD); // receive area</code></pre><p id="8c24f899-4465-4f85-b334-f874fe8047f2" class="">
</p></details></li></ul><ul id="166a8f69-f75a-4db6-81bc-deb2e322a766" class="toggle"><li><details open=""><summary>Example: Sending 500 integers</summary><p id="c2f9d7de-0579-4c8e-b631-ab6928623b3e" class="">Process2 <mark class="highlight-gray">- </mark><em><mark class="highlight-gray">500 integers →</mark></em><em> </em>Process500</p><pre id="0af573c4-f48b-40a8-a2f1-3984d8b9c746" class="code"><code>int THISMSGTAG = 777; // message TAG
int count = 500;

if (rank==2) {
	int sendbuf[500] = {&lt;500 integers&gt;};
	MPI_Send(sendbuf,count,MPI_INT,4,THISMSGTAG,comm);

} else if (rank==4) {
	int recvbuf[count + 100]; // equal or larger than what is being sent
	MPI_Status status;
	success = MPI_Recv(recvbuf,count,MPI_INT,2,THISMSGTAG,comm,&amp;status);

}</code></pre><p id="77d6bca0-7d39-4d82-bdf9-f3ce8f27b5d3" class=""><em>“Start reception of message </em><mark class="highlight-gray"><code><em>THISMSGTAG</em></code></mark><em> from rank 2 in </em><mark class="highlight-gray"><code><em>comm</em></code></mark><em>, store result in </em><mark class="highlight-gray"><code><em>recvbuf</em></code></mark><em>, at most 600 consecutive integers (otherwise </em><mark class="highlight-gray"><code><em>success==MPI_ERR_TRUNCATE</em></code></mark><em>)</em></p></details></li></ul><ul id="17ae5580-25e5-4936-952a-185610a27a24" class="toggle"><li><details open=""><summary>Example: Non matching types</summary><p id="e2fdd91c-9f2d-43d7-9a2e-bf96aa0add06" class="">Here the types dont match.<div class="indented"><p id="b38454cc-2ea9-4d7a-ad37-aad606726af2" class="">Communication would take place but its bad practice.</p><p id="765c6e38-d55d-46a6-bce6-2b43e2957683" class="">Type could be lost → Processors could have different endianness.</p></div></p><pre id="0583a709-2d6e-48d9-bc61-85f6f8f3c4ea" class="code"><code>double a;
MPI_Send(&amp;a,1,MPI_DOUBLE,j,1111,MPI_COMM_WORLD);</code></pre><p id="2f939402-cdfb-47f1-8453-8daa517bf17a" class="">	<style>@import url('https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.13.2/katex.min.css')</style><span data-token-index="0" contenteditable="false" class="notion-text-equation-token" style="user-select:all;-webkit-user-select:all;-moz-user-select:all"><span></span><span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mstyle mathsize="1.2em"><mo>↓</mo></mstyle></mrow><annotation encoding="application/x-tex">\large \downarrow </annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.066656em;vertical-align:-0.23332799999999998em;"></span><span class="mrel sizing reset-size6 size7">↓</span></span></span></span></span><span>﻿</span></span></p><pre id="a5ebc336-8c31-40d0-ad88-f93dd3ed84f5" class="code"><code>double a;
MPI_Recv(a,sizeof(double),MPI_BYTE,i,1111,MPI_COMM_WORLD,MPI_STATUS_IGNORE);</code></pre><p id="0c5c683c-eb77-402f-9459-6d59e0e8de15" class="">
</p></details></li></ul></div></p><p id="3bb93f80-21a1-41a9-86ff-42b223ae8807" class="">
</p><p id="33f945cb-345a-42ea-9c30-bc37aade62f1" class=""><mark class="highlight-blue">Synchronization with 0-count message</mark><div class="indented"><ul id="ac617922-8be6-4aaa-a14d-1d9ed0e7e636" class="toggle"><li><details open=""><summary>Example: One sided synchronization</summary><p id="9f82e61d-0779-4aa0-a8c5-1da861bfce83" class="">MPI processes are not synchronized - messages can be used.<div class="indented"><p id="490a0632-c854-4574-9055-caf2513f2179" class="">Receiving process cannnot proceed before message arrives.</p></div></p><pre id="15f511c0-d983-46aa-8fd9-823afa0923d1" class="code"><code>MPI_Send(NULL,0,MPI_INT,dest,tag,comm); // 0 count message
		↓
MPI_Recv(NULL,0,MPI_INT,source,tag,comm,&amp;status);</code></pre><p id="4368ad17-f192-42d1-a2a1-952f520c48b3" class="">
</p></details></li></ul><ul id="414ca134-62f9-435a-8a46-f71709e3798e" class="toggle"><li><details open=""><summary>Example: Pairwise synchronization</summary><pre id="9f72ba2f-6878-48e7-814c-b44fd38bb3c2" class="code"><code>MPI_Ssend(NULL,0,MPI_INT,dest,tag,comm); // blocks until message received
		↓
MPI_Recv(NULL,0,MPI_INT,source,tag,comm,&amp;stat);</code></pre><p id="74c81f2f-351a-43ac-bb97-2d4c9d6ef355" class="">
</p></details></li></ul></div></p><p id="c212d72c-a785-407b-aaf2-dd563a00b9fb" class="">
</p><h2 id="05dd7151-9963-4f80-a135-c21c14ee36f0" class="">Safe programming</h2><p id="8f4d33a3-6b4f-4c60-a51e-3453f43538c0" class=""><mark class="highlight-blue">Unsafe programming</mark><div class="indented"><p id="efd195ef-a9a5-47ef-b65e-fc0dbbebc341" class="">It’s possible that the program does not lead to a deadlock if multiple processors <mark class="highlight-gray">MPI_Send()</mark> to eachother simultaniously.</p><p id="de19024e-02dc-4b79-be48-794618b48b34" class="">The  exact conditions of local-completion depend on the implementation in the library.</p><hr id="4d374fed-7200-4f85-a774-e49a710222bb"/><ul id="6c43a979-7c57-49f4-acf4-53751608df4a" class="toggle"><li><details open=""><summary>Example: 2d, 5-point stencil algorithm (unsafe)</summary><p id="b2b50c50-004c-469a-9a96-e29d741c09c0" class="">Given <style>@import url('https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.13.2/katex.min.css')</style><span data-token-index="0" contenteditable="false" class="notion-text-equation-token" style="user-select:all;-webkit-user-select:all;-moz-user-select:all"><span></span><span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>m</mi><mo>×</mo><mi>n</mi></mrow><annotation encoding="application/x-tex">m \times n</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.66666em;vertical-align:-0.08333em;"></span><span class="mord mathnormal">m</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">×</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.43056em;vertical-align:0em;"></span><span class="mord mathnormal">n</span></span></span></span></span><span>﻿</span></span> matrix <style>@import url('https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.13.2/katex.min.css')</style><span data-token-index="0" contenteditable="false" class="notion-text-equation-token" style="user-select:all;-webkit-user-select:all;-moz-user-select:all"><span></span><span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>u</mi></mrow><annotation encoding="application/x-tex">u</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.43056em;vertical-align:0em;"></span><span class="mord mathnormal">u</span></span></span></span></span><span>﻿</span></span>:<div class="indented"><p id="03c93fc5-81c0-480a-a15b-ff727b5d8a30" class=""><style>@import url('https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.13.2/katex.min.css')</style><span data-token-index="0" contenteditable="false" class="notion-text-equation-token" style="user-select:all;-webkit-user-select:all;-moz-user-select:all"><span></span><span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mstyle mathsize="0.9em"><mi>u</mi><mo stretchy="false">[</mo><mi>i</mi><mo separator="true">,</mo><mi>j</mi><mo stretchy="false">]</mo><mo>←</mo><mfrac><mn>1</mn><mn>4</mn></mfrac><mo>⋅</mo><mo stretchy="false">(</mo><mstyle mathcolor="pink"><mi>u</mi><mo stretchy="false">[</mo><mi>i</mi><mo separator="true">,</mo><mi>j</mi><mo>−</mo><mn>1</mn><mo stretchy="false">]</mo><mo>+</mo><mi>u</mi><mo stretchy="false">[</mo><mi>i</mi><mo separator="true">,</mo><mi>j</mi><mo>+</mo><mn>1</mn><mo stretchy="false">]</mo><mo>+</mo><mi>u</mi><mo stretchy="false">[</mo><mi>i</mi><mo>−</mo><mn>1</mn><mo separator="true">,</mo><mi>j</mi><mo stretchy="false">]</mo><mo>+</mo><mi>u</mi><mo stretchy="false">[</mo><mi>i</mi><mo>+</mo><mn>1</mn><mo separator="true">,</mo><mi>j</mi><mo stretchy="false">]</mo></mstyle><mo>−</mo><msup><mi>h</mi><mn>2</mn></msup><mo>⋅</mo><mi>f</mi><mo stretchy="false">(</mo><mi>i</mi><mo separator="true">,</mo><mi>j</mi><mo stretchy="false">)</mo><mo stretchy="false">)</mo></mstyle></mrow><annotation encoding="application/x-tex">\small u[i,j] \larr \frac{1}{4}\cdot (\textcolor{pink}{u[i,j-1]+u[i,j+1]+u[i-1,j]+u[i+1,j]}-h^
2 \cdot f(i,j))</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.9em;vertical-align:-0.225em;"></span><span class="mord mathnormal sizing reset-size6 size5">u</span><span class="mopen sizing reset-size6 size5">[</span><span class="mord mathnormal sizing reset-size6 size5">i</span><span class="mpunct sizing reset-size6 size5">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathnormal sizing reset-size6 size5" style="margin-right:0.05724em;">j</span><span class="mclose sizing reset-size6 size5">]</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel sizing reset-size6 size5">←</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1.051764em;vertical-align:-0.3105em;"></span><span class="mord sizing reset-size6 size5"><span class="mopen nulldelimiter sizing reset-size5 size6"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8236266666666667em;"><span style="top:-2.6550000000000002em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size5 size2 mtight"><span class="mord mtight"><span class="mord mtight">4</span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.394em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size5 size2 mtight"><span class="mord mtight"><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.345em;"><span></span></span></span></span></span><span class="mclose nulldelimiter sizing reset-size5 size6"></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin sizing reset-size6 size5">⋅</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.9em;vertical-align:-0.225em;"></span><span class="mopen sizing reset-size6 size5">(</span><span class="mord mathnormal sizing reset-size6 size5" style="color:pink;">u</span><span class="mopen sizing reset-size6 size5" style="color:pink;">[</span><span class="mord mathnormal sizing reset-size6 size5" style="color:pink;">i</span><span class="mpunct sizing reset-size6 size5" style="color:pink;">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathnormal sizing reset-size6 size5" style="margin-right:0.05724em;color:pink;">j</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin sizing reset-size6 size5" style="color:pink;">−</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.9em;vertical-align:-0.225em;"></span><span class="mord sizing reset-size6 size5" style="color:pink;">1</span><span class="mclose sizing reset-size6 size5" style="color:pink;">]</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin sizing reset-size6 size5" style="color:pink;">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.9em;vertical-align:-0.225em;"></span><span class="mord mathnormal sizing reset-size6 size5" style="color:pink;">u</span><span class="mopen sizing reset-size6 size5" style="color:pink;">[</span><span class="mord mathnormal sizing reset-size6 size5" style="color:pink;">i</span><span class="mpunct sizing reset-size6 size5" style="color:pink;">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathnormal sizing reset-size6 size5" style="margin-right:0.05724em;color:pink;">j</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin sizing reset-size6 size5" style="color:pink;">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.9em;vertical-align:-0.225em;"></span><span class="mord sizing reset-size6 size5" style="color:pink;">1</span><span class="mclose sizing reset-size6 size5" style="color:pink;">]</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin sizing reset-size6 size5" style="color:pink;">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.9em;vertical-align:-0.225em;"></span><span class="mord mathnormal sizing reset-size6 size5" style="color:pink;">u</span><span class="mopen sizing reset-size6 size5" style="color:pink;">[</span><span class="mord mathnormal sizing reset-size6 size5" style="color:pink;">i</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin sizing reset-size6 size5" style="color:pink;">−</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.9em;vertical-align:-0.225em;"></span><span class="mord sizing reset-size6 size5" style="color:pink;">1</span><span class="mpunct sizing reset-size6 size5" style="color:pink;">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathnormal sizing reset-size6 size5" style="margin-right:0.05724em;color:pink;">j</span><span class="mclose sizing reset-size6 size5" style="color:pink;">]</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin sizing reset-size6 size5" style="color:pink;">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.9em;vertical-align:-0.225em;"></span><span class="mord mathnormal sizing reset-size6 size5" style="color:pink;">u</span><span class="mopen sizing reset-size6 size5" style="color:pink;">[</span><span class="mord mathnormal sizing reset-size6 size5" style="color:pink;">i</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin sizing reset-size6 size5" style="color:pink;">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.9em;vertical-align:-0.225em;"></span><span class="mord sizing reset-size6 size5" style="color:pink;">1</span><span class="mpunct sizing reset-size6 size5" style="color:pink;">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathnormal sizing reset-size6 size5" style="margin-right:0.05724em;color:pink;">j</span><span class="mclose sizing reset-size6 size5" style="color:pink;">]</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin sizing reset-size6 size5">−</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.713364em;vertical-align:0em;"></span><span class="mord sizing reset-size6 size5"><span class="mord mathnormal">h</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.7926266666666666em;"><span style="top:-2.963em;margin-right:0.05555555555555556em;"><span class="pstrut" style="height:2.6em;"></span><span class="sizing reset-size5 size2 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin sizing reset-size6 size5">⋅</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.9em;vertical-align:-0.225em;"></span><span class="mord mathnormal sizing reset-size6 size5" style="margin-right:0.10764em;">f</span><span class="mopen sizing reset-size6 size5">(</span><span class="mord mathnormal sizing reset-size6 size5">i</span><span class="mpunct sizing reset-size6 size5">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathnormal sizing reset-size6 size5" style="margin-right:0.05724em;">j</span><span class="mclose sizing reset-size6 size5">))</span></span></span></span></span><span>﻿</span></span></p><figure id="92b5d308-d01f-4ba2-81df-8fa3aea7e965" class="image"><a href="MPI%2072068f7d370a4815972d9621a10519f0/Untitled%203.png"><img style="width:192px" src="MPI%2072068f7d370a4815972d9621a10519f0/Untitled%203.png"/></a></figure></div></p><p id="5de9336a-e453-421a-8f6e-6085693d9e74" class="">Special conditions on borders:<div class="indented"><p id="9c5d2fa7-18ab-4c19-b45e-a5042ed18993" class=""><mark class="highlight-gray"><code>i=0</code></mark>, <mark class="highlight-gray"><code>i=m-1</code></mark>, <mark class="highlight-gray"><code>j=0</code></mark>, <mark class="highlight-gray"><code>j=n-1</code></mark></p></div></p><p id="0b229554-2f90-4ac1-863d-b91daf0a904c" class="">Sequential solution:<div class="indented"><p id="160d6153-547a-43fe-b083-20d5b4f1d9f1" class=""><style>@import url('https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.13.2/katex.min.css')</style><span data-token-index="0" contenteditable="false" class="notion-text-equation-token" style="user-select:all;-webkit-user-select:all;-moz-user-select:all"><span></span><span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mstyle mathsize="0.9em"><mi>O</mi><mo stretchy="false">(</mo><mi>m</mi><mo>⋅</mo><mi>n</mi><mo>⋅</mo><mi>f</mi><mo stretchy="false">)</mo></mstyle></mrow><annotation encoding="application/x-tex">\small O(m\cdot n \cdot f)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.9em;vertical-align:-0.225em;"></span><span class="mord mathnormal sizing reset-size6 size5" style="margin-right:0.02778em;">O</span><span class="mopen sizing reset-size6 size5">(</span><span class="mord mathnormal sizing reset-size6 size5">m</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin sizing reset-size6 size5">⋅</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.400005em;vertical-align:0em;"></span><span class="mord mathnormal sizing reset-size6 size5">n</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin sizing reset-size6 size5">⋅</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.9em;vertical-align:-0.225em;"></span><span class="mord mathnormal sizing reset-size6 size5" style="margin-right:0.10764em;">f</span><span class="mclose sizing reset-size6 size5">)</span></span></span></span></span><span>﻿</span></span> per iteration</p></div></p><hr id="b862a8a7-18b3-40e1-bd82-eec2753b9b65"/><p id="37eba6ee-3a93-46a6-9604-c40a54fe26d9" class="">Parallelization<div class="indented"><p id="4b3f9c46-0ab4-471e-ba1b-7800fbfdba14" class="">We split the matrix into equal sized submatrices <style>@import url('https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.13.2/katex.min.css')</style><span data-token-index="0" contenteditable="false" class="notion-text-equation-token" style="user-select:all;-webkit-user-select:all;-moz-user-select:all"><span></span><span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mstyle mathsize="0.9em"><msup><mi>m</mi><mo mathvariant="normal" lspace="0em" rspace="0em">′</mo></msup><mo>×</mo><msup><mi>n</mi><mo mathvariant="normal" lspace="0em" rspace="0em">′</mo></msup></mstyle></mrow><annotation encoding="application/x-tex">\small m&#x27; \times n&#x27;</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.7350329999999999em;vertical-align:-0.07499700000000001em;"></span><span class="mord sizing reset-size6 size5"><span class="mord mathnormal">m</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.7333733333333333em;"><span style="top:-2.963em;margin-right:0.05555555555555556em;"><span class="pstrut" style="height:2.6em;"></span><span class="sizing reset-size5 size2 mtight"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin sizing reset-size6 size5">×</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.660036em;vertical-align:0em;"></span><span class="mord sizing reset-size6 size5"><span class="mord mathnormal">n</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.7333733333333333em;"><span style="top:-2.963em;margin-right:0.05555555555555556em;"><span class="pstrut" style="height:2.6em;"></span><span class="sizing reset-size5 size2 mtight"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span></span></span></span></span></span></span></span></span><span>﻿</span></span> and perform each locally.</p><p id="e4b20224-93b3-4bbe-9df5-3f64c5770a01" class="">Borders of each matrix must read values from other submatrices → use messages.</p><p id="9cfe87de-7d38-426a-8c7a-79617f6550eb" class="">Work: <style>@import url('https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.13.2/katex.min.css')</style><span data-token-index="0" contenteditable="false" class="notion-text-equation-token" style="user-select:all;-webkit-user-select:all;-moz-user-select:all"><span></span><span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mstyle mathsize="0.9em"><mi>O</mi><mo stretchy="false">(</mo><msup><mi>m</mi><mo mathvariant="normal" lspace="0em" rspace="0em">′</mo></msup><mo>⋅</mo><msup><mi>n</mi><mo mathvariant="normal" lspace="0em" rspace="0em">′</mo></msup><mo>⋅</mo><mi>f</mi><mo stretchy="false">)</mo></mstyle></mrow><annotation encoding="application/x-tex">\small O(m&#x27; \cdot n&#x27; \cdot f)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.9em;vertical-align:-0.225em;"></span><span class="mord mathnormal sizing reset-size6 size5" style="margin-right:0.02778em;">O</span><span class="mopen sizing reset-size6 size5">(</span><span class="mord sizing reset-size6 size5"><span class="mord mathnormal">m</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.7333733333333333em;"><span style="top:-2.963em;margin-right:0.05555555555555556em;"><span class="pstrut" style="height:2.6em;"></span><span class="sizing reset-size5 size2 mtight"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin sizing reset-size6 size5">⋅</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.660036em;vertical-align:0em;"></span><span class="mord sizing reset-size6 size5"><span class="mord mathnormal">n</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.7333733333333333em;"><span style="top:-2.963em;margin-right:0.05555555555555556em;"><span class="pstrut" style="height:2.6em;"></span><span class="sizing reset-size5 size2 mtight"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin sizing reset-size6 size5">⋅</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.9em;vertical-align:-0.225em;"></span><span class="mord mathnormal sizing reset-size6 size5" style="margin-right:0.10764em;">f</span><span class="mclose sizing reset-size6 size5">)</span></span></span></span></span><span>﻿</span></span> per process<div class="indented"><p id="979d1c65-9415-4e74-8d99-1e7f50fbcfaf" class=""><mark class="highlight-gray">update is </mark><mark class="highlight-gray"><style>@import url('https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.13.2/katex.min.css')</style><span data-token-index="0" contenteditable="false" class="notion-text-equation-token" style="user-select:all;-webkit-user-select:all;-moz-user-select:all"><span></span><span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mstyle mathsize="0.9em"><mi>O</mi><mo stretchy="false">(</mo><mi>f</mi><mo stretchy="false">)</mo></mstyle></mrow><annotation encoding="application/x-tex">\small O(f)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.9em;vertical-align:-0.225em;"></span><span class="mord mathnormal sizing reset-size6 size5" style="margin-right:0.02778em;">O</span><span class="mopen sizing reset-size6 size5">(</span><span class="mord mathnormal sizing reset-size6 size5" style="margin-right:0.10764em;">f</span><span class="mclose sizing reset-size6 size5">)</span></span></span></span></span><span>﻿</span></span></mark><mark class="highlight-gray">.</mark></p><p id="83fcf219-c866-4eca-be16-9534b108081e" class=""><mark class="highlight-gray">two messages of </mark><mark class="highlight-gray"><style>@import url('https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.13.2/katex.min.css')</style><span data-token-index="0" contenteditable="false" class="notion-text-equation-token" style="user-select:all;-webkit-user-select:all;-moz-user-select:all"><span></span><span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mstyle mathsize="0.9em"><mi>O</mi><mo stretchy="false">(</mo><msup><mi>m</mi><mo mathvariant="normal" lspace="0em" rspace="0em">′</mo></msup><mo stretchy="false">)</mo></mstyle></mrow><annotation encoding="application/x-tex">\small O(m&#x27;)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.9em;vertical-align:-0.225em;"></span><span class="mord mathnormal sizing reset-size6 size5" style="margin-right:0.02778em;">O</span><span class="mopen sizing reset-size6 size5">(</span><span class="mord sizing reset-size6 size5"><span class="mord mathnormal">m</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.7333733333333333em;"><span style="top:-2.963em;margin-right:0.05555555555555556em;"><span class="pstrut" style="height:2.6em;"></span><span class="sizing reset-size5 size2 mtight"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span></span></span></span></span><span class="mclose sizing reset-size6 size5">)</span></span></span></span></span><span>﻿</span></span></mark><mark class="highlight-gray"> for columns </mark></p><p id="ffb154fe-91c7-42e7-8eaa-c52b59947457" class=""><mark class="highlight-gray">two messages of </mark><mark class="highlight-gray"><style>@import url('https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.13.2/katex.min.css')</style><span data-token-index="0" contenteditable="false" class="notion-text-equation-token" style="user-select:all;-webkit-user-select:all;-moz-user-select:all"><span></span><span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mstyle mathsize="0.9em"><mi>O</mi><mo stretchy="false">(</mo><msup><mi>n</mi><mo mathvariant="normal" lspace="0em" rspace="0em">′</mo></msup><mo stretchy="false">)</mo></mstyle></mrow><annotation encoding="application/x-tex">\small O(n&#x27;)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.9em;vertical-align:-0.225em;"></span><span class="mord mathnormal sizing reset-size6 size5" style="margin-right:0.02778em;">O</span><span class="mopen sizing reset-size6 size5">(</span><span class="mord sizing reset-size6 size5"><span class="mord mathnormal">n</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.7333733333333333em;"><span style="top:-2.963em;margin-right:0.05555555555555556em;"><span class="pstrut" style="height:2.6em;"></span><span class="sizing reset-size5 size2 mtight"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span></span></span></span></span><span class="mclose sizing reset-size6 size5">)</span></span></span></span></span><span>﻿</span></span></mark><mark class="highlight-gray"> for rows </mark></p></div></p></div></p><p id="9c3380d0-3f03-4396-b531-3f70ca46c1ed" class="">
</p><p id="ec194a06-3521-44e5-b7fa-22b50be97d65" class="">Parallel algorithm<div class="indented"><p id="b2c4c2a1-7730-4224-b05f-60318451768a" class="">Assume we are looking at view of rank <style>@import url('https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.13.2/katex.min.css')</style><span data-token-index="0" contenteditable="false" class="notion-text-equation-token" style="user-select:all;-webkit-user-select:all;-moz-user-select:all"><span></span><span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mstyle mathsize="0.9em"><mi>i</mi></mstyle></mrow><annotation encoding="application/x-tex">\small i</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.593568em;vertical-align:0em;"></span><span class="mord mathnormal sizing reset-size6 size5">i</span></span></span></span></span><span>﻿</span></span>.</p><ol type="1" id="e80398cf-14ed-486e-b745-d8d799919413" class="numbered-list" start="1"><li>“Halo-exchange of depth 1” <ol type="i" id="e09734b5-76d5-4b82-82ab-e65d857d8763" class="numbered-list" start="1"><li>Receive rows and columns of 4 neighbour-processes.</li></ol><ol type="i" id="ac7622a2-eb07-4e27-8bca-5a84dd50b0ca" class="numbered-list" start="2"><li>Send rows and columns to 4 neighbour-processes.</li></ol></li></ol><ol type="1" id="a1fc74dc-ff76-4309-bd8b-60f125320bda" class="numbered-list" start="2"><li>Parallel stencil computation</li></ol></div></p><p id="1b361e30-e9ab-461f-9edb-3bcd857e257d" class="">
</p><p id="f1fbb00a-49ca-484d-b3ac-db5b8ed88841" class="">If first receiving, then sending → deadlock<div class="indented"><p id="8c412d45-863e-4c21-9613-07959ef8e017" class="">Each receive blocks until send operation starts (this never happens if multiple interdependent blocks receive simultaniously)</p></div></p><p id="ab509bfa-20c3-4ada-9025-9c0067c1c4d2" class="">If first sending, then receiving → unsafe<div class="indented"><p id="4d4d6bc7-f61a-41f7-aba7-2c1c982d8178" class="">Deadlock only based on message size and library implementation.</p><figure id="d7bb66e3-cff6-4282-8874-2cc43830d504" class="image"><a href="MPI%2072068f7d370a4815972d9621a10519f0/Untitled%204.png"><img style="width:192px" src="MPI%2072068f7d370a4815972d9621a10519f0/Untitled%204.png"/></a></figure></div></p><p id="7a448033-cfdd-4a2a-878c-e85022c041e9" class="">
</p></details></li></ul><ul id="ac590316-ff39-429c-a3c2-1c724442bcf9" class="toggle"><li><details open=""><summary>Example: 1d-stencil (unsafe)</summary><p id="c28d122c-b8b2-4971-a6b1-d94e2a5bf293" class="">Arrays <mark class="highlight-gray"><code>a</code></mark> and <mark class="highlight-gray"><code>b</code></mark> distributed in blocks over MPI processes</p><pre id="3240ff7d-901b-4140-b708-ce76dddd4fff" class="code"><code>for (i=n[j]; i&lt;n[j+1]; i++) {
	b[i] = a[i-1]+a[i]+a[i+1];
}</code></pre><figure id="1b519080-1301-4ce2-a50d-67995d74a044" class="image"><a href="MPI%2072068f7d370a4815972d9621a10519f0/Untitled%205.png"><img style="width:240px" src="MPI%2072068f7d370a4815972d9621a10519f0/Untitled%205.png"/></a></figure><p id="c68552c3-18a0-4df5-b591-95e8846b8bc5" class="">
</p><ol type="1" id="07ea6cef-8162-4f49-82a3-7fd874ef8266" class="numbered-list" start="1"><li>Receiving before sending<pre id="d3619d4f-d476-4f02-a0ad-9114d5122502" class="code"><code>float *a = malloc((n/p+2)*sizeof(float));
a += 1; // offset, such that -1 and n/p can b addressed

// step 1 [1; size-1]
if (rank&gt;0) {
	MPI_Recv(&amp;a[-1],1,MPI_FLOAT,rank-1,999,comm,&amp;status); // &lt;-- DEADLOCK
	MPI_Send(&amp;a[0],1,MPI_FLOAT,rank-1,999,comm);
}

// step 2 [0; size-2]
if (rank&lt;size-1) {
	MPI_Recv(&amp;a[n/p],1,MPI_FLOAT,rank+1,999,comm,&amp;status); // &lt;-- DEADLOCK
	MPI_Send(&amp;a[n/p-1],1,MPI_FLOAT,rank+1,999,comm;
}

for (i=0; i&lt;n/p; i++) {
	b[i] = a[i-1]+a[i]+a[i+1];
}</code></pre><p id="5f569efc-a074-49c1-a75e-fc6871bcec95" class=""><mark class="highlight-red">Deadlock:</mark> Processes try to receive without sending blocks.</p><p id="2c924bbe-035b-4659-a1c0-0779798cac73" class="">
</p></li></ol><ol type="1" id="83189a36-78b4-4919-86ee-31c043381cf2" class="numbered-list" start="2"><li>Sending before receiving<p id="29173a37-b63c-46e2-9041-e70c312c86d9" class="">Is possible without deadlocks <mark class="highlight-red">based on the implementation</mark>:<div class="indented"><p id="3bc7045a-9a62-4030-a3a5-fd4ca9891229" class="">We don’t have to wait until the message was received but until the buffer is safe to use again.</p></div></p><p id="7c7d502b-cdef-44c3-b829-c9657cdfeefc" class=""><mark class="highlight-red">Unsafe</mark> programming.</p></li></ol><p id="43d99569-a479-4061-a776-bfdc719e8396" class="">
</p></details></li></ul></div></p><p id="7246e986-cf7a-49aa-a98f-47f5a016040b" class="">
</p><p id="61af495e-0ac5-4e09-bdfc-7dbe190df93f" class=""><mark class="highlight-blue">Safe programming</mark><div class="indented"><p id="32fd65a2-7a89-4758-bbc6-41514316feb6" class=""><mark class="highlight-teal">A) symmetry breaking (scheduling)</mark><div class="indented"><p id="695b6dff-f61c-4bd1-b321-15c1d303aa4a" class="">Problem: can lead to serialization, difficult with odd number of processes.</p></div></p></div></p><figure id="e4b0d5c8-76de-4b76-af8f-4402ae724942" class="image"><a href="MPI%2072068f7d370a4815972d9621a10519f0/Untitled%206.png"><img style="width:192px" src="MPI%2072068f7d370a4815972d9621a10519f0/Untitled%206.png"/></a></figure><p id="df7203e0-a796-4b37-942b-537540a3eae7" class=""><div class="indented"><p id="2e68a070-ed67-482a-beb7-845cef292b61" class=""><mark class="highlight-teal">B) using </mark><mark class="highlight-teal"><code>MPI_Sendrecv</code></mark><mark class="highlight-teal"> to combine sending and receiving.</mark><div class="indented"><p id="b7ed52bf-90f7-4e61-8427-3f3d6f0caf6c" class="">Performance advantage: utilitzes fully bidirectional communication network.</p><pre id="66af29ee-3a3c-40f8-8077-2030abf3fdca" class="code"><code>MPI_Sendrecv(
	// send
	void *sendbuf, int sendcount, MPI_Datatype sendtype, int dest, int sendtag,
	// receive
	void *recvbuf, int recvcount, MPI_Datatype recvtype, int source, int recvtag,
	MPI_Comm comm, MPI_Status *status
);</code></pre><ul id="cc7b6756-664d-4ed0-99d9-06f611d266ec" class="toggle"><li><details open=""><summary>In depth</summary><p id="9e5eaaf0-2a54-485e-8873-61c2750226cf" class="">Is equivalent to</p><pre id="679d6a47-7ed0-469b-a706-44f830d99bed" class="code"><code>// immediate send
MPI_Request request;
MPI_Irecv(recvbuf,recvcount,recvtype,source,recvtag,comm,&amp;request);

// receive (wait until received)
MPI_Send(sendbuf,sendcount,sendtype,dest,sendtag,comm);

// wait (until sent message received)
MPI_Wait(&amp;request,status);</code></pre></details></li></ul><hr id="633278f5-473b-43f5-ae16-2c7c9bc0b76f"/><ul id="e4697d2e-ad06-4125-90c5-9e5902bc5274" class="toggle"><li><details open=""><summary>Example: 1d-stencil (safe)</summary><p id="beacb7cb-8d45-4ad3-8a23-897d36bf2acb" class="">Arrays <mark class="highlight-gray"><code>a</code></mark> and <mark class="highlight-gray"><code>b</code></mark> distributed in blocks over MPI processes</p><pre id="d9c25890-70a9-4428-ad2f-10d6fd4272f0" class="code"><code>for (i=n[j]; i&lt;n[j+1]; i++) {
	b[i] = a[i-1]+a[i]+a[i+1];
}</code></pre><figure id="d9149232-be79-4e1d-bd46-4441b984ae0d" class="image"><a href="MPI%2072068f7d370a4815972d9621a10519f0/Untitled%205.png"><img style="width:240px" src="MPI%2072068f7d370a4815972d9621a10519f0/Untitled%205.png"/></a></figure><p id="9ed797b8-a656-4cbc-a27a-b1670d4eb11e" class="">
</p><pre id="ea408cc3-6a75-4901-98cb-ceed17a046de" class="code"><code>float *a = malloc((n/p+2)*sizeof(float));
a += 1; // offset, such that -1 and n/p can b addressed

// step 1 [1; size-1]
if (rank&gt;0) {
	MPI_Sendrecv(…,rank+1,…,rank-1,…);
}

// step 2 [0; size-2]
if (rank&lt;size-1) {
	MPI_Sendrecv(…,rank-1,…,rank+1,…);
}

for (i=0; i&lt;n/p; i++) {
	b[i] = a[i-1]+a[i]+a[i+1];
}</code></pre><p id="4439e1e8-1318-45ba-96d0-8fae6c8bf37f" class="">
</p><p id="6ee952aa-18fb-43fb-831e-c0a7866c5d24" class="">
</p></details></li></ul><ul id="95b46cb5-25a0-495f-b115-9e7ac2294eb1" class="toggle"><li><details open=""><summary>Example: Hillis-Steele prefix sums algorithm (safe)</summary><p id="d015ae82-d75c-43b5-a2f3-72e7cae59525" class="">Round <style>@import url('https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.13.2/katex.min.css')</style><span data-token-index="0" contenteditable="false" class="notion-text-equation-token" style="user-select:all;-webkit-user-select:all;-moz-user-select:all"><span></span><span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mstyle mathsize="0.9em"><mi>k</mi></mstyle></mrow><annotation encoding="application/x-tex">\small k</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.624996em;vertical-align:0em;"></span><span class="mord mathnormal sizing reset-size6 size5" style="margin-right:0.03148em;">k</span></span></span></span></span><span>﻿</span></span>, each process <style>@import url('https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.13.2/katex.min.css')</style><span data-token-index="0" contenteditable="false" class="notion-text-equation-token" style="user-select:all;-webkit-user-select:all;-moz-user-select:all"><span></span><span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mstyle mathsize="0.9em"><mi>i</mi></mstyle></mrow><annotation encoding="application/x-tex">\small i</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.593568em;vertical-align:0em;"></span><span class="mord mathnormal sizing reset-size6 size5">i</span></span></span></span></span><span>﻿</span></span>:<div class="indented"><ol type="1" id="b5000a38-9988-4ff0-a3fe-f2ab3f22a1fb" class="numbered-list" start="1"><li>receives partial sum from <style>@import url('https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.13.2/katex.min.css')</style><span data-token-index="0" contenteditable="false" class="notion-text-equation-token" style="user-select:all;-webkit-user-select:all;-moz-user-select:all"><span></span><span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mstyle mathsize="0.9em"><mi>i</mi><mo>−</mo><msup><mn>2</mn><mi>k</mi></msup></mstyle></mrow><annotation encoding="application/x-tex">\small i-2^k</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.668565em;vertical-align:-0.07499700000000001em;"></span><span class="mord mathnormal sizing reset-size6 size5">i</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin sizing reset-size6 size5">−</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.7433639999999999em;vertical-align:0em;"></span><span class="mord sizing reset-size6 size5"><span class="mord">2</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8259599999999999em;"><span style="top:-2.963em;margin-right:0.05555555555555556em;"><span class="pstrut" style="height:2.6em;"></span><span class="sizing reset-size5 size2 mtight"><span class="mord mathnormal mtight" style="margin-right:0.03148em;">k</span></span></span></span></span></span></span></span></span></span></span></span><span>﻿</span></span></li></ol><ol type="1" id="fec32466-eed1-4180-bcae-da38c931a063" class="numbered-list" start="2"><li>sends partial result to <style>@import url('https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.13.2/katex.min.css')</style><span data-token-index="0" contenteditable="false" class="notion-text-equation-token" style="user-select:all;-webkit-user-select:all;-moz-user-select:all"><span></span><span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mstyle mathsize="0.9em"><mi>i</mi><mo>+</mo><msup><mn>2</mn><mi>k</mi></msup></mstyle></mrow><annotation encoding="application/x-tex">\small i+2^k</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.668565em;vertical-align:-0.07499700000000001em;"></span><span class="mord mathnormal sizing reset-size6 size5">i</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin sizing reset-size6 size5">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.7433639999999999em;vertical-align:0em;"></span><span class="mord sizing reset-size6 size5"><span class="mord">2</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8259599999999999em;"><span style="top:-2.963em;margin-right:0.05555555555555556em;"><span class="pstrut" style="height:2.6em;"></span><span class="sizing reset-size5 size2 mtight"><span class="mord mathnormal mtight" style="margin-right:0.03148em;">k</span></span></span></span></span></span></span></span></span></span></span></span><span>﻿</span></span></li></ol></div></p><pre id="0776be87-c434-4478-8b07-2ef178d25cd4" class="code"><code>MPI_Sendrecv(…, rank+2^k, …, rank-2^k, …);</code></pre><p id="b9bd846f-a4ff-43e8-9315-9b63590aed47" class="">
</p></details></li></ul></div></p></div></p><figure id="8c211738-32dd-4cfa-866c-7d43609c988b" class="image"><a href="MPI%2072068f7d370a4815972d9621a10519f0/Untitled%207.png"><img style="width:192px" src="MPI%2072068f7d370a4815972d9621a10519f0/Untitled%207.png"/></a></figure><p id="655eada9-fc34-4bf8-9ff5-4bdf193394ce" class=""><div class="indented"><p id="df2e70f3-3fd0-45b8-85e9-c3bb0b411f21" class=""><mark class="highlight-teal">C) Immediate operations </mark><mark class="highlight-teal"><code>MPI_Isend</code></mark><mark class="highlight-teal">, </mark><mark class="highlight-teal"><code>MPI_Irecv</code></mark><mark class="highlight-teal"> (nonblocking operations)</mark><div class="indented"><p id="a29994b7-4d26-4168-82ee-f1b9762a3498" class="">Immediate, non-blocking, local completion.<div class="indented"><p id="d008b3de-a71f-4f79-8575-504169f770e6" class="">Returns immediately (but initiates operation).</p><p id="c22daf4b-395f-4cba-a638-83189f0d5175" class="">Can be used to prevent deadlocks and improve performance (overlapping communication with computation).</p></div></p><p id="f20a48be-9543-4a54-a07a-efb93da53f50" class=""><em>Sending</em><div class="indented"><pre id="e757c867-a4d9-4623-9d6d-ecb3a6f89c96" class="code"><code>MPI_Isend(sendbuf,…,rank,tag,comm,request);</code></pre><p id="64007182-681a-43a5-9d8c-f4f6d20659dc" class=""><mark class="highlight-gray"><code>sendbuf</code></mark> can not be reused until completion has been checked.</p><ul id="9e86ae8b-2c5a-4f78-9112-28ae72648122" class="toggle"><li><details open=""><summary>In depth</summary><pre id="5b76e0d5-12a0-44a3-925f-e55c651b0b39" class="code"><code>MPI_Status status;
MPI_Request request;
MPI_Isend(sendbuf,…,comm,&amp;request);

// check progress information
MPI_Test(&amp;request,flag,&amp;status);</code></pre><p id="da4a0d17-57df-4db6-8167-df3d38eee8d5" class="">If <mark class="highlight-gray"><code>flag == 1</code></mark><mark class="highlight-gray"> </mark>then operation has completed.</p><p id="35ee2341-f304-4d36-9f10-eccbc1c5522c" class="">
</p><pre id="62711180-38a5-4b0d-aa5a-b26b2947e13a" class="code"><code>MPI_Isend(sendbuf,…,comm,&amp;request);
MPI_Wait(&amp;request,&amp;status);</code></pre><p id="e98d393a-4370-49a2-8c0d-6cdae21dbd05" class="">Is equivalent to <mark class="highlight-gray"><code>MPI_Send();</code></mark></p><p id="3e5d8456-ded5-4283-92e2-45fcf5859e5c" class="">
</p></details></li></ul></div></p><p id="9fe512b2-cb4f-4a04-9731-f895a9866581" class=""><em>Receiving</em><div class="indented"><pre id="2db5258e-5c94-462e-8131-ce51c370e974" class="code"><code>MPI_Irecv(recvbuf,…,rank,tag,comm,request);</code></pre><p id="3a47039b-3a27-421b-956f-986b24662af9" class="">Messages are received after completion.</p></div></p><hr id="25feaf93-6597-4410-88a5-1f381e75293c"/><ul id="00f9d96c-01bf-4259-8660-b315b77cda80" class="toggle"><li><details open=""><summary>Example: 2d, 5-point stencil algorithm (safe)</summary><figure id="17afb45b-388d-407f-9e43-5a31894d9bd3" class="image"><a href="MPI%2072068f7d370a4815972d9621a10519f0/Untitled%208.png"><img style="width:288px" src="MPI%2072068f7d370a4815972d9621a10519f0/Untitled%208.png"/></a></figure></details></li></ul></div></p></div></p><p id="130f8434-7d51-4209-985b-df7ef6053cd3" class="">
</p><p id="2f56ba28-67b8-4cd9-916f-472160efe1c6" class=""><mark class="highlight-blue">Test and completion calls</mark><div class="indented"><pre id="f4582366-b747-4d3c-a01f-b7a103faaa30" class="code"><code>MPI_Test(&amp;request,flag,&amp;status); // update status in flag (boolean)
MPI_Wait(&amp;request,&amp;status); // completion non-local

MPI_Waitall(number,array_of_requests,array_of_statuses)
MPI_Testall

MPI_Waitany
MPI_Testany

MPI_Waitsome
MPI_Testsome</code></pre></div></p><p id="7ade2ec6-e3a8-4c01-a9f0-6957c162ad08" class="">
</p><p id="2b801106-c821-424f-89b0-510f320c5bf7" class="">
</p><h1 id="737e5c78-dc4d-4cc2-86ed-5a8ef9d20578" class="">Datatypes</h1><pre id="666fea4c-4be2-4e8e-8ddf-f8b17e66ca35" class="code"><code>basetype *sendbuf;
sendbuf = malloc(count*extent*sizeof(basetype));
MPI_Send(sendbuf,count,datatype,dest,tag,comm);</code></pre><p id="f08f0ea5-c9ae-4af8-9b2c-8bf81afd284a" class="">Goal: Not communicating elements one after the other with multiple small messages but loading data into large consecutive buffer.</p><p id="4431d029-e361-44b9-b321-a37f4e381120" class="">
</p><p id="678509f6-c155-40ee-b6f2-d343216a0ac1" class=""><mark class="highlight-blue">Datatypes</mark><div class="indented"><p id="fb54a130-2b2c-43f4-b031-12bebb31ed59" class="">Describe unit of communication.<div class="indented"><p id="ecdb2273-68db-4cb4-bd55-2f2b75db5cdb" class="">They have a size, extent (footprint), internal structure and order.</p><p id="fb0f47c9-93f5-4a58-9138-c63d7ac610ba" class="">New types can also be derived.</p></div></p><pre id="06fe9854-eca5-4421-8f46-13e3de6f519f" class="code"><code>MPI_Type_get_extent(datatype,&amp;lb,&amp;extent); // difference between first and last byte
MPI_Type_size(datatype,&amp;bytes); // number of bytes occupied</code></pre><pre id="076569dc-9b7c-407d-bbfc-d7d8fe5480aa" class="code"><code>MPI_Type_contiguous(count,basetype,&amp;newtype);
MPI_Type_vector(count,blocksize,stride,basetype,&amp;newtype);
MPI_Type_create_indexed_block(count,block,displs,basetype,&amp;newtype);
MPI_Type_indexed(count,blocks,displs,basetype,&amp;newtype);
MPI_Type_create_struct(count,blocks,displs,etypes,&amp;newtype); // complicated
...

MPI_Type_commit(&amp;newtype); // sets newtype as new datatype</code></pre></div></p><figure id="a5a59d64-2546-414f-827f-98b2bf23f8a8" class="image"><a href="MPI%2072068f7d370a4815972d9621a10519f0/Untitled%209.png"><img style="width:240px" src="MPI%2072068f7d370a4815972d9621a10519f0/Untitled%209.png"/></a></figure><p id="60ba3ab6-197b-4841-a168-9dcd133de182" class="">
</p><p id="3a27a32c-0301-449f-b360-684cc8e32e3b" class="">
</p><h1 id="5acadf24-b55d-4a98-b6c9-d1459f6cb662" class="">One-sided communication</h1><p id="efe74c2b-5986-4ec6-ae85-30c67260b56c" class=""><mark class="highlight-blue">One-sided communication</mark><div class="indented"><p id="6e3adc1b-3ad8-417c-914b-2e3bdb72e62c" class="">Only one process is explicitly involved.</p></div></p><figure id="2159c1dc-a904-4e3c-98a2-84693ae63c9c" class="image"><a href="MPI%2072068f7d370a4815972d9621a10519f0/Untitled%2010.png"><img style="width:132px" src="MPI%2072068f7d370a4815972d9621a10519f0/Untitled%2010.png"/></a></figure><p id="a92016cb-28e4-437c-b009-b1a0caeb7fe4" class=""><mark class="highlight-blue">General properties</mark><div class="indented"><p id="1fc7d78f-631e-4ffc-a853-8824c3556fe8" class="">non-blocking, local-completion</p><p id="d60503dc-5a63-492c-940f-4f74cb18ae10" class="">data on target is exposed in communication-window and is addressed with “relative displacement”.</p></div></p><p id="f190c40f-a229-49c1-9e65-e96c4a10e399" class="">
</p><h2 id="539c47b6-747a-4a59-ac88-365cdcfd97b0" class="">Window, Epoch model</h2><p id="cc1e9698-3789-4f1a-8bf6-aa04723e0092" class=""><mark class="highlight-blue">Communication window</mark><div class="indented"><p id="c7bb0247-4d6c-4086-b8a5-5efa55c242e1" class="">global objects, memory processes accessed in one-sided communication.</p><p id="e8de3d7d-5834-4418-8ed5-7c51b8630588" class="">The target address of origin and target must be different (to disallow race conditions).</p><pre id="23d8371b-45c5-4c97-8701-90aa5ade9b32" class="code"><code>MPI_Win_create(
	base, // given by communicator
	size,
	dispunit, // displacement unit
	info, // special (key,value) that can influence properties -&gt; set MPI_INFO_NULL
	comm, // communicator
	&amp;win // address of window
);</code></pre></div></p><figure id="92702267-3eda-4b69-b140-507160dfc58b" class="image"><a href="MPI%2072068f7d370a4815972d9621a10519f0/Untitled%2011.png"><img style="width:120px" src="MPI%2072068f7d370a4815972d9621a10519f0/Untitled%2011.png"/></a></figure><p id="1c55da1b-c72f-464b-96cf-add78412f63d" class="">
</p><p id="016f03d2-dfa4-474d-9b31-8bce768f7f35" class="">
</p><h2 id="9a99a997-820b-4a64-be3a-ddb1c4ab929d" class="">Origin, Target</h2><p id="368f20de-0de1-42f3-9e0a-555205eaa3ec" class=""><mark class="highlight-blue">Origin</mark><div class="indented"><p id="f797b57a-b61d-4a7e-8ea5-e6a0d2c8ce64" class="">Initiates communication, provides arguments (alone).</p><pre id="cebc40b5-9578-4ae1-8539-92fed0df03fe" class="code"><code>MPI_Put(
	obuf, // buffer
	ocount,
	otype,
	target,
	tdisp, // displacement = base + targetdispunit * targetdisp
	tcount,
	ttype,
	win
);</code></pre></div></p><p id="185d17d9-8a4d-4b70-b61e-d636c107b361" class=""><mark class="highlight-blue">Target</mark><div class="indented"><p id="1fbd0a74-831f-4ada-a903-fe05f913d539" class="">Not involved in communication.</p><pre id="bbcfc514-ed5e-40ed-bdcd-a9609df6266c" class="code"><code>MPI_Get(
	obuf,
	ocount,
	target,
	tdisp,
	tcount,
	ttype,
	win
);

MPI_Accumulate( // atomic operation, concurrency allowed
	obuf,ocount,
	otype,
	target,tdisp,tcount,ttype,
	op,
	win
);</code></pre></div></p><p id="056c4372-7008-4ba0-ab8a-369e02ee1336" class=""><mark class="highlight-blue">Examples</mark><div class="indented"><ul id="d3f07208-f106-490e-ac41-14b3ff31e362" class="toggle"><li><details open=""><summary>Example: Binary search</summary><pre id="cac8e630-0d19-4922-9522-a3371d8c2ccc" class="code"><code>l = -1; // lower boundary
u = n; // upper boundary

do {
	m = (l+u)/2; // half
	if (x&lt;A[m]) {
		u = m; // upper &lt;- half
	} else {
		l = m; // lower &lt;- half
	}
} while (l+1&lt;u);

i = l;</code></pre><p id="ea57665f-9bde-462c-b851-87eeb3b29fa5" class="">Value found in sorted array in <style>@import url('https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.13.2/katex.min.css')</style><span data-token-index="0" contenteditable="false" class="notion-text-equation-token" style="user-select:all;-webkit-user-select:all;-moz-user-select:all"><span></span><span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mstyle mathsize="0.9em"><mi>O</mi><mo stretchy="false">(</mo><msub><mrow><mi>log</mi><mo>⁡</mo></mrow><mn>2</mn></msub><mi>n</mi><mo stretchy="false">)</mo></mstyle></mrow><annotation encoding="application/x-tex">\small O( \log_2 n)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.909996em;vertical-align:-0.23499599999999998em;"></span><span class="mord mathnormal sizing reset-size6 size5" style="margin-right:0.02778em;">O</span><span class="mopen sizing reset-size6 size5">(</span><span class="mop sizing reset-size6 size5"><span class="mop">lo<span style="margin-right:0.01389em;">g</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.16852em;"><span style="top:-2.3388933333333335em;margin-right:0.05555555555555556em;"><span class="pstrut" style="height:2.6em;"></span><span class="sizing reset-size5 size2 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.26110666666666665em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathnormal sizing reset-size6 size5">n</span><span class="mclose sizing reset-size6 size5">)</span></span></span></span></span><span>﻿</span></span> steps.</p><p id="f2425dbb-0be6-45f2-af00-f56837b9d8f1" class=""><em><mark class="highlight-gray">Note: binary search can’t be sped up significantly by parallel processing.</mark></em></p><p id="f57723a3-06a1-4784-8c66-0b314c7ca920" class="">
</p><p id="91e6c29c-f240-4028-8a0e-d8a32fa32107" class="">Each process gets a block of size <style>@import url('https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.13.2/katex.min.css')</style><span data-token-index="0" contenteditable="false" class="notion-text-equation-token" style="user-select:all;-webkit-user-select:all;-moz-user-select:all"><span></span><span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mstyle mathsize="0.9em"><mi>n</mi><mi mathvariant="normal">/</mi><mi>p</mi></mstyle></mrow><annotation encoding="application/x-tex">\small n/p</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.9em;vertical-align:-0.225em;"></span><span class="mord mathnormal sizing reset-size6 size5">n</span><span class="mord sizing reset-size6 size5">/</span><span class="mord mathnormal sizing reset-size6 size5">p</span></span></span></span></span><span>﻿</span></span> in <style>@import url('https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.13.2/katex.min.css')</style><span data-token-index="0" contenteditable="false" class="notion-text-equation-token" style="user-select:all;-webkit-user-select:all;-moz-user-select:all"><span></span><span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mstyle mathsize="0.9em"><mi>A</mi></mstyle></mrow><annotation encoding="application/x-tex">\small A</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.614997em;vertical-align:0em;"></span><span class="mord mathnormal sizing reset-size6 size5">A</span></span></span></span></span><span>﻿</span></span>.<div class="indented"><p id="bf4cf4a1-d46c-479f-83be-51aab88dca60" class="">All processes make their block accessible to others in communication window </p></div></p><pre id="2cf0b455-95db-4516-81ad-e5eacc5bf7bd" class="code"><code>int p;
int r; // rank
MPI_Comm_size(comm,&amp;p);
MPI_Comm_rank(comm,&amp;r);

// create window for other processes
A = (int*)malloc(n/p*sizeof(int));
… // init block (see later)
MPI_Win_create(A,(n/p)*sizeof(int),sizeof(int),MPI_INFO_NULL,comm,&amp;win);



l = -1; // lower boundary
u = n; // upper boundary
mA; // equivalent of A[m] in this process&#x27; block

do {
	m = (l+u)/2; // half

	MPI_Win_fence(MPI_NO_PRECEDE,win);
	t = m/p; // target process
	tix = m%p; // index at target
	MPI_Get(&amp;mA,1,MPI_INT,t,tix,1,MPI_INT,win);
	MPI_Win_fence(MPI_NO_SUCCEED,win);

	if (x&lt;mA) {
		u = m; // upper &lt;- half
	} else {
		l = m; // lower &lt;- half
	}
} while (l+1&lt;u);

i = l;</code></pre><p id="0f0cfe48-6ac0-4ba6-9874-a70cec1a2cc4" class="">Alternatively, instead of fences one could use:</p><pre id="5a0d6d8b-aa8d-46d9-8314-9322d3212a56" class="code"><code>MPI_Win_lock(MPI_LOCK_SHARED,t,0,win);
tix = m%p; // index at target
MPI_Get(&amp;mA,1,MPI_INT,t,tix,1,MPI_INT,win);
MPI_Win_unlock(t,win);</code></pre><p id="cb5f07c8-2653-45a7-8bf3-22f305362853" class="">
</p></details></li></ul><ul id="abd79fd8-9e9d-4e56-9877-ae9e53063e32" class="toggle"><li><details open=""><summary>Example: Merge</summary><p id="5ee7f230-93bf-4ef1-b563-e057643c7c87" class=""><mark class="highlight-gray"><code>merge(A,n,B,m,C)</code></mark></p><p id="16a0908d-5fc7-4d0b-9aa1-69fcd2e8e92e" class="">Sorted arrays distributed in evenly sized blocks <style>@import url('https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.13.2/katex.min.css')</style><span data-token-index="0" contenteditable="false" class="notion-text-equation-token" style="user-select:all;-webkit-user-select:all;-moz-user-select:all"><span></span><span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mstyle mathsize="0.9em"><mi>n</mi><mi mathvariant="normal">/</mi><mi>p</mi></mstyle></mrow><annotation encoding="application/x-tex">\small n/p</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.9em;vertical-align:-0.225em;"></span><span class="mord mathnormal sizing reset-size6 size5">n</span><span class="mord sizing reset-size6 size5">/</span><span class="mord mathnormal sizing reset-size6 size5">p</span></span></span></span></span><span>﻿</span></span>.<div class="indented"><p id="7706e962-1d09-480c-a653-afddfa55c11a" class="">Elements in process <style>@import url('https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.13.2/katex.min.css')</style><span data-token-index="0" contenteditable="false" class="notion-text-equation-token" style="user-select:all;-webkit-user-select:all;-moz-user-select:all"><span></span><span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mstyle mathsize="0.9em"><mi>r</mi></mstyle></mrow><annotation encoding="application/x-tex">\small r</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.387504em;vertical-align:0em;"></span><span class="mord mathnormal sizing reset-size6 size5" style="margin-right:0.02778em;">r</span></span></span></span></span><span>﻿</span></span> are <style>@import url('https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.13.2/katex.min.css')</style><span data-token-index="0" contenteditable="false" class="notion-text-equation-token" style="user-select:all;-webkit-user-select:all;-moz-user-select:all"><span></span><span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mstyle mathsize="0.9em"><mo>≤</mo></mstyle></mrow><annotation encoding="application/x-tex">\small \leq</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6947460000000001em;vertical-align:-0.12237300000000001em;"></span><span class="mrel sizing reset-size6 size5">≤</span></span></span></span></span><span>﻿</span></span> than process <style>@import url('https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.13.2/katex.min.css')</style><span data-token-index="0" contenteditable="false" class="notion-text-equation-token" style="user-select:all;-webkit-user-select:all;-moz-user-select:all"><span></span><span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mstyle mathsize="0.9em"><mi>r</mi><mo>+</mo><mn>1</mn></mstyle></mrow><annotation encoding="application/x-tex">\small r+1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.599994em;vertical-align:-0.07499700000000001em;"></span><span class="mord mathnormal sizing reset-size6 size5" style="margin-right:0.02778em;">r</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin sizing reset-size6 size5">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.5799960000000001em;vertical-align:0em;"></span><span class="mord sizing reset-size6 size5">1</span></span></span></span></span><span>﻿</span></span>.</p><p id="71dc7ed7-f79c-4fcf-a2c5-d97662b2c73f" class="">Each process stores a block of <mark class="highlight-gray"><code>C</code></mark><mark class="highlight-gray"> </mark>of size <style>@import url('https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.13.2/katex.min.css')</style><span data-token-index="0" contenteditable="false" class="notion-text-equation-token" style="user-select:all;-webkit-user-select:all;-moz-user-select:all"><span></span><span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mstyle mathsize="0.9em"><mo stretchy="false">(</mo><mi>n</mi><mo>+</mo><mi>m</mi><mo stretchy="false">)</mo><mi mathvariant="normal">/</mi><mn>2</mn></mstyle></mrow><annotation encoding="application/x-tex">\small (n+m)/2</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.9em;vertical-align:-0.225em;"></span><span class="mopen sizing reset-size6 size5">(</span><span class="mord mathnormal sizing reset-size6 size5">n</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin sizing reset-size6 size5">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.9em;vertical-align:-0.225em;"></span><span class="mord mathnormal sizing reset-size6 size5">m</span><span class="mclose sizing reset-size6 size5">)</span><span class="mord sizing reset-size6 size5">/2</span></span></span></span></span><span>﻿</span></span>.</p><p id="0d6943fe-ec19-4de8-90d7-e53d28c48a56" class="">
</p></div></p><p id="ace923a9-a977-42d7-9519-1b100f8e9d58" class=""><em>Algorithm:</em></p><ol type="1" id="1c0259b3-0215-4de4-a882-61fa1542f085" class="numbered-list" start="1"><li>Use co-ranking algorithm.<p id="f91e070f-aaa6-4b10-9e46-87b93f6d8e09" class="">All <style>@import url('https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.13.2/katex.min.css')</style><span data-token-index="0" contenteditable="false" class="notion-text-equation-token" style="user-select:all;-webkit-user-select:all;-moz-user-select:all"><span></span><span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mstyle mathsize="0.9em"><mi>p</mi></mstyle></mrow><annotation encoding="application/x-tex">\small p</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.5625em;vertical-align:-0.174996em;"></span><span class="mord mathnormal sizing reset-size6 size5">p</span></span></span></span></span><span>﻿</span></span> processes co-rank in parallel.</p><figure id="bab52e35-ff2d-4dd9-a88f-6b81a15e270f" class="image"><a href="MPI%2072068f7d370a4815972d9621a10519f0/Untitled%2012.png"><img style="width:192px" src="MPI%2072068f7d370a4815972d9621a10519f0/Untitled%2012.png"/></a></figure></li></ol><ol type="1" id="1d6c3493-db88-47f1-930f-e09bb8509936" class="numbered-list" start="2"><li>Copy partial blocks into intermediate <mark class="highlight-gray"><code>C’</code></mark> array.<p id="fb5ca8cc-e877-4bd7-bb32-72f45a0e6f03" class="">One-sided communication (partial block can read elements from other processes).</p><figure id="707519cc-6c62-448e-88fc-85ce77205138" class="image"><a href="MPI%2072068f7d370a4815972d9621a10519f0/Untitled%2013.png"><img style="width:192px" src="MPI%2072068f7d370a4815972d9621a10519f0/Untitled%2013.png"/></a></figure></li></ol><ol type="1" id="82591141-2dbd-40de-96f4-308d5336517a" class="numbered-list" start="3"><li>Local sequential merge of <mark class="highlight-gray"><code>C&#x27;</code></mark> array into <code><mark class="highlight-gray">C</mark></code><mark class="highlight-gray"> </mark>block. </li></ol><p id="21355e74-efaf-40e5-8547-710643762fee" class="">
</p></details></li></ul></div></p><p id="df3162eb-dd3c-4e3c-aea5-2af9160f5cc0" class="">
</p><h2 id="20d7fa1d-4903-46d2-84c3-97628c63459d" class="">Epoch model, synchronization</h2><p id="4575c8d7-ee4a-45ac-b552-19eac6bfa002" class=""><mark class="highlight-blue">Epoch model</mark><div class="indented"><p id="81dfd7a2-292f-40bb-90e0-3d10a8f91cfa" class="">Access epoch<mark class="highlight-gray">		</mark>Origin has access to target</p><p id="e535f164-16a2-4293-aa72-4860ecf9cc95" class="">Exposure epoch	Target must expose memory</p><hr id="587998e3-8213-4b6b-9feb-74295e2563a6"/><p id="ad154c3c-24af-429d-92cb-9f4b5dfc0cd0" class="">Open epoch		start of access or exposure</p><p id="bee51bce-cd72-486e-96c9-5609b0691c4c" class="">Close epoch		synchronization, communication operations become visible</p><p id="8073278a-8e2b-466a-8ee9-60f947a11d66" class="">End of epoch		Access and exposure completed (data arrived at target)</p></div></p><p id="36988df9-5861-45cc-bb2b-6e6e7a8d98e4" class="">
</p><p id="88be5405-892c-4dd4-bc64-fbea75824d32" class=""><mark class="highlight-blue">Synchronization in epochs</mark><div class="indented"><p id="d7b6d09c-d2d0-48a2-abe7-6620257a2cd4" class=""><mark class="highlight-teal">Active (global) synchronization</mark><div class="indented"><p id="9d7d8db5-1d96-4537-92ea-3e7a69d8b07f" class="">Active global synchronization (involves origin and target).<div class="indented"><p id="451e58f9-b9bc-410c-b40d-ede023e326a2" class="">Closes previous epoch, opens a new one.</p></div></p><p id="e3715e59-dc09-48d3-bc45-6e16d9f908b9" class="">Collective operation, called by all processes in comm of win.</p><pre id="03178429-f8c7-466f-ad92-7826251abcd6" class="code"><code>MPI_Win_fence(assert,win);</code></pre><ul id="5c60d9c8-6967-47ef-8269-3f2d5d601dbe" class="toggle"><li><details open=""><summary>Example</summary><figure id="338d4567-97b9-403b-8509-66cebded6bc4" class="image"><a href="MPI%2072068f7d370a4815972d9621a10519f0/Untitled%2014.png"><img style="width:240px" src="MPI%2072068f7d370a4815972d9621a10519f0/Untitled%2014.png"/></a></figure><p id="81329e44-a8ef-4645-9eee-aa4007c119b7" class="">
</p></details></li></ul></div></p><p id="1e94cb6f-1351-49a1-a553-aac860bc5d6a" class=""><mark class="highlight-teal">Active (dedicated) synchronization</mark><div class="indented"><p id="cf85a2ad-b675-4f55-b4ef-05656386f8c7" class="">Active global synchronization (involves origin and target).</p><p id="5bd72f7c-a848-44d4-a8e0-fe453ca35437" class="">Pairwise synchronization.</p><pre id="5f5f2ce1-7b4d-48c2-96a9-705152733599" class="code"><code>// open/close access epoch (targets)
MPI_Win_start(…,group);
MPI_Win_complete();

// open/close exposure epoch (origin)
MPI_Win_post(…,group);
MPI_Win_wait();</code></pre><ul id="fa17fdb5-065b-4768-af3b-b8e982556801" class="toggle"><li><details open=""><summary>Example</summary><figure id="b62495e4-e662-4e76-aa8b-3e5026d097d3" class="image"><a href="MPI%2072068f7d370a4815972d9621a10519f0/Untitled%2015.png"><img style="width:288px" src="MPI%2072068f7d370a4815972d9621a10519f0/Untitled%2015.png"/></a></figure><p id="b4d846ec-18a7-4725-8df2-342057537db6" class="">
</p></details></li></ul></div></p><p id="dbfb0834-29ad-4743-9d54-6650f3cb0528" class=""><mark class="highlight-teal">Passive synchronization</mark><div class="indented"><p id="ececd9f5-d2ac-4656-9f42-6d554af320c4" class="">Only origin process involved.</p><p id="2507be77-622e-4022-8aa6-ac9c66d4f2a3" class="">Not a lock (critical section)<div class="indented"><p id="f6b25f88-393b-442b-9c70-b1f8b901e05e" class="">difficult to use for mutual exclusion, weak mechanism</p></div></p><pre id="19a2ecb6-cb3e-4884-a075-6f8e3f0c9764" class="code"><code>// open/close exposure epoch (origin)
MPI_Win_lock(locktype,target,assertion,win);
MPI_Win_unlock(target,win);</code></pre></div></p></div></p><p id="761ef07e-d1b2-461f-ab95-ada17629efb5" class="">
</p><p id="895f1e69-4f4c-4b38-9f3e-79b7d425dbb2" class="">
</p><h1 id="c7a60ca7-aa60-454f-b939-47277e95e925" class="">Collective communication</h1><figure class="block-color-gray_background callout" style="white-space:pre-wrap;display:flex" id="3e58569b-48a9-4e00-b7f1-375e23e6696f"><div style="font-size:1.5em"><span class="icon">💡</span></div><div style="width:100%">Collectives should be used whenever possible! (better conciseness, performance)</div></figure><p id="c9234dfd-00b4-4d26-8d05-30e68b64b586" class="">
</p><p id="faa8ad3e-d150-46eb-9365-753d04b26c5f" class=""><mark class="highlight-blue">Collective communication</mark><div class="indented"><p id="7ab3e9f4-0c27-4691-b5a4-2d51e2b5a9b8" class="">Collective operations = all processes in <em>comm </em>must call given function (all are explicitly involved and must call the same collective communication operation).</p><p id="6df023f7-9b1b-4ea0-8f48-2a1e482542ee" class="">Requirements: If a process calls collective operation on <em>comm</em> then all other included processes <span style="border-bottom:0.05em solid">must also call the same operation</span> and<div class="indented"><ul id="62f1caa0-9310-4612-8a91-71e5def0f75f" class="bulleted-list"><li style="list-style-type:disc">no other collective in between</li></ul><ul id="b7392844-5ffb-4434-8a0b-397e4a88e372" class="bulleted-list"><li style="list-style-type:disc">same root (else it deadlocks)</li></ul><ul id="662df697-d876-4bcc-a1e8-10c0a3e49b6a" class="bulleted-list"><li style="list-style-type:disc">consistent arguments (same size and types)</li></ul></div></p></div></p><figure id="5dd32e9f-e4a0-4d2f-ac4f-d29973a4093d" class="image"><a href="MPI%2072068f7d370a4815972d9621a10519f0/Untitled%2016.png"><img style="width:144px" src="MPI%2072068f7d370a4815972d9621a10519f0/Untitled%2016.png"/></a></figure><p id="eaaaaeec-5898-4fec-b5b1-37439f38f891" class="">
</p><p id="36e0ea3d-133c-42f5-955f-9acf08112318" class=""><mark class="highlight-blue">General properties</mark><div class="indented"><p id="c7cae67b-a7ab-4c2c-a444-c84c62d992ff" class="">Collective operations are:<div class="indented"><ul id="0511ee1a-e2f9-4f33-84df-de363628b0a6" class="bulleted-list"><li style="list-style-type:disc">safe				won’t interfere with one another</li></ul><ul id="77cd23d8-4cc0-4e81-9424-9c367cd861a9" class="bulleted-list"><li style="list-style-type:disc">blocking			completion is non-local and must be fully completed to return</li></ul><ul id="8a5806a3-d229-4443-aeaa-8420c4d326ef" class="bulleted-list"><li style="list-style-type:disc">not synchronizing	any process can return independent of other processes<p id="13badb4c-3317-4289-90a8-a1335785b137" class=""><mark class="highlight-gray">				(except </mark><mark class="highlight-gray"><code>MPI_Barrier(&amp;com)</code></mark><mark class="highlight-gray">)</mark></p></li></ul></div></p><hr id="2814c62b-60a5-4af7-b61c-5281182c558f"/><ul id="10c796e8-fe2f-4b08-9d34-1d28823ae19a" class="toggle"><li><details open=""><summary>Example: <mark class="highlight-gray"><code>MPI_Bcast</code></mark></summary><p id="565730af-be2f-4cbc-af31-7dc0591817ec" class=""><mark class="highlight-gray"><code>Bcast</code></mark><mark class="highlight-gray"> sends data from root → all.</mark> </p><ul id="355c7830-a026-455a-9987-9924edf912f2" class="bulleted-list"><li style="list-style-type:disc">blocking<p id="4af84627-0684-48d4-a132-5b3823dcb87c" class="">root: doesn’t return untill data has left buffer</p><p id="301d3ee9-5b54-41c4-a8da-ebfdf23edfa0" class="">non-root: doesn’t return until data has been received in buffer</p></li></ul><ul id="337e3da9-9376-4b00-803a-5af514352d25" class="bulleted-list"><li style="list-style-type:disc">not synchronizing<p id="c3a2f05c-1183-4378-a0f6-c5d6944e3c45" class="">any process can return independent of other processes</p><p id="77f3f8d8-c861-4128-be8d-b52cf3b5192d" class="">
</p></li></ul></details></li></ul><ul id="926db678-1cd0-47f9-be16-336fb12c3bb3" class="toggle"><li><details open=""><summary>Example: Safe vs. Unsafe</summary><figure id="af615dba-fff5-4287-a8a1-ae76ee9d8c9b" class="image"><a href="MPI%2072068f7d370a4815972d9621a10519f0/Untitled%2017.png"><img style="width:288px" src="MPI%2072068f7d370a4815972d9621a10519f0/Untitled%2017.png"/></a></figure><figure id="e7d50026-ac51-47b2-9994-ba4ded7159ed" class="image"><a href="MPI%2072068f7d370a4815972d9621a10519f0/Untitled%2018.png"><img style="width:288px" src="MPI%2072068f7d370a4815972d9621a10519f0/Untitled%2018.png"/></a></figure><figure id="1205840f-528a-427a-8872-8953d9d25a0c" class="image"><a href="MPI%2072068f7d370a4815972d9621a10519f0/Untitled%2019.png"><img style="width:288px" src="MPI%2072068f7d370a4815972d9621a10519f0/Untitled%2019.png"/></a><figcaption>look at <mark class="highlight-gray"><code>comm1</code></mark><mark class="highlight-gray"> </mark>/ <mark class="highlight-gray"><code>comm2</code></mark><mark class="highlight-gray"> </mark>argument</figcaption></figure><figure id="e7f39afe-dbda-4b12-a2ca-41514a729ec5" class="image"><a href="MPI%2072068f7d370a4815972d9621a10519f0/Untitled%2020.png"><img style="width:288px" src="MPI%2072068f7d370a4815972d9621a10519f0/Untitled%2020.png"/></a><figcaption>look at <mark class="highlight-gray"><code>comm1</code></mark><mark class="highlight-gray"> </mark>/ <mark class="highlight-gray"><code>comm2</code></mark><mark class="highlight-gray"> </mark>argument</figcaption></figure><figure id="8ada32e1-3423-4738-b073-8c8e08899a5e" class="image"><a href="MPI%2072068f7d370a4815972d9621a10519f0/Untitled%2021.png"><img style="width:288px" src="MPI%2072068f7d370a4815972d9621a10519f0/Untitled%2021.png"/></a></figure><p id="ff10323d-4f01-4759-92e2-0cd72ce20fb6" class="">
</p></details></li></ul></div></p><p id="abdbbd33-420c-4032-b6e0-2f8c524f17a8" class="">
</p><p id="4aef1721-bdc0-43c1-ab00-1013753c7c6e" class=""><mark class="highlight-blue">Symmetric vs. Non-symmetric</mark><div class="indented"><p id="9bf720c7-2527-4dee-bb8f-e10b25040042" class="">Symmetric = All processes have the same role</p><p id="f024622b-de5e-4730-b55e-80d6482077b4" class="">Non-symmetric = Some process (ie. root) is special</p></div></p><p id="176c67db-d2c5-4e55-b142-7eb3ba2e9942" class="">
</p><p id="e7e1b643-d176-4d63-a48d-c168070129a6" class=""><mark class="highlight-blue">Regular vs. irregular</mark><div class="indented"><p id="2040fda4-10fe-45f4-b32d-4f41cc438936" class="">Regular = All processes exchange (send/receive) the same amount of data (segments with the same size and data type)</p><p id="62abd059-01ca-4bba-9182-a6db53a4a80e" class="">Irregular, vector, v-collective = Some pairs exchange (send/receive) different amounts of data (different data-types: different sizes, displacements relative to start address).<div class="indented"><p id="6be7935a-007a-4716-bc4b-cf4506209c3c" class="">Examples: <mark class="highlight-gray"><code>MPI_Gatherv</code></mark>, <mark class="highlight-gray"><code>MPI_Scatterv</code></mark>, <mark class="highlight-gray"><code>MPI_Allgatherv</code></mark>, <mark class="highlight-gray"><code>MPI_Alltoallv</code></mark>, <mark class="highlight-gray"><code>MPI_Alltoallw</code></mark></p></div></p></div></p><p id="cc376de3-a631-4fb2-87f4-3260b2bb91af" class="">
</p><p id="1bf2ed33-4b62-4294-b408-022d53440774" class=""><mark class="highlight-blue">Differences with point-to-point communication</mark><div class="indented"><ul id="28abf24e-e2ea-4c43-93b3-19e703f779a9" class="bulleted-list"><li style="list-style-type:disc">No <mark class="highlight-gray"><code>tag</code></mark><mark class="highlight-gray"> </mark>argument</li></ul><ul id="e02ec019-cc9c-4f2e-b295-4ecef640f0d7" class="bulleted-list"><li style="list-style-type:disc">Amount of data for sender and receiver must be equal</li></ul><ul id="2d9fbcae-1fd9-47dd-8f17-7bd3d69299a7" class="bulleted-list"><li style="list-style-type:disc">Buffers of size 0 don’t have to be sent<ul id="e53d129f-a2f2-4b02-927a-bb59a098a289" class="toggle"><li><details open=""><summary>Example: Implementing <mark class="highlight-gray"><code>no-op</code></mark><mark class="highlight-gray"> </mark>with collective operations</summary><p id="1a8d59eb-f5c1-45f5-b8ee-9de2c76790cb" class="">“Nothing broadcast”</p><pre id="4f39313e-b648-4aad-9652-689bb607539f" class="code"><code>MPI_Bcast(buffer,0,MPI_CHAR,…,root,comm);</code></pre><pre id="9431c5c0-8b0f-45df-95d0-939825347329" class="code"><code>MPI_Bcast(buffer,0,MPI_CHAR,…,root,comm);</code></pre></details></li></ul><ul id="5fcedd44-c6df-4e60-a026-7e502d714467" class="toggle"><li><details open=""><summary>Example: Implementing <mark class="highlight-gray"><code>no-op</code></mark><mark class="highlight-gray"> </mark>with <mark class="highlight-gray"><code>Send</code></mark> and <mark class="highlight-gray"><code>Recv</code></mark></summary><pre id="f99fa927-691f-4a96-9b40-12e8152b8756" class="code"><code>MPI_Send(buffer,0,MPI_CHAR,j,TAG,comm);</code></pre><pre id="764419fe-af7c-4ab7-b898-baf4c77c7150" class="code"><code>MPI_Recv(buffer,10,MPI_CHAR,j,TAG,comm,&amp;status); // size can be larger</code></pre></details></li></ul></li></ul></div></p><p id="d93e9bbc-9bfa-40ff-a138-c0783aaca647" class="">
</p><h2 id="74f1ca93-47c4-463a-8dc5-2f08ac1d84c6" class="">Overview</h2><p id="02979ada-7113-4a79-ba29-e1cd58b80dbb" class=""><mark class="highlight-blue">Collective patterns, operations in MPI</mark><div class="indented"><p id="d5a4113a-e1ed-4e81-ac34-79b605d3f965" class=""><mark class="highlight-teal">Distributing data</mark><div class="indented"><p id="fa77c9ab-be44-45a7-9a9f-806d245e2bf5" class=""><mark class="highlight-gray"><code>MPI_Bcast</code></mark>: root → all<div class="indented"><p id="fd01e4a0-da53-466b-864b-11e990557148" class=""><mark class="highlight-gray"><code>MPI_Scatter</code></mark>: root → all (<em>personalized</em> data)</p><p id="7464c1f8-c3b7-408d-853a-e0d3cc711261" class=""><mark class="highlight-gray"><code>MPI_Gather</code></mark>: all → root </p></div></p><p id="24644141-d190-4772-8166-18ec55cae6f0" class=""><mark class="highlight-gray"><code>MPI_Alltoall</code></mark>: all → all, “transpose” (<em>personalized</em> data)</p><p id="0048964f-c79b-4b7d-8a66-1a3d7121cc23" class=""><mark class="highlight-gray"><code>MPI_Allgather</code></mark>: all → all, “transpose”</p></div></p><p id="9c7b42c4-7dfe-4a82-a56f-b831dae93401" class="">
</p><p id="d42e3695-5458-41b9-8aee-8aac0c76428f" class=""><mark class="highlight-teal">Applying associative function (ie. “+”) to data from each process </mark><div class="indented"><p id="98076505-13fc-4711-afb7-886413bb0948" class=""><mark class="highlight-gray"><code>MPI_Reduce</code></mark>: result at root</p><p id="e1987b5c-c92c-428a-8417-3a896c22ada1" class=""><mark class="highlight-gray"><code>MPI_Allreduce</code></mark>: result to all</p><p id="851b7283-46b2-4fbc-afdf-0c8c0c6e0572" class=""><mark class="highlight-gray"><code>MPI_Reduce_scatter</code></mark>: result scattered/distributed</p><p id="f1dd4882-bbe8-48e3-8d1f-5d5e7a79f89b" class=""><mark class="highlight-gray"><code>MPI_Scan</code></mark>: prefix-sums</p></div></p><p id="59b023a7-07fc-40db-b17a-7ffcdf6d195c" class="">
</p><p id="4a99eced-686e-4ea1-9d13-2990c70537f0" class=""><mark class="highlight-teal">Synchronization</mark><div class="indented"><p id="95cc94fe-e9ef-4474-a5cb-cd4632dfbf18" class=""><mark class="highlight-gray"><code>MPI_Barrier</code></mark>: (semantic) Synchronization</p></div></p></div></p><p id="89afd038-b331-4449-8ee7-528a8da5ea52" class="">
</p><figure id="1db54e53-16b5-442f-8625-e7293dc950fe" class="image"><a href="MPI%2072068f7d370a4815972d9621a10519f0/Untitled%2022.png"><img style="width:120px" src="MPI%2072068f7d370a4815972d9621a10519f0/Untitled%2022.png"/></a></figure><p id="f1fa7ad4-6a78-418b-b06f-255093be3ad2" class="">
</p><h2 id="d32c5f7b-f711-47c0-a753-71c905e690a9" class="">Operations</h2><p id="51efefc8-1847-4cd0-8843-2038f2a5abce" class=""><mark class="highlight-blue">Duplicating communicators</mark><div class="indented"><p id="908941f6-d7d5-47cf-b2d3-85eb52c0cf39" class="">Duplicates communicator: Same processes, but also copied to different comms.</p><pre id="db07d49e-57bf-4464-b892-c28630de0785" class="code"><code>MPI_Comm_dup(comm, &amp;comm1);</code></pre><p id="1a16b8b1-dd2a-4b7d-92d7-b3eef4ca746c" class=""><mark class="highlight-gray"><code>comm</code></mark><mark class="highlight-gray"> </mark>can not interfere with <mark class="highlight-gray"><code>comm1</code></mark></p><hr id="04e2a7b4-3e9e-42b4-bb0f-ae015a795ed7"/><ul id="4b7de7bb-2127-457c-8b9b-e3b16068f63e" class="toggle"><li><details open=""><summary>Example: Usage in libraries</summary><p id="c719e00f-e3bc-47a7-8d07-b4428c8cb204" class="">Good practice when writing libraries: here the library uses <mark class="highlight-gray"><code>libcomm</code></mark><mark class="highlight-gray"> </mark>and there is no interference.</p><pre id="e89790dc-3ea0-4424-a208-7d0a53a72bc1" class="code"><code>int my_library_init(comm, &amp;libcomm) {
	MPI_Comm_dup(comm, &amp;libcomm); // store somewhere
	...
}</code></pre></details></li></ul></div></p><p id="aa26335e-b453-40be-9a1d-33184257d622" class="">
</p><p id="4053e89c-f9cd-4c3f-8b7f-53075e87cf82" class=""><mark class="highlight-blue">Splitting communicators</mark><div class="indented"><p id="f8a22e25-f6bb-4729-b70e-2cb2e9a43e60" class="">Partition processes into disjoint sets with independent comms.</p><pre id="ed6f1784-a82a-4278-a13d-4b4a273ebab0" class="code"><code>MPI_Comm_split(comm1,color,key,&amp;comm2);
MPI_Comm_create(comm1,group,&amp;comm2);</code></pre><p id="5540f8c8-a238-4426-a2ae-85a446bc68c6" class="">color	defines subset  in <mark class="highlight-gray"><code>comm2</code></mark></p><p id="75355270-327e-4a95-bf12-31fb0d179400" class="">key		defines relative order in <mark class="highlight-gray"><code>comm2</code></mark><mark class="highlight-gray"> (for each color)</mark></p><p id="4d20d7db-9dd5-49dc-8461-437c30d8861a" class="">group	<mark class="highlight-gray"><code>MPI_Group</code></mark><mark class="highlight-gray"> </mark>of ordered processes	</p><hr id="8344067b-ee4f-4b7b-85b4-443262e4ba69"/><ul id="53299cfc-ea71-4f77-82ea-8d0c6de82175" class="toggle"><li><details open=""><summary>Example: Even-odd split</summary><p id="1485cbe0-c6bd-49b3-8254-236ea170ce8d" class="">Used in divide and conquer algorithms.</p><pre id="206be8d0-24a0-4844-9bd0-581e711f04c0" class="code"><code>MPI_Comm_rank(comm1,&amp;rank); // get rank in comm1

int color = rank%2;
int key = 0;
MPI_Comm_split(comm1,color,key,&amp;comm2); // split by color

// find process&#x27; new rank in comm2
MPI_Comm_size(comm2,&amp;newsize);
MPI_Comm_rank(comm2,&amp;newrank);</code></pre><p id="5bc6993a-6874-4249-b3f1-9261a515f39a" class="">if rank even: <mark class="highlight-gray"><code>color == 0</code></mark><mark class="highlight-gray"> </mark>in<mark class="highlight-gray"> </mark><code><mark class="highlight-gray">comm2</mark></code></p><p id="76dc5727-2d60-4fb0-9a56-f763715b26dc" class="">if rank odd: <mark class="highlight-gray"><code>color == 1</code></mark><mark class="highlight-gray"> </mark>in<mark class="highlight-gray"> </mark><code><mark class="highlight-gray">comm2</mark></code></p><figure id="5c5b7d9b-ed3f-431f-b685-fa8e00b09019" class="image"><a href="MPI%2072068f7d370a4815972d9621a10519f0/Untitled%2023.png"><img style="width:192px" src="MPI%2072068f7d370a4815972d9621a10519f0/Untitled%2023.png"/></a></figure><p id="8f4d8fcd-314f-4381-be15-b11dcbc3ff15" class="">
</p></details></li></ul><ul id="9e1b8206-395e-4e1c-bce7-ea635985c66e" class="toggle"><li><details open=""><summary>Example: Master-worker pattern (non-scalable)</summary><p id="d015190a-21d4-4f3c-b8ed-b62f498c4bd3" class="">master	gives workers their work, receives result </p><p id="3bc09b9c-d6e2-4fab-b177-3e72e8e56f09" class="">worker	synchronize independently of master</p><hr id="141f38e1-771f-4f00-96e8-07b7e4b3d8fd"/><p id="723a352b-4ce0-42e1-90ea-b22f13935eb0" class="">If workers use <mark class="highlight-gray"><code>MPI_Barrier(comm)</code></mark>, <mark class="highlight-gray"><code>MPI_Allgather(comm)</code></mark> and master is doing something else it causes a deadlock. Therefore they have to use the split communicator (only for workers).</p><p id="5cfb9d10-ce16-4691-9d87-5a63037081d8" class="">
</p><p id="aee9bec9-dc65-428c-94c5-fbe4aeaf8a81" class="">A) Splitting<div class="indented"><pre id="759afec1-7908-48af-8498-b7cf4ced0d15" class="code"><code>int color = (rank&gt;0 ? 1 : 0);
int key = 0;
MPI_Comm_split(comm,color,key,&amp;workers);
// workers for rank&gt;0 in comm: all workers
// workers for rank==0 in comm: only master</code></pre><figure id="6cb6b7e9-34fd-429f-8751-43739ebc2e6e" class="image"><a href="MPI%2072068f7d370a4815972d9621a10519f0/Untitled%2024.png"><img style="width:240px" src="MPI%2072068f7d370a4815972d9621a10519f0/Untitled%2024.png"/></a></figure></div></p><p id="1b3b341a-0555-4679-92a0-b7783ea13a89" class="">
</p><p id="56bed6f4-6146-42e4-b8f5-41661dd6f603" class="">B) Processing groups<div class="indented"><pre id="844153a8-7adf-4fc3-a3f5-b142bfb3cd90" class="code"><code>MPI_Comm_group(comm,&amp;group); // get processes in comm

// exclude rank 0
ranklist[0] = 0;
MPI_Group_excl(group,1,ranklist,&amp;workgroup); // group operation

MPI_Comm_create(comm,workgroup,&amp;workers);
// rank 0 (in comm) not in workers
// workers==MPI_COMM_NULL for rank 0 in comm</code></pre><figure id="7ef5cafd-d539-463e-842f-2ca38752218e" class="image"><a href="MPI%2072068f7d370a4815972d9621a10519f0/Untitled%2025.png"><img style="width:240px" src="MPI%2072068f7d370a4815972d9621a10519f0/Untitled%2025.png"/></a></figure></div></p><p id="afc6b805-3adf-49d2-a166-940e625356a4" class="">
</p><p id="cea649da-0753-4e52-a44b-ef0c892ab7eb" class="">
</p></details></li></ul></div></p><p id="b3abcef8-3ac3-4999-a6cd-bbae3d734bc3" class="">
</p><p id="a9eba5ca-deca-4588-b06f-845ba614e462" class=""><mark class="highlight-blue">Barrier</mark><div class="indented"><p id="5f20e5ec-728c-4a1c-86c8-e402957d5f9e" class="">(Is the only <em>synchronizing</em> operator)</p><pre id="2bd5e5aa-d245-426d-9a0e-a328e0fc215d" class="code"><code>MPI_Barrier(comm);</code></pre><p id="4c3a29be-0c7a-455e-a68c-b07e099e1089" class="">Calling process waits for all other processes in <mark class="highlight-gray"><code>comm</code></mark><mark class="highlight-gray"> </mark>to enter barrier and can only return when they have done so.</p><p id="a99285cc-87ab-46c3-b7b9-b53fb7b7051d" class="">Explicit <mark class="highlight-gray"><code>MPI_Barrier</code></mark><mark class="highlight-gray"> </mark>calls should never be needed for correctness of MPI programs (there is always a way to program without them).</p><hr id="4fc03439-a593-41f6-8555-ec5e10d52f99"/><ul id="0fceb317-74c5-47a1-8736-8330dd972dc3" class="toggle"><li><details open=""><summary>Example: Timing a function</summary><pre id="df61aa2c-5447-4170-992c-a58db98d258c" class="code"><code>MPI_Barrier(comm); // processes hopefully now synchronized

double start = MPI_Wtime();
&lt;something to be timed&gt;
double stop = MPI_Wtime();

double local_time = stop-start;
double spent_time; // time for slowest process
MPI_Allreduce(&amp;local_time,&amp;spent_time,1,MPI_DOUBLE,MPI_MAX,comm);</code></pre></details></li></ul></div></p><p id="96c2b0fd-73fa-4738-bb65-d3987e93dc28" class="">
</p><p id="35d593c7-c240-40ff-a78a-55824d2d7b63" class=""><mark class="highlight-blue">Bcast</mark><div class="indented"><p id="7fa165fa-0230-4332-aee1-4761676282f9" class="">distributes data: root → all</p><pre id="60e95557-c8bd-48fc-8acd-dc65666bfa91" class="code"><code>MPI_Bcast(buffer,count,datatype,root,comm); // root stays the same for all</code></pre><p id="93aac8d7-b999-4725-93bc-2928e6fd347e" class="">Root sends data to all other non-root processes.</p><p id="08365f51-ae6b-4744-84f6-e5e7e17ab95c" class="">Any process can be the root.</p><hr id="42efef8f-0c45-4ca1-aa73-f32af3debe08"/><ul id="10816b9e-4105-4fa8-b5f5-8757904bebc8" class="toggle"><li><details open=""><summary>Example: Different sizes (unsafe)</summary><pre id="e3f5cd59-229b-465a-af7c-61ad0859bea1" class="code"><code>int matrixdims[3]; // 3 dimensional matrix

if (rank==0) {
	MPI_Bcast(matrixdims,3,MPI_INT,0,comm); // different sizes: 3
} else {
	MPI_Bcast(matrixdims,2,MPI_INT,0,comm); // different sizes: 2
}</code></pre><p id="949b1d51-75b7-4f01-b2a1-5f83676eef36" class="">The implementation above probably works, but it’s unsafe</p></details></li></ul></div></p><figure id="5f6c26d5-f469-4224-8afa-385becef59c5" class="image"><a href="MPI%2072068f7d370a4815972d9621a10519f0/Untitled%2026.png"><img style="width:192px" src="MPI%2072068f7d370a4815972d9621a10519f0/Untitled%2026.png"/></a></figure><p id="6d192c86-8efd-4db6-869d-495b33d6e492" class="">
</p><p id="4ba8a1a6-cb4c-4e7c-b75e-270237ecca89" class=""><mark class="highlight-blue">Gather</mark><div class="indented"><p id="d9a40524-850f-4a0e-98b7-3bc8a42a5433" class="">gathers data: all → root</p><pre id="d004094f-3ecf-4df9-9c6d-667fa473bab1" class="code"><code>MPI_Gather(
	sbuf,scount,stype, // sender
	rbuf,rcount,rtype, // receiver
	root,comm
);</code></pre><ul id="57838de5-3015-4c7b-bc39-b1ac849245d5" class="toggle"><li><details open=""><summary>Alternative</summary><p id="c796823a-17cf-4337-93e9-9713d04d1681" class="">The implementation is much more efficient.</p><pre id="e9eeda1c-890c-4aa3-a070-bce9880505e9" class="code"><code>// root
if (rank==root) {
	// receive from others
	for (…i!=root…) {
		MPI_Recv(rbuf+i*rcount*extent(rtype),rcount,rtype,i,GATTAG,comm,MPI_STATUS_IGNORE);
	}
	// send and receive from self
	MPI_Sendrecv(
		sbuf,…,root,…,
		rbuf+root*rcount*extent(rtype),…,root,…
	);

// others
} else {
	// send
	MPI_Send(sbuf,scount,stype,root,GATTAG,comm);
}</code></pre><p id="fa5174e4-4db7-47b8-9499-4ebd2dcb67fc" class="">
</p></details></li></ul><p id="a98b57ab-2cf4-4174-9e08-52696edb6089" class="">Each process contributes to block of data at buffer <mark class="highlight-gray"><code>rbuf</code></mark><mark class="highlight-gray"> </mark>in root:<div class="indented"><p id="8fdd7d64-d546-4933-a18e-3c668becfa1b" class="">block from process <mark class="highlight-gray"><code>i</code></mark> stored at: <mark class="highlight-gray"><code>rbuf+i*rcount*extent(rtype)</code></mark></p><p id="1359e166-c3d5-43ab-b348-a1e5390cb3ea" class="">where:<div class="indented"><ul id="094f0205-64a6-45a3-b2ba-a0b170b6b461" class="bulleted-list"><li style="list-style-type:disc"><mark class="highlight-gray"><code>rcount</code></mark><mark class="highlight-gray"> </mark>is count of one block, not the whole <mark class="highlight-gray"><code>rbuf</code></mark></li></ul><ul id="5cbb03a8-0f2e-421b-a7b5-e5d37f490855" class="bulleted-list"><li style="list-style-type:disc"><mark class="highlight-gray"><code>extent(rtype)</code></mark> is the size in bytes spanned by MPI types<p id="46f4ee66-e892-4ead-80b5-cc8f72d3adec" class="">ie. <mark class="highlight-gray"><code>extent(MPI_INT) == sizeof(int)</code></mark></p></li></ul></div></p></div></p><p id="18c574e6-818b-4c9a-87bf-cea034e14afc" class="">Root also gathers from itself.<div class="indented"><p id="b37f466c-b186-4ffb-8546-662d4b807a98" class="">can be prevented with <mark class="highlight-gray"><code>MPI_IN_PLACE</code></mark> argument for <mark class="highlight-gray"><code>sbuf</code></mark>.</p><p id="08c5a4db-8fa3-4536-91b0-8565cb240be6" class="">this means: result from root is already in place</p></div></p></div></p><div id="aaeea2a2-2ce8-42bb-a6dd-186ccf181610" class="column-list"><div id="94e723cc-a4a7-4e17-89f5-c7734774483e" style="width:50%" class="column"><figure id="79e1adbd-4315-4d03-aaf4-643f361d3b06" class="image"><a href="MPI%2072068f7d370a4815972d9621a10519f0/Untitled%2027.png"><img style="width:240px" src="MPI%2072068f7d370a4815972d9621a10519f0/Untitled%2027.png"/></a></figure></div><div id="c8d4c332-3c16-47a6-97fa-0051ddf38fb0" style="width:50%" class="column"><figure id="cfe5bd20-8bff-4524-848b-11769f3d0db4" class="image"><a href="MPI%2072068f7d370a4815972d9621a10519f0/Untitled%2028.png"><img style="width:240px" src="MPI%2072068f7d370a4815972d9621a10519f0/Untitled%2028.png"/></a></figure></div></div><p id="baaa14dd-4bb5-461a-8870-d2dafa01858d" class="">
</p><p id="c0cb9df3-59eb-4165-a84e-e914b4e01654" class=""><mark class="highlight-blue">Scatter</mark><div class="indented"><p id="8cf9195b-9fca-4b4c-8fcb-c146d476b362" class="">distributes data: root → all (but processes get different blocks)</p><pre id="f0f9dbf1-4600-4f81-ab45-f03cbeac50fb" class="code"><code>MPI_Scatter(
	sbuf,scount,stype, // send
	rbuf,rcount,rtype, // receive
	root,comm
);</code></pre><p id="22853762-3c5f-4d8a-bf74-0405d14ce3d0" class="">Root sends different block from its buffer to each process.<div class="indented"><p id="5e4eeebe-606c-437d-b9d8-c30204431b7c" class="">Blocks stored in rank order at root: <mark class="highlight-gray"><code>sbuf+i*scount*extent(stype)</code></mark></p></div></p><p id="1ba9b495-d023-4397-b9ac-95c8734eb366" class="">Root also scatters to itself:<div class="indented"><p id="01d7a40b-061d-48ce-aff5-7ef5346efb21" class="">can be prevented with <mark class="highlight-gray"><code>MPI_IN_PLACE</code></mark> argument for <mark class="highlight-gray"><code>sbuf</code></mark>.</p><p id="d5b326d5-b6e0-4650-af54-514df7f1e782" class="">this means: result from root is already in place.</p></div></p><hr id="7166bfe3-0ed8-4b36-977c-2e37c862e4c0"/><ul id="880778f3-d288-4805-9fee-273ccea4acf1" class="toggle"><li><details open=""><summary>Example: Scatter-Gather pattern</summary><p id="f6ea0f65-e6b1-4c6d-8a57-b07aa6a87126" class="">Distribute data with <mark class="highlight-gray"><code>MPI_Scatter(A,...)</code></mark> of size <style>@import url('https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.13.2/katex.min.css')</style><span data-token-index="0" contenteditable="false" class="notion-text-equation-token" style="user-select:all;-webkit-user-select:all;-moz-user-select:all"><span></span><span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mstyle mathsize="0.9em"><mi>n</mi><mi mathvariant="normal">/</mi><mi>p</mi></mstyle></mrow><annotation encoding="application/x-tex">\small n/p</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.9em;vertical-align:-0.225em;"></span><span class="mord mathnormal sizing reset-size6 size5">n</span><span class="mord sizing reset-size6 size5">/</span><span class="mord mathnormal sizing reset-size6 size5">p</span></span></span></span></span><span>﻿</span></span>, then collect results with <mark class="highlight-gray"><code>MPI_Gather(B,...)</code></mark>.</p><pre id="8c92e148-1fe8-4c1a-8a27-dab55f92d2e8" class="code"><code>int root = 0;
MPI_Comm_size(comm,&amp;p);
MPI_Comm_rank(comm,&amp;r);
assert(n%p==0); // else use MPI_Scatterv (irregular collective)

// allocate a,c and initialize a with values
if (rank==root) {
	int *a = (int*)malloc(n*sizeof(int)); // a: root -&gt; all
	int *c = (int*)malloc(n*sizeof(int)); // c: root &lt;- all
	for (i=0; i&lt;n; i++) a[i] = &lt;init&gt;;
}

// allocate b
int *b = (int*)malloc((n/p)*sizeof(int)); // a -&gt; b block -&gt; c

MPI_Scatter( // root: a -&gt; b
	a,n/p,MPI_INT,
	b,n/p,MPI_INT,
	root,comm
);
... // compute on b: all processes
MPI_Gather( // root: b -&gt; c
	b,n/p,MPI_INT, 
	c,n/p,MPI_INT,
	root,comm
);</code></pre><figure id="31861663-206c-46f1-acf2-5c8d3abff427" class="image"><a href="MPI%2072068f7d370a4815972d9621a10519f0/Untitled%2029.png"><img style="width:192px" src="MPI%2072068f7d370a4815972d9621a10519f0/Untitled%2029.png"/></a></figure><p id="ef333344-418e-4a92-aab3-4c13904ecba5" class="">
</p></details></li></ul><ul id="43851053-289a-4ab1-a60e-5fd46efae608" class="toggle"><li><details open=""><summary>Example: barrier (unsafe)</summary><p id="b7ebd325-708d-4f82-a09a-d92125f68794" class="">May have better performance than <mark class="highlight-gray"><code>send-recv</code></mark><mark class="highlight-gray"> </mark>since we don’t actually send empty messages (but it depends on the implementation → unsafe)</p><pre id="41c00cfd-161b-4758-81ce-ec2b94289fc2" class="code"><code>MPI_Gather(NULL,0,MPI_BYTE,NULL,0,MPI_BYTE,0,comm);
MPI_Scatter(NULL,0,MPI_BYTE,NULL,0,MPI_BYTE,0,comm);</code></pre></details></li></ul></div></p><div id="e5b76e99-8fb6-4e4b-8f94-509461f8022b" class="column-list"><div id="0086b9c4-1628-437b-90a5-3751a9bd3f9e" style="width:50%" class="column"><figure id="6e52caab-3b99-4d5a-828a-cb32d469e576" class="image"><a href="MPI%2072068f7d370a4815972d9621a10519f0/Untitled%2030.png"><img style="width:240px" src="MPI%2072068f7d370a4815972d9621a10519f0/Untitled%2030.png"/></a></figure></div><div id="89addd04-5660-4c2d-a22e-f19bd4621115" style="width:50%" class="column"><figure id="020d4857-0594-4e12-bc7d-151a74036b2f" class="image"><a href="MPI%2072068f7d370a4815972d9621a10519f0/Untitled%2031.png"><img style="width:240px" src="MPI%2072068f7d370a4815972d9621a10519f0/Untitled%2031.png"/></a></figure></div></div><p id="58a65597-6acb-4033-a1fc-0c71c80b5cc6" class="">
</p><p id="db8841d5-0c7d-4a84-90e7-805a1b9d75c1" class=""><mark class="highlight-blue">Allgather</mark><div class="indented"><pre id="efb298ce-deeb-4109-85eb-b1a0b29e8118" class="code"><code>MPI_Allgather(
	sbuf,scount,stype, // send
	rbuf,rcount,rtype, // receive
	comm
);</code></pre><ul id="fa4d9803-1c86-4917-8019-2bdd64dd89da" class="toggle"><li><details open=""><summary>Alternative</summary><pre id="5c563c73-91a4-44f3-98dd-6de90fabbfbb" class="code"><code>MPI_Gather(sbuf,…,rbuf,…,0,comm);
MPI_Bcast(rbuf,size*rcount,rtype,…,0,comm);</code></pre><pre id="baa78070-6e4a-4ce1-a58f-03180ecec48d" class="code"><code>for (i) { // all-to-all broadcast
	if (i==rank) MPI_Bcast(sbuf,…,i,comm);
	else MPI_Bcast(rbuf+i*rcount*extent(rtype),…,i,comm);
}
memcpy(rbuf+rank*rcount*extent(rtype),sbuf,…);</code></pre><p id="fd3e74c8-53d9-420a-be75-403e74769489" class="">but performance of library is much better-</p><p id="aab9ca6b-1421-4165-b236-7c56ce3ca30a" class="">It always performs better than <mark class="highlight-gray"><code>Gather</code></mark> + <mark class="highlight-gray"><code>Bcast</code></mark>.</p><p id="d4e347a9-9da0-4f15-bad6-68efb259e6ef" class="">
</p></details></li></ul><p id="6125a274-891f-49cc-be4d-e488050eeac6" class="">Each process sends block to <mark class="highlight-gray"><code>rbuf</code></mark><mark class="highlight-gray"> </mark>of all other processes.<div class="indented"><p id="2c44697a-83c7-4e12-9bff-fabc7614fc62" class="">Ends up storing other blocks aswell in order <mark class="highlight-gray"><code>rbuf+i*rcount*extent(rtype)</code></mark></p></div></p><p id="2f55631c-7d39-4035-8df1-5314ae76f59a" class="">Process also sends block to itself: can be prevented with <mark class="highlight-gray"><code>MPI_IN_PLACE</code></mark> argument for <mark class="highlight-gray"><code>sbuf</code></mark> (must be set for all processes).</p><p id="da55e329-7693-4e66-869e-2f01d66ee818" class="">Data gets “transposed” (see graphics below).</p><hr id="05a179ff-6e8a-4c2e-8988-517de64583f9"/><figure id="aa738dc7-7795-4d34-9bc8-abe67aa7d7f6" class="link-to-page"><a href="MPI%2072068f7d370a4815972d9621a10519f0/Matrix-Vector%20multiplication%20aa738dc777954d349bc8abe67aa7d7f6.html"><span class="icon">📎</span>Matrix-Vector multiplication</a></figure><figure id="580f23fe-5b21-4be6-9180-71408c8e66a4" class="link-to-page"><a href="MPI%2072068f7d370a4815972d9621a10519f0/Matrix-Matrix%20multiplication%20580f23fe5b214be6918071408c8e66a4.html"><span class="icon">📎</span>Matrix-Matrix multiplication</a></figure></div></p><div id="b44db75b-a303-4583-981e-2e13ae06def1" class="column-list"><div id="ad6dd1b9-dc44-4ae2-a361-6f45223919f7" style="width:50%" class="column"><figure id="100913e7-7200-425b-9912-2de99fa1ec80" class="image"><a href="MPI%2072068f7d370a4815972d9621a10519f0/Untitled%2032.png"><img style="width:240px" src="MPI%2072068f7d370a4815972d9621a10519f0/Untitled%2032.png"/></a></figure></div><div id="4e067dcc-ed5e-47cd-b4ac-a11f27e6727e" style="width:50%" class="column"><figure id="8f722371-cd4f-4e83-b615-f0f8a19560a6" class="image"><a href="MPI%2072068f7d370a4815972d9621a10519f0/Untitled%2033.png"><img style="width:240px" src="MPI%2072068f7d370a4815972d9621a10519f0/Untitled%2033.png"/></a></figure></div></div><p id="e97d48af-ed8c-497e-aca6-000d0f4a8c3e" class="">
</p><p id="06d81114-3365-44bc-a070-d197dbb69d4a" class=""><mark class="highlight-blue">Alltoall</mark><div class="indented"><p id="b435b5d3-e37d-42e1-ad8f-c9417c541d3d" class="">Same as <mark class="highlight-gray"><code>Allgather</code></mark> but blocks sent are different for each process.</p><pre id="49d23e74-0c67-4b10-aad8-e3e20e2b1626" class="code"><code>MPI_Alltoall(
	sbuf,scount,stype, // send
	rbuf,rcount,rtype, // receive
	comm
);</code></pre><p id="095bb91d-6359-421c-8211-686f004a2209" class="">Data gets “transposed” (see graphics below).</p><p id="bd4a5d2b-2506-4250-b669-82c4564ea7b4" class="">Each processor contributes to different block of data in other processes.<div class="indented"><p id="f57affcb-8937-48f3-b9bf-cc7a7af17b6c" class="">Block <em>to</em> process <mark class="highlight-gray"><code>i</code></mark><mark class="highlight-gray"> </mark>is stored at: <mark class="highlight-gray"><code>sbuf+i*scount*extent(stype)</code></mark></p><p id="d8ea22cc-638d-4ad4-9512-11fac2520273" class="">Block <em>from</em> process <mark class="highlight-gray"><code>i</code></mark><mark class="highlight-gray"> </mark>is stored at: <mark class="highlight-gray"><code>rbuf+i*rcount*extent(rtype)</code></mark></p></div></p></div></p><figure id="e679ee70-f237-473b-bf94-bc77aeb0663f" class="image"><a href="MPI%2072068f7d370a4815972d9621a10519f0/Untitled%2034.png"><img style="width:144px" src="MPI%2072068f7d370a4815972d9621a10519f0/Untitled%2034.png"/></a></figure><p id="0088d6aa-8ecf-4875-9d97-4e3c13b0f9f5" class="">
</p><p id="923e6b62-9a54-4365-a910-df4a7bded5e6" class=""><mark class="highlight-blue">Gatherv</mark><div class="indented"><p id="cdd5bb74-0914-45be-b3aa-0e47c0265e9d" class="">Same as gather but with irregular data.</p><pre id="a4a1305a-4d7a-47ac-800c-8cb3749d2984" class="code"><code>MPI_Gatherv(
	sbuf,scount,stype, // send
	rbuf,rcount,rdisp,rtype, // receive (address, count, displacement, type)
	root,comm
)</code></pre><p id="6487e153-54ab-44eb-9c07-9ca29097a4d7" class="">Data must not overlap.</p><p id="98929d73-011f-4ef2-b515-fc07a6c0f94e" class="">Block from process <mark class="highlight-gray"><code>i</code></mark><mark class="highlight-gray"> </mark>is stored at: <mark class="highlight-gray"><code>rbuf+disp[i]*extent(rtype)</code></mark></p><hr id="6bd8380f-3e26-4f15-bde7-402d75994933"/><ul id="13638b06-18d6-48c5-92f6-a5958514bfa4" class="toggle"><li><details open=""><summary>Example: Root gathers initially unknown amount of data from all processes</summary><p id="bcdb21b0-4296-4bde-a5c7-7838ea9a82ab" class=""><mark class="highlight-gray"><code>scount</code></mark> and <mark class="highlight-gray"><code>rcounts[i]</code></mark> must match.<div class="indented"><p id="8e79fced-cfe8-4673-8fe7-377df3dd2307" class="">Won’t work if root doesn’t know <mark class="highlight-gray"><code>scount</code></mark> of other processes.</p></div></p><pre id="f7e363b2-8913-420d-ad11-8cba1884530d" class="code"><code>if (rank==root) {
	MPI_Gatherv(sbuf,…rbuf,rcounts,rdisp,…,comm); // rcounts as array
} else {
	MPI_Gatherv(sbuf,scount,…,comm); // scount
}</code></pre><p id="78f61ef1-6119-4b85-bbb6-6a07d5c8c0c9" class="">
</p><p id="70efcd08-9d6e-426e-b838-4736c8be33fd" class="">Here we use regular gather to gather the <mark class="highlight-gray"><code>rcounts</code></mark> array from all processes.</p><pre id="6d63e977-df6c-418a-ab98-802c9a847e9d" class="code"><code>if (rank==root) {
	MPI_Gather(scount,1,MPI_INT,rcounts,1,MPI_INT,comm);
	// compute displacements
	MPI_Gatherv(sbuf,…rbuf,rcounts,rdisp,…,comm);
} else {
	MPI_Gather(scount,1,MPI_INT,rcounts,1,MPI_INT,comm);
	MPI_Gatherv(sbuf,scount,…,comm);
}</code></pre></details></li></ul></div></p><figure id="36643554-1f72-4ab2-87ef-23f1df069a44" class="image"><a href="MPI%2072068f7d370a4815972d9621a10519f0/Untitled%2035.png"><img style="width:192px" src="MPI%2072068f7d370a4815972d9621a10519f0/Untitled%2035.png"/></a></figure><p id="3d733d6e-419b-498e-9e9f-c2827688b3a5" class="">
</p><h2 id="7245c26a-71d3-498e-b1ed-d28f1463f64e" class="">Reduction collectives</h2><p id="87fc58e4-34ea-4647-9662-f7d43b596eb6" class=""><em><mark class="highlight-blue">About reduction collectives</mark></em><div class="indented"><ul id="2d20a4da-7082-4621-90df-d905752c880f" class="bulleted-list"><li style="list-style-type:disc">Each process has vector of data <style>@import url('https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.13.2/katex.min.css')</style><span data-token-index="0" contenteditable="false" class="notion-text-equation-token" style="user-select:all;-webkit-user-select:all;-moz-user-select:all"><span></span><span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mstyle mathsize="0.9em"><mover accent="true"><mi>x</mi><mo>⃗</mo></mover></mstyle></mrow><annotation encoding="application/x-tex">\small \vec x</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6426em;vertical-align:0em;"></span><span class="mord accent sizing reset-size6 size5"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.714em;"><span style="top:-2.9em;"><span class="pstrut" style="height:2.9em;"></span><span class="mord mathnormal">x</span></span><span style="top:-2.9em;"><span class="pstrut" style="height:2.9em;"></span><span class="accent-body" style="left:-0.20772em;"><span class="overlay" style="height:0.714em;width:0.471em;"><svg width='0.471em' height='0.714em' style='width:0.471em' viewBox='0 0 471 714' preserveAspectRatio='xMinYMin'><path d='M377 20c0-5.333 1.833-10 5.5-14S391 0 397 0c4.667 0 8.667 1.667 12 5
3.333 2.667 6.667 9 10 19 6.667 24.667 20.333 43.667 41 57 7.333 4.667 11
10.667 11 18 0 6-1 10-3 12s-6.667 5-14 9c-28.667 14.667-53.667 35.667-75 63
-1.333 1.333-3.167 3.5-5.5 6.5s-4 4.833-5 5.5c-1 .667-2.5 1.333-4.5 2s-4.333 1
-7 1c-4.667 0-9.167-1.833-13.5-5.5S337 184 337 178c0-12.667 15.667-32.333 47-59
H213l-171-1c-8.667-6-13-12.333-13-19 0-4.667 4.333-11.333 13-20h359
c-16-25.333-24-45-24-59z'/></svg></span></span></span></span></span></span></span></span></span></span></span><span>﻿</span></span> (same size, same type)</li></ul><ul id="7a5c3cae-7832-48a3-8c80-d0a12d4687ac" class="bulleted-list"><li style="list-style-type:disc">Associative operation <style>@import url('https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.13.2/katex.min.css')</style><span data-token-index="0" contenteditable="false" class="notion-text-equation-token" style="user-select:all;-webkit-user-select:all;-moz-user-select:all"><span></span><span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mstyle mathsize="0.9em"><mo>+</mo></mstyle></mrow><annotation encoding="application/x-tex">\small +</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.599994em;vertical-align:-0.07499700000000001em;"></span><span class="mord sizing reset-size6 size5">+</span></span></span></span></span><span>﻿</span></span> (built in MPI or user defined)<p id="b8dabeb1-9d1f-4b35-ac52-6c484e0c4d94" class="">for element wise reduction <style>@import url('https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.13.2/katex.min.css')</style><span data-token-index="0" contenteditable="false" class="notion-text-equation-token" style="user-select:all;-webkit-user-select:all;-moz-user-select:all"><span></span><span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mstyle mathsize="0.9em"><mover accent="true"><mi>y</mi><mo>⃗</mo></mover><mo>=</mo><msub><mover accent="true"><mi>x</mi><mo>⃗</mo></mover><mn>0</mn></msub><mo>+</mo><msub><mover accent="true"><mi>x</mi><mo>⃗</mo></mover><mn>1</mn></msub><mo>+</mo><msub><mover accent="true"><mi>x</mi><mo>⃗</mo></mover><mn>2</mn></msub><mo>+</mo><mo>…</mo><mo>+</mo><msub><mover accent="true"><mi>x</mi><mo>⃗</mo></mover><mrow><mi>p</mi><mo>−</mo><mn>1</mn></mrow></msub></mstyle></mrow><annotation encoding="application/x-tex">\small \vec y = \vec x_0+\vec x_1+\vec x_2+ … +\vec x_{p-1}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.817596em;vertical-align:-0.174996em;"></span><span class="mord accent sizing reset-size6 size5"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.714em;"><span style="top:-2.9em;"><span class="pstrut" style="height:2.9em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">y</span></span><span style="top:-2.9em;"><span class="pstrut" style="height:2.9em;"></span><span class="accent-body" style="left:-0.17994em;"><span class="overlay" style="height:0.714em;width:0.471em;"><svg width='0.471em' height='0.714em' style='width:0.471em' viewBox='0 0 471 714' preserveAspectRatio='xMinYMin'><path d='M377 20c0-5.333 1.833-10 5.5-14S391 0 397 0c4.667 0 8.667 1.667 12 5
3.333 2.667 6.667 9 10 19 6.667 24.667 20.333 43.667 41 57 7.333 4.667 11
10.667 11 18 0 6-1 10-3 12s-6.667 5-14 9c-28.667 14.667-53.667 35.667-75 63
-1.333 1.333-3.167 3.5-5.5 6.5s-4 4.833-5 5.5c-1 .667-2.5 1.333-4.5 2s-4.333 1
-7 1c-4.667 0-9.167-1.833-13.5-5.5S337 184 337 178c0-12.667 15.667-32.333 47-59
H213l-171-1c-8.667-6-13-12.333-13-19 0-4.667 4.333-11.333 13-20h359
c-16-25.333-24-45-24-59z'/></svg></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.19444em;"><span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel sizing reset-size6 size5">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.7776em;vertical-align:-0.135em;"></span><span class="mord sizing reset-size6 size5"><span class="mord accent"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.714em;"><span style="top:-2.9em;"><span class="pstrut" style="height:2.9em;"></span><span class="mord mathnormal">x</span></span><span style="top:-2.9em;"><span class="pstrut" style="height:2.9em;"></span><span class="accent-body" style="left:-0.20772em;"><span class="overlay" style="height:0.714em;width:0.471em;"><svg width='0.471em' height='0.714em' style='width:0.471em' viewBox='0 0 471 714' preserveAspectRatio='xMinYMin'><path d='M377 20c0-5.333 1.833-10 5.5-14S391 0 397 0c4.667 0 8.667 1.667 12 5
3.333 2.667 6.667 9 10 19 6.667 24.667 20.333 43.667 41 57 7.333 4.667 11
10.667 11 18 0 6-1 10-3 12s-6.667 5-14 9c-28.667 14.667-53.667 35.667-75 63
-1.333 1.333-3.167 3.5-5.5 6.5s-4 4.833-5 5.5c-1 .667-2.5 1.333-4.5 2s-4.333 1
-7 1c-4.667 0-9.167-1.833-13.5-5.5S337 184 337 178c0-12.667 15.667-32.333 47-59
H213l-171-1c-8.667-6-13-12.333-13-19 0-4.667 4.333-11.333 13-20h359
c-16-25.333-24-45-24-59z'/></svg></span></span></span></span></span></span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2796266666666667em;"><span style="top:-2.45em;margin-left:0em;margin-right:0.05555555555555556em;"><span class="pstrut" style="height:2.6em;"></span><span class="sizing reset-size5 size2 mtight"><span class="mord mtight">0</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin sizing reset-size6 size5">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.7776em;vertical-align:-0.135em;"></span><span class="mord sizing reset-size6 size5"><span class="mord accent"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.714em;"><span style="top:-2.9em;"><span class="pstrut" style="height:2.9em;"></span><span class="mord mathnormal">x</span></span><span style="top:-2.9em;"><span class="pstrut" style="height:2.9em;"></span><span class="accent-body" style="left:-0.20772em;"><span class="overlay" style="height:0.714em;width:0.471em;"><svg width='0.471em' height='0.714em' style='width:0.471em' viewBox='0 0 471 714' preserveAspectRatio='xMinYMin'><path d='M377 20c0-5.333 1.833-10 5.5-14S391 0 397 0c4.667 0 8.667 1.667 12 5
3.333 2.667 6.667 9 10 19 6.667 24.667 20.333 43.667 41 57 7.333 4.667 11
10.667 11 18 0 6-1 10-3 12s-6.667 5-14 9c-28.667 14.667-53.667 35.667-75 63
-1.333 1.333-3.167 3.5-5.5 6.5s-4 4.833-5 5.5c-1 .667-2.5 1.333-4.5 2s-4.333 1
-7 1c-4.667 0-9.167-1.833-13.5-5.5S337 184 337 178c0-12.667 15.667-32.333 47-59
H213l-171-1c-8.667-6-13-12.333-13-19 0-4.667 4.333-11.333 13-20h359
c-16-25.333-24-45-24-59z'/></svg></span></span></span></span></span></span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2796266666666667em;"><span style="top:-2.45em;margin-left:0em;margin-right:0.05555555555555556em;"><span class="pstrut" style="height:2.6em;"></span><span class="sizing reset-size5 size2 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin sizing reset-size6 size5">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.7776em;vertical-align:-0.135em;"></span><span class="mord sizing reset-size6 size5"><span class="mord accent"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.714em;"><span style="top:-2.9em;"><span class="pstrut" style="height:2.9em;"></span><span class="mord mathnormal">x</span></span><span style="top:-2.9em;"><span class="pstrut" style="height:2.9em;"></span><span class="accent-body" style="left:-0.20772em;"><span class="overlay" style="height:0.714em;width:0.471em;"><svg width='0.471em' height='0.714em' style='width:0.471em' viewBox='0 0 471 714' preserveAspectRatio='xMinYMin'><path d='M377 20c0-5.333 1.833-10 5.5-14S391 0 397 0c4.667 0 8.667 1.667 12 5
3.333 2.667 6.667 9 10 19 6.667 24.667 20.333 43.667 41 57 7.333 4.667 11
10.667 11 18 0 6-1 10-3 12s-6.667 5-14 9c-28.667 14.667-53.667 35.667-75 63
-1.333 1.333-3.167 3.5-5.5 6.5s-4 4.833-5 5.5c-1 .667-2.5 1.333-4.5 2s-4.333 1
-7 1c-4.667 0-9.167-1.833-13.5-5.5S337 184 337 178c0-12.667 15.667-32.333 47-59
H213l-171-1c-8.667-6-13-12.333-13-19 0-4.667 4.333-11.333 13-20h359
c-16-25.333-24-45-24-59z'/></svg></span></span></span></span></span></span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2796266666666667em;"><span style="top:-2.45em;margin-left:0em;margin-right:0.05555555555555556em;"><span class="pstrut" style="height:2.6em;"></span><span class="sizing reset-size5 size2 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin sizing reset-size6 size5">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.599994em;vertical-align:-0.07499700000000001em;"></span><span class="minner sizing reset-size6 size5">…</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin sizing reset-size6 size5">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.894264em;vertical-align:-0.25166400000000005em;"></span><span class="mord sizing reset-size6 size5"><span class="mord accent"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.714em;"><span style="top:-2.9em;"><span class="pstrut" style="height:2.9em;"></span><span class="mord mathnormal">x</span></span><span style="top:-2.9em;"><span class="pstrut" style="height:2.9em;"></span><span class="accent-body" style="left:-0.20772em;"><span class="overlay" style="height:0.714em;width:0.471em;"><svg width='0.471em' height='0.714em' style='width:0.471em' viewBox='0 0 471 714' preserveAspectRatio='xMinYMin'><path d='M377 20c0-5.333 1.833-10 5.5-14S391 0 397 0c4.667 0 8.667 1.667 12 5
3.333 2.667 6.667 9 10 19 6.667 24.667 20.333 43.667 41 57 7.333 4.667 11
10.667 11 18 0 6-1 10-3 12s-6.667 5-14 9c-28.667 14.667-53.667 35.667-75 63
-1.333 1.333-3.167 3.5-5.5 6.5s-4 4.833-5 5.5c-1 .667-2.5 1.333-4.5 2s-4.333 1
-7 1c-4.667 0-9.167-1.833-13.5-5.5S337 184 337 178c0-12.667 15.667-32.333 47-59
H213l-171-1c-8.667-6-13-12.333-13-19 0-4.667 4.333-11.333 13-20h359
c-16-25.333-24-45-24-59z'/></svg></span></span></span></span></span></span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2796266666666667em;"><span style="top:-2.45em;margin-left:0em;margin-right:0.05555555555555556em;"><span class="pstrut" style="height:2.6em;"></span><span class="sizing reset-size5 size2 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">p</span><span class="mbin mtight">−</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2796266666666667em;"><span></span></span></span></span></span></span></span></span></span></span><span>﻿</span></span></p><p id="38c86157-6f95-4ae4-9f9e-b346e0ebff25" class=""><mark class="highlight-gray"><em>associative means brackets don’t influence result </em></mark><mark class="highlight-gray"><em><style>@import url('https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.13.2/katex.min.css')</style><span data-token-index="0" contenteditable="false" class="notion-text-equation-token" style="user-select:all;-webkit-user-select:all;-moz-user-select:all"><span></span><span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mstyle mathsize="0.9em"><mo stretchy="false">(</mo><mi>a</mi><mo>+</mo><mi>b</mi><mo stretchy="false">)</mo><mo>+</mo><mi>c</mi><mo>=</mo><mi>a</mi><mo>+</mo><mo stretchy="false">(</mo><mi>b</mi><mo>+</mo><mi>c</mi><mo stretchy="false">)</mo></mstyle></mrow><annotation encoding="application/x-tex">\small (a + b) + c = a + (b + c)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.9em;vertical-align:-0.225em;"></span><span class="mopen sizing reset-size6 size5">(</span><span class="mord mathnormal sizing reset-size6 size5">a</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin sizing reset-size6 size5">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.9em;vertical-align:-0.225em;"></span><span class="mord mathnormal sizing reset-size6 size5">b</span><span class="mclose sizing reset-size6 size5">)</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin sizing reset-size6 size5">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.387504em;vertical-align:0em;"></span><span class="mord mathnormal sizing reset-size6 size5">c</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel sizing reset-size6 size5">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.599994em;vertical-align:-0.07499700000000001em;"></span><span class="mord mathnormal sizing reset-size6 size5">a</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin sizing reset-size6 size5">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.9em;vertical-align:-0.225em;"></span><span class="mopen sizing reset-size6 size5">(</span><span class="mord mathnormal sizing reset-size6 size5">b</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin sizing reset-size6 size5">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.9em;vertical-align:-0.225em;"></span><span class="mord mathnormal sizing reset-size6 size5">c</span><span class="mclose sizing reset-size6 size5">)</span></span></span></span></span><span>﻿</span></span></em></mark></p><p id="8b17b874-86e8-4716-a2e9-8b508a03e8da" class=""><mark class="highlight-gray"><em>commutativity can also be exploited </em></mark><mark class="highlight-gray"><em><style>@import url('https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.13.2/katex.min.css')</style><span data-token-index="0" contenteditable="false" class="notion-text-equation-token" style="user-select:all;-webkit-user-select:all;-moz-user-select:all"><span></span><span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mstyle mathsize="0.9em"><mi>a</mi><mo>⋅</mo><mi>b</mi><mo>=</mo><mi>b</mi><mo>⋅</mo><mi>a</mi></mstyle></mrow><annotation encoding="application/x-tex">\small a \cdot  b = b \cdot a</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.400005em;vertical-align:0em;"></span><span class="mord mathnormal sizing reset-size6 size5">a</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin sizing reset-size6 size5">⋅</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.624996em;vertical-align:0em;"></span><span class="mord mathnormal sizing reset-size6 size5">b</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel sizing reset-size6 size5">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.624996em;vertical-align:0em;"></span><span class="mord mathnormal sizing reset-size6 size5">b</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin sizing reset-size6 size5">⋅</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.387504em;vertical-align:0em;"></span><span class="mord mathnormal sizing reset-size6 size5">a</span></span></span></span></span><span>﻿</span></span></em></mark></p></li></ul><ul id="6ee844f3-0a3b-439e-9136-79f3abff7eb6" class="bulleted-list"><li style="list-style-type:disc">stored in<p id="f4bdf78c-fb84-4979-9ae8-c462265b8dae" class=""><mark class="highlight-gray"><code>MPI_Reduce</code></mark><mark class="highlight-gray"> </mark>		root</p><p id="f0448035-a2e8-41f8-b1d3-be9ddeab918a" class=""><mark class="highlight-gray"><code>MPI_Allreduce</code></mark> 	all processes</p><p id="8d4a34de-8536-4167-b01f-ee94d79fed83" class=""><mark class="highlight-gray"><code>MPI_Allreduce</code></mark> 	scattered in blocks <style>@import url('https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.13.2/katex.min.css')</style><span data-token-index="0" contenteditable="false" class="notion-text-equation-token" style="user-select:all;-webkit-user-select:all;-moz-user-select:all"><span></span><span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mstyle mathsize="0.9em"><msub><mover accent="true"><mi>y</mi><mo>⃗</mo></mover><mn>0</mn></msub><mo separator="true">,</mo><msub><mover accent="true"><mi>y</mi><mo>⃗</mo></mover><mn>1</mn></msub><mo separator="true">,</mo><mo>…</mo></mstyle></mrow><annotation encoding="application/x-tex">\small \vec y_0,\vec y_1, \dots  </annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.817596em;vertical-align:-0.174996em;"></span><span class="mord sizing reset-size6 size5"><span class="mord accent"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.714em;"><span style="top:-2.9em;"><span class="pstrut" style="height:2.9em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">y</span></span><span style="top:-2.9em;"><span class="pstrut" style="height:2.9em;"></span><span class="accent-body" style="left:-0.17994em;"><span class="overlay" style="height:0.714em;width:0.471em;"><svg width='0.471em' height='0.714em' style='width:0.471em' viewBox='0 0 471 714' preserveAspectRatio='xMinYMin'><path d='M377 20c0-5.333 1.833-10 5.5-14S391 0 397 0c4.667 0 8.667 1.667 12 5
3.333 2.667 6.667 9 10 19 6.667 24.667 20.333 43.667 41 57 7.333 4.667 11
10.667 11 18 0 6-1 10-3 12s-6.667 5-14 9c-28.667 14.667-53.667 35.667-75 63
-1.333 1.333-3.167 3.5-5.5 6.5s-4 4.833-5 5.5c-1 .667-2.5 1.333-4.5 2s-4.333 1
-7 1c-4.667 0-9.167-1.833-13.5-5.5S337 184 337 178c0-12.667 15.667-32.333 47-59
H213l-171-1c-8.667-6-13-12.333-13-19 0-4.667 4.333-11.333 13-20h359
c-16-25.333-24-45-24-59z'/></svg></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.19444em;"><span></span></span></span></span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2796266666666667em;"><span style="top:-2.45em;margin-left:-0.03588em;margin-right:0.05555555555555556em;"><span class="pstrut" style="height:2.6em;"></span><span class="sizing reset-size5 size2 mtight"><span class="mord mtight">0</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct sizing reset-size6 size5">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord sizing reset-size6 size5"><span class="mord accent"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.714em;"><span style="top:-2.9em;"><span class="pstrut" style="height:2.9em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">y</span></span><span style="top:-2.9em;"><span class="pstrut" style="height:2.9em;"></span><span class="accent-body" style="left:-0.17994em;"><span class="overlay" style="height:0.714em;width:0.471em;"><svg width='0.471em' height='0.714em' style='width:0.471em' viewBox='0 0 471 714' preserveAspectRatio='xMinYMin'><path d='M377 20c0-5.333 1.833-10 5.5-14S391 0 397 0c4.667 0 8.667 1.667 12 5
3.333 2.667 6.667 9 10 19 6.667 24.667 20.333 43.667 41 57 7.333 4.667 11
10.667 11 18 0 6-1 10-3 12s-6.667 5-14 9c-28.667 14.667-53.667 35.667-75 63
-1.333 1.333-3.167 3.5-5.5 6.5s-4 4.833-5 5.5c-1 .667-2.5 1.333-4.5 2s-4.333 1
-7 1c-4.667 0-9.167-1.833-13.5-5.5S337 184 337 178c0-12.667 15.667-32.333 47-59
H213l-171-1c-8.667-6-13-12.333-13-19 0-4.667 4.333-11.333 13-20h359
c-16-25.333-24-45-24-59z'/></svg></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.19444em;"><span></span></span></span></span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2796266666666667em;"><span style="top:-2.45em;margin-left:-0.03588em;margin-right:0.05555555555555556em;"><span class="pstrut" style="height:2.6em;"></span><span class="sizing reset-size5 size2 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct sizing reset-size6 size5">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="minner sizing reset-size6 size5">…</span></span></span></span></span><span>﻿</span></span></p></li></ul></div></p><p id="be58de15-7562-48c4-b635-bcbdcd9f4108" class="">
</p><p id="646f68e6-ff3f-4f87-bfb5-264846b2c2bb" class=""><em><mark class="highlight-blue">Operators</mark></em><div class="indented"><p id="76096626-f544-4496-abe8-df57d1b14dbb" class="">One can also register user defined operators</p><pre id="e703c06f-c32b-454e-b5a3-8e9f54d7df63" class="code"><code>MPI_Op_create(MPI_User_function *function, int commutative, MPI_Op *op);
MPI_Op_free(MPI_Op *op); // free after usage</code></pre></div></p><figure id="53419f52-cbe6-4ae2-af72-341f0d6d813f" class="image"><a href="MPI%2072068f7d370a4815972d9621a10519f0/Untitled%2036.png"><img style="width:240px" src="MPI%2072068f7d370a4815972d9621a10519f0/Untitled%2036.png"/></a></figure><p id="efa94696-ee04-4d0e-a074-1eb72dac3a1f" class="">
</p><p id="2e5c92ca-504d-4f55-ad35-f527e3ffe361" class=""><mark class="highlight-blue">Reduce</mark><div class="indented"><pre id="7ee15c43-979e-457a-8ece-a50e334e681a" class="code"><code>MPI_Reduce(sbuf,rbuf,count,type,op,root,comm);</code></pre><pre id="ef99a58f-69e1-41a4-a3ea-922dd098a654" class="code"><code>MPI_Reduce(
	void *sendbuf, void *recvbuf,
	int count, // input per processor is a vector 
	MPI_Datatype datatype,
	MPI_Op op, // associative operators (can be user defined)
	int root,
	MPI_Comm comm
);</code></pre><p id="514e4c8f-085f-4887-96a8-1f25f5938711" class="">Elementwise result stored in <mark class="highlight-gray"><code>rbuf</code></mark><mark class="highlight-gray"> </mark>at root.</p><p id="6f43538f-0e95-4f13-979d-53de22ef5120" class="">If <mark class="highlight-gray"><code>MPI_IN_PLACE</code></mark><mark class="highlight-gray"> </mark>as argument for <mark class="highlight-gray"><code>sbuf</code></mark>, then input is taken from <mark class="highlight-gray"><code>rbuf</code></mark>. </p><hr id="ea0de3c3-5560-4db6-9258-f8c4a0a9b3a3"/><ul id="b95460a9-296f-49b5-8d04-7b497bc745a6" class="toggle"><li><details open=""><summary>Example: Single scalar</summary><pre id="e93ba5e5-5096-48f9-a0e7-859d59b1f65e" class="code"><code>if (rank==root) {
	x = rank;
	MPI_Reduce(&amp;x,&amp;y,1,MPI_INT,MPI_SUM,root,comm);
	if (y!=(size*(size-1))/2) printf(&quot;Error!\n&quot;);
	// y significant at root only
} else {
	x = rank;
	MPI_Reduce(&amp;x,&amp;y,1,MPI_INT,MPI_SUM,root,comm);
}</code></pre></details></li></ul><ul id="503f88d1-d3f9-43cf-90a9-1e336147a453" class="toggle"><li><details open=""><summary>Example: Ring</summary><p id="a1cea0c2-3627-4b8e-ae7b-1a85a72e5176" class="">Root passes vector to next process ... and so on ... until it reaches root again.</p><p id="52c43c2e-924e-42c4-a813-4701731becee" class=""><mark class="highlight-teal">Idea</mark><div class="indented"><p id="1f0dd045-64a3-44ca-8b4e-f62eba87da59" class=""><style>@import url('https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.13.2/katex.min.css')</style><span data-token-index="0" contenteditable="false" class="notion-text-equation-token" style="user-select:all;-webkit-user-select:all;-moz-user-select:all"><span></span><span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mstyle mathsize="0.9em"><msub><mi>x</mi><mn>0</mn></msub><mo>+</mo><msub><mi>x</mi><mn>1</mn></msub><mo>+</mo><msub><mi>x</mi><mn>2</mn></msub><mo>+</mo><msub><mi>x</mi><mn>3</mn></msub><mo>+</mo><mo>…</mo><mo>+</mo><msub><mi>x</mi><mrow><mi>p</mi><mo>−</mo><mn>2</mn></mrow></msub><mo>+</mo><msub><mi>x</mi><mrow><mi>p</mi><mo>−</mo><mn>1</mn></mrow></msub><mo>=</mo><mi>y</mi></mstyle></mrow><annotation encoding="application/x-tex">\small x_{0}+x_{1}+x_{2}+x_3+\ldots+x_{p-2}+x_{p-1}=y</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6599970000000001em;vertical-align:-0.135em;"></span><span class="mord sizing reset-size6 size5"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2796266666666667em;"><span style="top:-2.45em;margin-left:0em;margin-right:0.05555555555555556em;"><span class="pstrut" style="height:2.6em;"></span><span class="sizing reset-size5 size2 mtight"><span class="mord mtight"><span class="mord mtight">0</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin sizing reset-size6 size5">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.6599970000000001em;vertical-align:-0.135em;"></span><span class="mord sizing reset-size6 size5"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2796266666666667em;"><span style="top:-2.45em;margin-left:0em;margin-right:0.05555555555555556em;"><span class="pstrut" style="height:2.6em;"></span><span class="sizing reset-size5 size2 mtight"><span class="mord mtight"><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin sizing reset-size6 size5">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.6599970000000001em;vertical-align:-0.135em;"></span><span class="mord sizing reset-size6 size5"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2796266666666667em;"><span style="top:-2.45em;margin-left:0em;margin-right:0.05555555555555556em;"><span class="pstrut" style="height:2.6em;"></span><span class="sizing reset-size5 size2 mtight"><span class="mord mtight"><span class="mord mtight">2</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin sizing reset-size6 size5">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.6599970000000001em;vertical-align:-0.135em;"></span><span class="mord sizing reset-size6 size5"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2796266666666667em;"><span style="top:-2.45em;margin-left:0em;margin-right:0.05555555555555556em;"><span class="pstrut" style="height:2.6em;"></span><span class="sizing reset-size5 size2 mtight"><span class="mord mtight">3</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin sizing reset-size6 size5">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.599994em;vertical-align:-0.07499700000000001em;"></span><span class="minner sizing reset-size6 size5">…</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin sizing reset-size6 size5">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.776661em;vertical-align:-0.25166400000000005em;"></span><span class="mord sizing reset-size6 size5"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2796266666666667em;"><span style="top:-2.45em;margin-left:0em;margin-right:0.05555555555555556em;"><span class="pstrut" style="height:2.6em;"></span><span class="sizing reset-size5 size2 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">p</span><span class="mbin mtight">−</span><span class="mord mtight">2</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2796266666666667em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin sizing reset-size6 size5">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.6391680000000001em;vertical-align:-0.25166400000000005em;"></span><span class="mord sizing reset-size6 size5"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2796266666666667em;"><span style="top:-2.45em;margin-left:0em;margin-right:0.05555555555555556em;"><span class="pstrut" style="height:2.6em;"></span><span class="sizing reset-size5 size2 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">p</span><span class="mbin mtight">−</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2796266666666667em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel sizing reset-size6 size5">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.5625em;vertical-align:-0.174996em;"></span><span class="mord mathnormal sizing reset-size6 size5" style="margin-right:0.03588em;">y</span></span></span></span></span><span>﻿</span></span></p><p id="8887ef12-e734-4833-a507-f0a4eb2aa8ee" class=""><style>@import url('https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.13.2/katex.min.css')</style><span data-token-index="0" contenteditable="false" class="notion-text-equation-token" style="user-select:all;-webkit-user-select:all;-moz-user-select:all"><span></span><span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mstyle mathsize="0.9em"><mo stretchy="false">(</mo><msub><mi>x</mi><mn>0</mn></msub><mo>+</mo><msub><mi>x</mi><mn>1</mn></msub><mo stretchy="false">)</mo><mo>+</mo><mo stretchy="false">(</mo><msub><mi>x</mi><mn>2</mn></msub><mo>+</mo><msub><mi>x</mi><mn>3</mn></msub><mo stretchy="false">)</mo><mo>+</mo><mo>…</mo><mo>+</mo><mo stretchy="false">(</mo><msub><mi>x</mi><mrow><mi>p</mi><mo>−</mo><mn>2</mn></mrow></msub><mo>+</mo><msub><mi>x</mi><mrow><mi>p</mi><mo>−</mo><mn>1</mn></mrow></msub><mo stretchy="false">)</mo><mo>=</mo><mi>y</mi></mstyle></mrow><annotation encoding="application/x-tex">\small (x_{0}+x_{1})+(x_{2}+x_3)+\ldots+(x_{p-2}+x_{p-1})=y</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.9em;vertical-align:-0.225em;"></span><span class="mopen sizing reset-size6 size5">(</span><span class="mord sizing reset-size6 size5"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2796266666666667em;"><span style="top:-2.45em;margin-left:0em;margin-right:0.05555555555555556em;"><span class="pstrut" style="height:2.6em;"></span><span class="sizing reset-size5 size2 mtight"><span class="mord mtight"><span class="mord mtight">0</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin sizing reset-size6 size5">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.9em;vertical-align:-0.225em;"></span><span class="mord sizing reset-size6 size5"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2796266666666667em;"><span style="top:-2.45em;margin-left:0em;margin-right:0.05555555555555556em;"><span class="pstrut" style="height:2.6em;"></span><span class="sizing reset-size5 size2 mtight"><span class="mord mtight"><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose sizing reset-size6 size5">)</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin sizing reset-size6 size5">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.9em;vertical-align:-0.225em;"></span><span class="mopen sizing reset-size6 size5">(</span><span class="mord sizing reset-size6 size5"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2796266666666667em;"><span style="top:-2.45em;margin-left:0em;margin-right:0.05555555555555556em;"><span class="pstrut" style="height:2.6em;"></span><span class="sizing reset-size5 size2 mtight"><span class="mord mtight"><span class="mord mtight">2</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin sizing reset-size6 size5">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.9em;vertical-align:-0.225em;"></span><span class="mord sizing reset-size6 size5"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2796266666666667em;"><span style="top:-2.45em;margin-left:0em;margin-right:0.05555555555555556em;"><span class="pstrut" style="height:2.6em;"></span><span class="sizing reset-size5 size2 mtight"><span class="mord mtight">3</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose sizing reset-size6 size5">)</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin sizing reset-size6 size5">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.599994em;vertical-align:-0.07499700000000001em;"></span><span class="minner sizing reset-size6 size5">…</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin sizing reset-size6 size5">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.9266640000000002em;vertical-align:-0.25166400000000005em;"></span><span class="mopen sizing reset-size6 size5">(</span><span class="mord sizing reset-size6 size5"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2796266666666667em;"><span style="top:-2.45em;margin-left:0em;margin-right:0.05555555555555556em;"><span class="pstrut" style="height:2.6em;"></span><span class="sizing reset-size5 size2 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">p</span><span class="mbin mtight">−</span><span class="mord mtight">2</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2796266666666667em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin sizing reset-size6 size5">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.9266640000000002em;vertical-align:-0.25166400000000005em;"></span><span class="mord sizing reset-size6 size5"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2796266666666667em;"><span style="top:-2.45em;margin-left:0em;margin-right:0.05555555555555556em;"><span class="pstrut" style="height:2.6em;"></span><span class="sizing reset-size5 size2 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">p</span><span class="mbin mtight">−</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2796266666666667em;"><span></span></span></span></span></span></span><span class="mclose sizing reset-size6 size5">)</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel sizing reset-size6 size5">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.5625em;vertical-align:-0.174996em;"></span><span class="mord mathnormal sizing reset-size6 size5" style="margin-right:0.03588em;">y</span></span></span></span></span><span>﻿</span></span></p><p id="6e4b3260-7e92-4864-91a4-f63778e4ff45" class=""><style>@import url('https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.13.2/katex.min.css')</style><span data-token-index="0" contenteditable="false" class="notion-text-equation-token" style="user-select:all;-webkit-user-select:all;-moz-user-select:all"><span></span><span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mstyle mathsize="0.9em"><mo stretchy="false">(</mo><mo stretchy="false">(</mo><msub><mi>x</mi><mn>0</mn></msub><mo>+</mo><msub><mi>x</mi><mn>1</mn></msub><mo stretchy="false">)</mo><mo>+</mo><mo stretchy="false">(</mo><msub><mi>x</mi><mn>2</mn></msub><mo>+</mo><msub><mi>x</mi><mn>3</mn></msub><mo stretchy="false">)</mo><mo stretchy="false">)</mo><mo>+</mo><mo>…</mo><mo>+</mo><mo stretchy="false">(</mo><msub><mi>x</mi><mrow><mi>p</mi><mo>−</mo><mn>2</mn></mrow></msub><mo>+</mo><msub><mi>x</mi><mrow><mi>p</mi><mo>−</mo><mn>1</mn></mrow></msub><mo stretchy="false">)</mo><mo stretchy="false">)</mo><mo>=</mo><mi>y</mi></mstyle></mrow><annotation encoding="application/x-tex">\small ((x_{0}+x_{1})+(x_{2}+x_3))+\ldots+(x_{p-2}+x_{p-1}))=y</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.9em;vertical-align:-0.225em;"></span><span class="mopen sizing reset-size6 size5">((</span><span class="mord sizing reset-size6 size5"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2796266666666667em;"><span style="top:-2.45em;margin-left:0em;margin-right:0.05555555555555556em;"><span class="pstrut" style="height:2.6em;"></span><span class="sizing reset-size5 size2 mtight"><span class="mord mtight"><span class="mord mtight">0</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin sizing reset-size6 size5">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.9em;vertical-align:-0.225em;"></span><span class="mord sizing reset-size6 size5"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2796266666666667em;"><span style="top:-2.45em;margin-left:0em;margin-right:0.05555555555555556em;"><span class="pstrut" style="height:2.6em;"></span><span class="sizing reset-size5 size2 mtight"><span class="mord mtight"><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose sizing reset-size6 size5">)</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin sizing reset-size6 size5">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.9em;vertical-align:-0.225em;"></span><span class="mopen sizing reset-size6 size5">(</span><span class="mord sizing reset-size6 size5"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2796266666666667em;"><span style="top:-2.45em;margin-left:0em;margin-right:0.05555555555555556em;"><span class="pstrut" style="height:2.6em;"></span><span class="sizing reset-size5 size2 mtight"><span class="mord mtight"><span class="mord mtight">2</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin sizing reset-size6 size5">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.9em;vertical-align:-0.225em;"></span><span class="mord sizing reset-size6 size5"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2796266666666667em;"><span style="top:-2.45em;margin-left:0em;margin-right:0.05555555555555556em;"><span class="pstrut" style="height:2.6em;"></span><span class="sizing reset-size5 size2 mtight"><span class="mord mtight">3</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose sizing reset-size6 size5">))</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin sizing reset-size6 size5">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.599994em;vertical-align:-0.07499700000000001em;"></span><span class="minner sizing reset-size6 size5">…</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin sizing reset-size6 size5">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.9266640000000002em;vertical-align:-0.25166400000000005em;"></span><span class="mopen sizing reset-size6 size5">(</span><span class="mord sizing reset-size6 size5"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2796266666666667em;"><span style="top:-2.45em;margin-left:0em;margin-right:0.05555555555555556em;"><span class="pstrut" style="height:2.6em;"></span><span class="sizing reset-size5 size2 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">p</span><span class="mbin mtight">−</span><span class="mord mtight">2</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2796266666666667em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin sizing reset-size6 size5">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.9266640000000002em;vertical-align:-0.25166400000000005em;"></span><span class="mord sizing reset-size6 size5"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2796266666666667em;"><span style="top:-2.45em;margin-left:0em;margin-right:0.05555555555555556em;"><span class="pstrut" style="height:2.6em;"></span><span class="sizing reset-size5 size2 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">p</span><span class="mbin mtight">−</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2796266666666667em;"><span></span></span></span></span></span></span><span class="mclose sizing reset-size6 size5">))</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel sizing reset-size6 size5">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.5625em;vertical-align:-0.174996em;"></span><span class="mord mathnormal sizing reset-size6 size5" style="margin-right:0.03588em;">y</span></span></span></span></span><span>﻿</span></span></p><p id="64f21b45-de2b-4892-b78e-31c036ff5d91" class=""><style>@import url('https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.13.2/katex.min.css')</style><span data-token-index="0" contenteditable="false" class="notion-text-equation-token" style="user-select:all;-webkit-user-select:all;-moz-user-select:all"><span></span><span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo>…</mo></mrow><annotation encoding="application/x-tex">\dots</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.12em;vertical-align:0em;"></span><span class="minner">…</span></span></span></span></span><span>﻿</span></span></p></div></p><p id="92dfa375-75c9-494b-bd3c-091e41d839d0" class=""><mark class="highlight-teal">Creates a binomial tree</mark><div class="indented"><p id="024e4b57-b818-457a-9370-9228b947aa74" class="">Root node is active in every communication round.</p><p id="945f40c7-4dd1-4f93-87ed-ca9e6a1b178e" class="">Time complexity: <style>@import url('https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.13.2/katex.min.css')</style><span data-token-index="0" contenteditable="false" class="notion-text-equation-token" style="user-select:all;-webkit-user-select:all;-moz-user-select:all"><span></span><span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mstyle mathsize="0.9em"><mrow><mo fence="true">(</mo><msub><mrow><mi>log</mi><mo>⁡</mo></mrow><mn>2</mn></msub><mi>p</mi><mo fence="true">)</mo></mrow><mo stretchy="false">(</mo><mi>α</mi><mo>+</mo><mi>β</mi><mi>n</mi><mo>+</mo><mi>y</mi><mi>n</mi><mo stretchy="false">)</mo><mo>=</mo><mi>O</mi><mo stretchy="false">(</mo><msub><mrow><mi>log</mi><mo>⁡</mo></mrow><mn>2</mn></msub><mi>p</mi><mo stretchy="false">)</mo></mstyle></mrow><annotation encoding="application/x-tex">\small  \left(\log _{2} p\right)(\alpha+\beta n+y n) = O(\log_2p)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.2725em;"></span><span class="minner sizing reset-size6 size5"><span class="mopen sizing reset-size5 size6 delimcenter" style="top:0.024999999999999994em;">(</span><span class="mop"><span class="mop">lo<span style="margin-right:0.01389em;">g</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.16852em;"><span style="top:-2.3388933333333335em;margin-right:0.05555555555555556em;"><span class="pstrut" style="height:2.6em;"></span><span class="sizing reset-size5 size2 mtight"><span class="mord mtight"><span class="mord mtight">2</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.26110666666666665em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathnormal">p</span><span class="mclose sizing reset-size5 size6 delimcenter" style="top:0.024999999999999994em;">)</span></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mopen sizing reset-size6 size5">(</span><span class="mord mathnormal sizing reset-size6 size5" style="margin-right:0.0037em;">α</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin sizing reset-size6 size5">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.799992em;vertical-align:-0.174996em;"></span><span class="mord mathnormal sizing reset-size6 size5" style="margin-right:0.05278em;">β</span><span class="mord mathnormal sizing reset-size6 size5">n</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin sizing reset-size6 size5">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.9em;vertical-align:-0.225em;"></span><span class="mord mathnormal sizing reset-size6 size5" style="margin-right:0.03588em;">y</span><span class="mord mathnormal sizing reset-size6 size5">n</span><span class="mclose sizing reset-size6 size5">)</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel sizing reset-size6 size5">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.909996em;vertical-align:-0.23499599999999998em;"></span><span class="mord mathnormal sizing reset-size6 size5" style="margin-right:0.02778em;">O</span><span class="mopen sizing reset-size6 size5">(</span><span class="mop sizing reset-size6 size5"><span class="mop">lo<span style="margin-right:0.01389em;">g</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.16852em;"><span style="top:-2.3388933333333335em;margin-right:0.05555555555555556em;"><span class="pstrut" style="height:2.6em;"></span><span class="sizing reset-size5 size2 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.26110666666666665em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathnormal sizing reset-size6 size5">p</span><span class="mclose sizing reset-size6 size5">)</span></span></span></span></span><span>﻿</span></span></p><figure id="dc29bb9b-951f-4598-b3cc-acad0bc5fb45" class="image"><a href="MPI%2072068f7d370a4815972d9621a10519f0/Untitled%2037.png"><img style="width:144px" src="MPI%2072068f7d370a4815972d9621a10519f0/Untitled%2037.png"/></a></figure><p id="8624875f-af3e-4772-bba9-a92898065497" class=""><style>@import url('https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.13.2/katex.min.css')</style><span data-token-index="0" contenteditable="false" class="notion-text-equation-token" style="user-select:all;-webkit-user-select:all;-moz-user-select:all"><span></span><span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mstyle mathsize="0.9em"><mi>r</mi><mo>=</mo><msub><mrow><mi>log</mi><mo>⁡</mo></mrow><mn>2</mn></msub><mi>p</mi></mstyle></mrow><annotation encoding="application/x-tex">\small r=\log _{2} p</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.387504em;vertical-align:0em;"></span><span class="mord mathnormal sizing reset-size6 size5" style="margin-right:0.02778em;">r</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel sizing reset-size6 size5">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.859992em;vertical-align:-0.23499599999999998em;"></span><span class="mop sizing reset-size6 size5"><span class="mop">lo<span style="margin-right:0.01389em;">g</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.16852em;"><span style="top:-2.3388933333333335em;margin-right:0.05555555555555556em;"><span class="pstrut" style="height:2.6em;"></span><span class="sizing reset-size5 size2 mtight"><span class="mord mtight"><span class="mord mtight">2</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.26110666666666665em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathnormal sizing reset-size6 size5">p</span></span></span></span></span><span>﻿</span></span></p><p id="2e4382fd-3a57-40ce-ac9a-c48867e25142" class="">total levels = <style>@import url('https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.13.2/katex.min.css')</style><span data-token-index="0" contenteditable="false" class="notion-text-equation-token" style="user-select:all;-webkit-user-select:all;-moz-user-select:all"><span></span><span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mstyle mathsize="0.9em"><mi>r</mi><mo>+</mo><mn>1</mn></mstyle></mrow><annotation encoding="application/x-tex">\small r + 1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.599994em;vertical-align:-0.07499700000000001em;"></span><span class="mord mathnormal sizing reset-size6 size5" style="margin-right:0.02778em;">r</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin sizing reset-size6 size5">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.5799960000000001em;vertical-align:0em;"></span><span class="mord sizing reset-size6 size5">1</span></span></span></span></span><span>﻿</span></span></p><p id="1a304cb0-ddcc-4c49-92bb-46401dffe291" class="">Number of nodes at level <style>@import url('https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.13.2/katex.min.css')</style><span data-token-index="0" contenteditable="false" class="notion-text-equation-token" style="user-select:all;-webkit-user-select:all;-moz-user-select:all"><span></span><span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mstyle mathsize="0.9em"><mi>k</mi></mstyle></mrow><annotation encoding="application/x-tex">\small k</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.624996em;vertical-align:0em;"></span><span class="mord mathnormal sizing reset-size6 size5" style="margin-right:0.03148em;">k</span></span></span></span></span><span>﻿</span></span> where <style>@import url('https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.13.2/katex.min.css')</style><span data-token-index="0" contenteditable="false" class="notion-text-equation-token" style="user-select:all;-webkit-user-select:all;-moz-user-select:all"><span></span><span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mstyle mathsize="0.9em"><mn>0</mn><mo>≤</mo><mi>k</mi><mo>≤</mo><mi>r</mi></mstyle></mrow><annotation encoding="application/x-tex">\small 0 \leq k \leq r</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.702369em;vertical-align:-0.12237300000000001em;"></span><span class="mord sizing reset-size6 size5">0</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel sizing reset-size6 size5">≤</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.747369em;vertical-align:-0.12237300000000001em;"></span><span class="mord mathnormal sizing reset-size6 size5" style="margin-right:0.03148em;">k</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel sizing reset-size6 size5">≤</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.387504em;vertical-align:0em;"></span><span class="mord mathnormal sizing reset-size6 size5" style="margin-right:0.02778em;">r</span></span></span></span></span><span>﻿</span></span>: <style>@import url('https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.13.2/katex.min.css')</style><span data-token-index="0" contenteditable="false" class="notion-text-equation-token" style="user-select:all;-webkit-user-select:all;-moz-user-select:all"><span></span><span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mstyle mathsize="0.9em"><mstyle mathsize="1.2em"><mrow><mo fence="true">(</mo><mfrac linethickness="0px"><mrow><mtext> </mtext><mi>r</mi><mtext> </mtext></mrow><mrow><mtext> </mtext><mi>k</mi><mtext> </mtext></mrow></mfrac><mo fence="true">)</mo></mrow><mstyle mathsize="0.9em"><mo>=</mo><mi>r</mi><mo stretchy="false">!</mo><mi mathvariant="normal">/</mi><mo stretchy="false">(</mo><mo stretchy="false">(</mo><mi>r</mi><mo>−</mo><mi>k</mi><mo stretchy="false">)</mo><mo stretchy="false">!</mo><mi>k</mi><mo stretchy="false">!</mo><mo stretchy="false">)</mo></mstyle></mstyle></mstyle></mrow><annotation encoding="application/x-tex">\small \large\binom{~r~}{~k~}\small  =r ! /((r-k) ! k !)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.324em;vertical-align:-0.414em;"></span><span class="mord sizing reset-size6 size7"><span class="mopen sizing reset-size7 size6 delimcenter" style="top:-0.04999999999999999em;"><span class="delimsizing size1">(</span></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.7310399999999999em;"><span style="top:-2.455em;"><span class="pstrut" style="height:2.8em;"></span><span class="sizing reset-size7 size4 mtight"><span class="mord mtight"><span class="mspace nobreak mtight"><span class="mtight"> </span></span><span class="mord mathnormal mtight" style="margin-right:0.03148em;">k</span><span class="mspace nobreak mtight"><span class="mtight"> </span></span></span></span></span><span style="top:-3.2439999999999998em;"><span class="pstrut" style="height:2.8em;"></span><span class="sizing reset-size7 size4 mtight"><span class="mord mtight"><span class="mspace nobreak mtight"><span class="mtight"> </span></span><span class="mord mathnormal mtight" style="margin-right:0.02778em;">r</span><span class="mspace nobreak mtight"><span class="mtight"> </span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.345em;"><span></span></span></span></span></span><span class="mclose sizing reset-size7 size6 delimcenter" style="top:-0.04999999999999999em;"><span class="delimsizing size1">)</span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel sizing reset-size6 size5">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.9em;vertical-align:-0.225em;"></span><span class="mord mathnormal sizing reset-size6 size5" style="margin-right:0.02778em;">r</span><span class="mclose sizing reset-size6 size5">!</span><span class="mord sizing reset-size6 size5">/</span><span class="mopen sizing reset-size6 size5">((</span><span class="mord mathnormal sizing reset-size6 size5" style="margin-right:0.02778em;">r</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin sizing reset-size6 size5">−</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.9em;vertical-align:-0.225em;"></span><span class="mord mathnormal sizing reset-size6 size5" style="margin-right:0.03148em;">k</span><span class="mclose sizing reset-size6 size5">)!</span><span class="mord mathnormal sizing reset-size6 size5" style="margin-right:0.03148em;">k</span><span class="mclose sizing reset-size6 size5">!)</span></span></span></span></span><span>﻿</span></span></p></div></p><p id="57b78bd2-3f1f-4716-b5d3-955e29c6ec83" class="">
</p><p id="6bcc7465-14ec-42c8-98c0-7c4968d8eb01" class=""><mark class="highlight-teal">Algorithm</mark><div class="indented"><pre id="01868ee9-b3ff-4c97-bf36-68e42f29fcbb" class="code"><code>bit = 0x1;

while ((rank&amp;bit)==0x0 &amp; bit&lt;size) {
	&lt;receive from rank|bit&gt; // bit set
	bit &lt;&lt;= 1; // shift right
}
&lt;send to rank | (~bit)&gt; // mask out bit</code></pre><figure id="33f88839-5bb9-4448-bde5-a1a5a801576f" class="image"><a href="MPI%2072068f7d370a4815972d9621a10519f0/Untitled%2038.png"><img style="width:288px" src="MPI%2072068f7d370a4815972d9621a10519f0/Untitled%2038.png"/></a></figure></div></p></details></li></ul></div></p><figure id="32855772-3730-489d-8edf-620fa79e49bb" class="image"><a href="MPI%2072068f7d370a4815972d9621a10519f0/Untitled%2039.png"><img style="width:84px" src="MPI%2072068f7d370a4815972d9621a10519f0/Untitled%2039.png"/></a></figure><p id="4378a5e4-5953-431d-b223-c4b264525353" class="">
</p><p id="99144128-b86c-4ad5-8b31-e569f9aa3f14" class=""><mark class="highlight-blue">Allreduce</mark><div class="indented"><pre id="695842b0-61f7-4464-9365-b04e5b88511d" class="code"><code>MPI_Allreduce(sbuf,rbuf,count,type,op,comm);</code></pre><p id="8a35b351-ccfe-4816-b69f-0c966647b812" class="">Elementwise result stored in <mark class="highlight-gray"><code>rbuf</code></mark><mark class="highlight-gray"> </mark>in every process.</p><p id="eae27b6a-19f2-4225-8f37-1072dd921b9c" class="">If <mark class="highlight-gray"><code>MPI_IN_PLACE</code></mark><mark class="highlight-gray"> </mark>as argument for <mark class="highlight-gray"><code>sbuf</code></mark>, then input is taken from <mark class="highlight-gray"><code>rbuf</code></mark>. </p></div></p><figure id="ff9170fe-b34f-41d5-8344-ddcc7eaf3cef" class="image"><a href="MPI%2072068f7d370a4815972d9621a10519f0/Untitled%2040.png"><img style="width:96px" src="MPI%2072068f7d370a4815972d9621a10519f0/Untitled%2040.png"/></a></figure><p id="3a0ae608-8257-478b-8cbd-05ac9c1fa3c4" class="">
</p><p id="918ed40d-0019-4161-a414-aa2b72c5f19c" class=""><mark class="highlight-blue">Reduce_scatter_block</mark><div class="indented"><pre id="8cc73a2d-8412-4b42-bf00-934236560f92" class="code"><code>MPI_Reduce_scatter_block(sbuf,rbuf,count,type,op,comm);</code></pre><ul id="6e1c53d9-e9aa-4ac4-beff-802b64117316" class="toggle"><li><details open=""><summary>Alternative</summary><p id="fd25d0f7-7073-4240-a2e5-7f4ecf160b0e" class="">Can also be expressed through <mark class="highlight-gray"><code>Reduce_scatter</code></mark></p><p id="bc04ccc1-46f8-485f-a069-846098fc7e65" class="">Here we took an arbitrary size for the counts.</p><pre id="4c3bd14f-b920-4cf0-90cb-562efcad19d9" class="code"><code>MPI_Reduce_scatter_block(partial,result,n/p,MPI_FLOAT,MPI_SUM,comm);</code></pre><pre id="314a5ea4-7abb-4856-9757-6a828773d069" class="code"><code>for (i=0; i&lt;p; i++) counts[i] = n/p;
MPI_Reduce_scatter(partial,result,counts,MPI_FLOAT,MPI_SUM,comm);</code></pre><p id="9bc292a3-6a2c-4f39-83f7-b1f5090bee94" class="">
</p></details></li></ul><p id="758cab6b-63d7-4e79-a05f-ed57bd00a7de" class="">Elementwise result is scattered in same sized blocks, stored in <mark class="highlight-gray"><code>rbuf</code></mark><mark class="highlight-gray"> </mark>for every process.</p><p id="cea6cbfd-c459-4303-9239-0db9cd0769b4" class="">If <mark class="highlight-gray"><code>MPI_IN_PLACE</code></mark><mark class="highlight-gray"> </mark>as argument for <mark class="highlight-gray"><code>sbuf</code></mark>, then input is taken from <mark class="highlight-gray"><code>rbuf</code></mark>.</p><hr id="1d47f781-fc5e-4aca-8a72-88b80f416be1"/><figure id="aa738dc7-7795-4d34-9bc8-abe67aa7d7f6" class="link-to-page"><a href="MPI%2072068f7d370a4815972d9621a10519f0/Matrix-Vector%20multiplication%20aa738dc777954d349bc8abe67aa7d7f6.html"><span class="icon">📎</span>Matrix-Vector multiplication</a></figure></div></p><figure id="a546afc0-5b28-46f3-ac73-3d8e35fbe581" class="image"><a href="MPI%2072068f7d370a4815972d9621a10519f0/Untitled%2041.png"><img style="width:192px" src="MPI%2072068f7d370a4815972d9621a10519f0/Untitled%2041.png"/></a></figure><p id="51131d28-f077-4bd1-bcbe-2da9c6bcb778" class="">
</p><p id="c3550222-5110-4048-9a8b-4ecdfff8789d" class=""><mark class="highlight-blue">Reduce_scatter</mark><div class="indented"><pre id="c0be8579-e066-4e32-b8f8-a8ef86833c8b" class="code"><code>MPI_Reduce_scatter(sbuf,rbuf,counts,type,op,comm);</code></pre><p id="99c9ecfa-0ba8-455d-a2d5-7017eda0f75b" class="">Same as <mark class="highlight-gray"><code>Reduce_scatter_block</code></mark><mark class="highlight-gray"> </mark>but the block-sizes can differ.<div class="indented"><p id="eea4e501-1bae-4f6f-a07e-ba5e710315c2" class="">All processes must have the same <mark class="highlight-gray"><code>counts[]</code></mark>.</p></div></p><p id="ef7c0c18-5971-4773-be93-af086233c9c9" class="">If <mark class="highlight-gray"><code>MPI_IN_PLACE</code></mark><mark class="highlight-gray"> </mark>as argument for <mark class="highlight-gray"><code>sbuf</code></mark>, then input is taken from <mark class="highlight-gray"><code>rbuf</code></mark>. </p></div></p><figure id="6da369be-b264-441d-aa40-c4d57c93f2b0" class="image"><a href="MPI%2072068f7d370a4815972d9621a10519f0/Untitled%2042.png"><img style="width:192px" src="MPI%2072068f7d370a4815972d9621a10519f0/Untitled%2042.png"/></a></figure><p id="c45d23f7-c7e4-4a6f-a5cf-5a1fdd8ad20f" class="">
</p><h2 id="dd1f3af5-47eb-4b8d-bfdd-372b89fa066b" class="">Scan collectives</h2><p id="33b1cc8b-757c-4c2f-88a6-3363fb393d2f" class=""><em><mark class="highlight-blue">About scan collectives</mark></em><div class="indented"><ul id="c74440c3-f270-4cea-9904-e2288e91f686" class="bulleted-list"><li style="list-style-type:disc">Each process has vector of data <style>@import url('https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.13.2/katex.min.css')</style><span data-token-index="0" contenteditable="false" class="notion-text-equation-token" style="user-select:all;-webkit-user-select:all;-moz-user-select:all"><span></span><span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mstyle mathsize="0.9em"><mover accent="true"><mi>x</mi><mo>⃗</mo></mover></mstyle></mrow><annotation encoding="application/x-tex">\small \vec x</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6426em;vertical-align:0em;"></span><span class="mord accent sizing reset-size6 size5"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.714em;"><span style="top:-2.9em;"><span class="pstrut" style="height:2.9em;"></span><span class="mord mathnormal">x</span></span><span style="top:-2.9em;"><span class="pstrut" style="height:2.9em;"></span><span class="accent-body" style="left:-0.20772em;"><span class="overlay" style="height:0.714em;width:0.471em;"><svg width='0.471em' height='0.714em' style='width:0.471em' viewBox='0 0 471 714' preserveAspectRatio='xMinYMin'><path d='M377 20c0-5.333 1.833-10 5.5-14S391 0 397 0c4.667 0 8.667 1.667 12 5
3.333 2.667 6.667 9 10 19 6.667 24.667 20.333 43.667 41 57 7.333 4.667 11
10.667 11 18 0 6-1 10-3 12s-6.667 5-14 9c-28.667 14.667-53.667 35.667-75 63
-1.333 1.333-3.167 3.5-5.5 6.5s-4 4.833-5 5.5c-1 .667-2.5 1.333-4.5 2s-4.333 1
-7 1c-4.667 0-9.167-1.833-13.5-5.5S337 184 337 178c0-12.667 15.667-32.333 47-59
H213l-171-1c-8.667-6-13-12.333-13-19 0-4.667 4.333-11.333 13-20h359
c-16-25.333-24-45-24-59z'/></svg></span></span></span></span></span></span></span></span></span></span></span><span>﻿</span></span> (same size, same type)</li></ul><ul id="4685d04d-9332-49f7-bc44-49691145b7d0" class="bulleted-list"><li style="list-style-type:disc">Associative operation <style>@import url('https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.13.2/katex.min.css')</style><span data-token-index="0" contenteditable="false" class="notion-text-equation-token" style="user-select:all;-webkit-user-select:all;-moz-user-select:all"><span></span><span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mstyle mathsize="0.9em"><mo>+</mo></mstyle></mrow><annotation encoding="application/x-tex">\small +</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.599994em;vertical-align:-0.07499700000000001em;"></span><span class="mord sizing reset-size6 size5">+</span></span></span></span></span><span>﻿</span></span> (built in MPI or user defined)<p id="e69e81de-2daa-4302-9533-b4b6bbf04be6" class="">for element wise calculation of prefix sums <style>@import url('https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.13.2/katex.min.css')</style><span data-token-index="0" contenteditable="false" class="notion-text-equation-token" style="user-select:all;-webkit-user-select:all;-moz-user-select:all"><span></span><span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mstyle mathsize="0.9em"><msub><mi>y</mi><mi>i</mi></msub><mo>=</mo><msub><mover accent="true"><mi>x</mi><mo>⃗</mo></mover><mn>0</mn></msub><mo>+</mo><msub><mover accent="true"><mi>x</mi><mo>⃗</mo></mover><mn>1</mn></msub><mo>+</mo><msub><mover accent="true"><mi>x</mi><mo>⃗</mo></mover><mn>2</mn></msub><mo>+</mo><mo>…</mo><mo>+</mo><msub><mover accent="true"><mi>x</mi><mo>⃗</mo></mover><mrow><mi>p</mi><mo>−</mo><mn>1</mn></mrow></msub></mstyle></mrow><annotation encoding="application/x-tex">\small  y_i = \vec x_0+\vec x_1+\vec x_2+ … +\vec x_{p-1}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.5625em;vertical-align:-0.174996em;"></span><span class="mord sizing reset-size6 size5"><span class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.28967999999999994em;"><span style="top:-2.45em;margin-left:-0.03588em;margin-right:0.05555555555555556em;"><span class="pstrut" style="height:2.6em;"></span><span class="sizing reset-size5 size2 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel sizing reset-size6 size5">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.7776em;vertical-align:-0.135em;"></span><span class="mord sizing reset-size6 size5"><span class="mord accent"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.714em;"><span style="top:-2.9em;"><span class="pstrut" style="height:2.9em;"></span><span class="mord mathnormal">x</span></span><span style="top:-2.9em;"><span class="pstrut" style="height:2.9em;"></span><span class="accent-body" style="left:-0.20772em;"><span class="overlay" style="height:0.714em;width:0.471em;"><svg width='0.471em' height='0.714em' style='width:0.471em' viewBox='0 0 471 714' preserveAspectRatio='xMinYMin'><path d='M377 20c0-5.333 1.833-10 5.5-14S391 0 397 0c4.667 0 8.667 1.667 12 5
3.333 2.667 6.667 9 10 19 6.667 24.667 20.333 43.667 41 57 7.333 4.667 11
10.667 11 18 0 6-1 10-3 12s-6.667 5-14 9c-28.667 14.667-53.667 35.667-75 63
-1.333 1.333-3.167 3.5-5.5 6.5s-4 4.833-5 5.5c-1 .667-2.5 1.333-4.5 2s-4.333 1
-7 1c-4.667 0-9.167-1.833-13.5-5.5S337 184 337 178c0-12.667 15.667-32.333 47-59
H213l-171-1c-8.667-6-13-12.333-13-19 0-4.667 4.333-11.333 13-20h359
c-16-25.333-24-45-24-59z'/></svg></span></span></span></span></span></span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2796266666666667em;"><span style="top:-2.45em;margin-left:0em;margin-right:0.05555555555555556em;"><span class="pstrut" style="height:2.6em;"></span><span class="sizing reset-size5 size2 mtight"><span class="mord mtight">0</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin sizing reset-size6 size5">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.7776em;vertical-align:-0.135em;"></span><span class="mord sizing reset-size6 size5"><span class="mord accent"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.714em;"><span style="top:-2.9em;"><span class="pstrut" style="height:2.9em;"></span><span class="mord mathnormal">x</span></span><span style="top:-2.9em;"><span class="pstrut" style="height:2.9em;"></span><span class="accent-body" style="left:-0.20772em;"><span class="overlay" style="height:0.714em;width:0.471em;"><svg width='0.471em' height='0.714em' style='width:0.471em' viewBox='0 0 471 714' preserveAspectRatio='xMinYMin'><path d='M377 20c0-5.333 1.833-10 5.5-14S391 0 397 0c4.667 0 8.667 1.667 12 5
3.333 2.667 6.667 9 10 19 6.667 24.667 20.333 43.667 41 57 7.333 4.667 11
10.667 11 18 0 6-1 10-3 12s-6.667 5-14 9c-28.667 14.667-53.667 35.667-75 63
-1.333 1.333-3.167 3.5-5.5 6.5s-4 4.833-5 5.5c-1 .667-2.5 1.333-4.5 2s-4.333 1
-7 1c-4.667 0-9.167-1.833-13.5-5.5S337 184 337 178c0-12.667 15.667-32.333 47-59
H213l-171-1c-8.667-6-13-12.333-13-19 0-4.667 4.333-11.333 13-20h359
c-16-25.333-24-45-24-59z'/></svg></span></span></span></span></span></span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2796266666666667em;"><span style="top:-2.45em;margin-left:0em;margin-right:0.05555555555555556em;"><span class="pstrut" style="height:2.6em;"></span><span class="sizing reset-size5 size2 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin sizing reset-size6 size5">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.7776em;vertical-align:-0.135em;"></span><span class="mord sizing reset-size6 size5"><span class="mord accent"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.714em;"><span style="top:-2.9em;"><span class="pstrut" style="height:2.9em;"></span><span class="mord mathnormal">x</span></span><span style="top:-2.9em;"><span class="pstrut" style="height:2.9em;"></span><span class="accent-body" style="left:-0.20772em;"><span class="overlay" style="height:0.714em;width:0.471em;"><svg width='0.471em' height='0.714em' style='width:0.471em' viewBox='0 0 471 714' preserveAspectRatio='xMinYMin'><path d='M377 20c0-5.333 1.833-10 5.5-14S391 0 397 0c4.667 0 8.667 1.667 12 5
3.333 2.667 6.667 9 10 19 6.667 24.667 20.333 43.667 41 57 7.333 4.667 11
10.667 11 18 0 6-1 10-3 12s-6.667 5-14 9c-28.667 14.667-53.667 35.667-75 63
-1.333 1.333-3.167 3.5-5.5 6.5s-4 4.833-5 5.5c-1 .667-2.5 1.333-4.5 2s-4.333 1
-7 1c-4.667 0-9.167-1.833-13.5-5.5S337 184 337 178c0-12.667 15.667-32.333 47-59
H213l-171-1c-8.667-6-13-12.333-13-19 0-4.667 4.333-11.333 13-20h359
c-16-25.333-24-45-24-59z'/></svg></span></span></span></span></span></span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2796266666666667em;"><span style="top:-2.45em;margin-left:0em;margin-right:0.05555555555555556em;"><span class="pstrut" style="height:2.6em;"></span><span class="sizing reset-size5 size2 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin sizing reset-size6 size5">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.599994em;vertical-align:-0.07499700000000001em;"></span><span class="minner sizing reset-size6 size5">…</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin sizing reset-size6 size5">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.894264em;vertical-align:-0.25166400000000005em;"></span><span class="mord sizing reset-size6 size5"><span class="mord accent"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.714em;"><span style="top:-2.9em;"><span class="pstrut" style="height:2.9em;"></span><span class="mord mathnormal">x</span></span><span style="top:-2.9em;"><span class="pstrut" style="height:2.9em;"></span><span class="accent-body" style="left:-0.20772em;"><span class="overlay" style="height:0.714em;width:0.471em;"><svg width='0.471em' height='0.714em' style='width:0.471em' viewBox='0 0 471 714' preserveAspectRatio='xMinYMin'><path d='M377 20c0-5.333 1.833-10 5.5-14S391 0 397 0c4.667 0 8.667 1.667 12 5
3.333 2.667 6.667 9 10 19 6.667 24.667 20.333 43.667 41 57 7.333 4.667 11
10.667 11 18 0 6-1 10-3 12s-6.667 5-14 9c-28.667 14.667-53.667 35.667-75 63
-1.333 1.333-3.167 3.5-5.5 6.5s-4 4.833-5 5.5c-1 .667-2.5 1.333-4.5 2s-4.333 1
-7 1c-4.667 0-9.167-1.833-13.5-5.5S337 184 337 178c0-12.667 15.667-32.333 47-59
H213l-171-1c-8.667-6-13-12.333-13-19 0-4.667 4.333-11.333 13-20h359
c-16-25.333-24-45-24-59z'/></svg></span></span></span></span></span></span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2796266666666667em;"><span style="top:-2.45em;margin-left:0em;margin-right:0.05555555555555556em;"><span class="pstrut" style="height:2.6em;"></span><span class="sizing reset-size5 size2 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">p</span><span class="mbin mtight">−</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2796266666666667em;"><span></span></span></span></span></span></span></span></span></span></span><span>﻿</span></span></p><p id="f7a8d6c1-4042-4b27-ba0d-2e5ac77cef42" class=""><mark class="highlight-gray"><em>associative means brackets don’t influence result </em></mark><mark class="highlight-gray"><em><style>@import url('https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.13.2/katex.min.css')</style><span data-token-index="0" contenteditable="false" class="notion-text-equation-token" style="user-select:all;-webkit-user-select:all;-moz-user-select:all"><span></span><span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mstyle mathsize="0.9em"><mo stretchy="false">(</mo><mi>a</mi><mo>+</mo><mi>b</mi><mo stretchy="false">)</mo><mo>+</mo><mi>c</mi><mo>=</mo><mi>a</mi><mo>+</mo><mo stretchy="false">(</mo><mi>b</mi><mo>+</mo><mi>c</mi><mo stretchy="false">)</mo></mstyle></mrow><annotation encoding="application/x-tex">\small (a + b) + c = a + (b + c)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.9em;vertical-align:-0.225em;"></span><span class="mopen sizing reset-size6 size5">(</span><span class="mord mathnormal sizing reset-size6 size5">a</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin sizing reset-size6 size5">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.9em;vertical-align:-0.225em;"></span><span class="mord mathnormal sizing reset-size6 size5">b</span><span class="mclose sizing reset-size6 size5">)</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin sizing reset-size6 size5">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.387504em;vertical-align:0em;"></span><span class="mord mathnormal sizing reset-size6 size5">c</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel sizing reset-size6 size5">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.599994em;vertical-align:-0.07499700000000001em;"></span><span class="mord mathnormal sizing reset-size6 size5">a</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin sizing reset-size6 size5">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.9em;vertical-align:-0.225em;"></span><span class="mopen sizing reset-size6 size5">(</span><span class="mord mathnormal sizing reset-size6 size5">b</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin sizing reset-size6 size5">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.9em;vertical-align:-0.225em;"></span><span class="mord mathnormal sizing reset-size6 size5">c</span><span class="mclose sizing reset-size6 size5">)</span></span></span></span></span><span>﻿</span></span></em></mark></p></li></ul><ul id="bc823399-ab31-4489-b418-97602b9e0bed" class="bulleted-list"><li style="list-style-type:disc">stored in<p id="9a521931-89d6-4789-9676-2297b0fef812" class=""><mark class="highlight-gray"><code>MPI_Scan</code></mark><mark class="highlight-gray"> </mark>	<style>@import url('https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.13.2/katex.min.css')</style><span data-token-index="0" contenteditable="false" class="notion-text-equation-token" style="user-select:all;-webkit-user-select:all;-moz-user-select:all"><span></span><span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mstyle mathsize="0.9em"><msub><mi>y</mi><mi>i</mi></msub></mstyle></mrow><annotation encoding="application/x-tex">\small  y_i</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.5625em;vertical-align:-0.174996em;"></span><span class="mord sizing reset-size6 size5"><span class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.28967999999999994em;"><span style="top:-2.45em;margin-left:-0.03588em;margin-right:0.05555555555555556em;"><span class="pstrut" style="height:2.6em;"></span><span class="sizing reset-size5 size2 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span></span><span>﻿</span></span><style>@import url('https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.13.2/katex.min.css')</style><span data-token-index="0" contenteditable="false" class="notion-text-equation-token" style="user-select:all;-webkit-user-select:all;-moz-user-select:all"><span></span><span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mstyle mathsize="0.9em"></mstyle></mrow><annotation encoding="application/x-tex">\small </annotation></semantics></math></span><span class="katex-html" aria-hidden="true"></span></span></span><span>﻿</span></span> at rank <style>@import url('https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.13.2/katex.min.css')</style><span data-token-index="0" contenteditable="false" class="notion-text-equation-token" style="user-select:all;-webkit-user-select:all;-moz-user-select:all"><span></span><span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mstyle mathsize="0.9em"><mi>i</mi></mstyle></mrow><annotation encoding="application/x-tex">\small i</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.593568em;vertical-align:0em;"></span><span class="mord mathnormal sizing reset-size6 size5">i</span></span></span></span></span><span>﻿</span></span></p><p id="cc4ae2d5-296e-429c-a90e-b2a35984839d" class=""><mark class="highlight-gray"><code>MPI_Exscan</code></mark> 	<style>@import url('https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.13.2/katex.min.css')</style><span data-token-index="0" contenteditable="false" class="notion-text-equation-token" style="user-select:all;-webkit-user-select:all;-moz-user-select:all"><span></span><span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mstyle mathsize="0.9em"><msub><mi>y</mi><mi>i</mi></msub></mstyle></mrow><annotation encoding="application/x-tex">\small  y_i</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.5625em;vertical-align:-0.174996em;"></span><span class="mord sizing reset-size6 size5"><span class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.28967999999999994em;"><span style="top:-2.45em;margin-left:-0.03588em;margin-right:0.05555555555555556em;"><span class="pstrut" style="height:2.6em;"></span><span class="sizing reset-size5 size2 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span></span><span>﻿</span></span><style>@import url('https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.13.2/katex.min.css')</style><span data-token-index="0" contenteditable="false" class="notion-text-equation-token" style="user-select:all;-webkit-user-select:all;-moz-user-select:all"><span></span><span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mstyle mathsize="0.9em"></mstyle></mrow><annotation encoding="application/x-tex">\small </annotation></semantics></math></span><span class="katex-html" aria-hidden="true"></span></span></span><span>﻿</span></span> at rank <style>@import url('https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.13.2/katex.min.css')</style><span data-token-index="0" contenteditable="false" class="notion-text-equation-token" style="user-select:all;-webkit-user-select:all;-moz-user-select:all"><span></span><span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mstyle mathsize="0.9em"><mi>i</mi><mo>+</mo><mn>1</mn></mstyle></mrow><annotation encoding="application/x-tex">\small i+1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.668565em;vertical-align:-0.07499700000000001em;"></span><span class="mord mathnormal sizing reset-size6 size5">i</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin sizing reset-size6 size5">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.5799960000000001em;vertical-align:0em;"></span><span class="mord sizing reset-size6 size5">1</span></span></span></span></span><span>﻿</span></span> (undefined for rank <style>@import url('https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.13.2/katex.min.css')</style><span data-token-index="0" contenteditable="false" class="notion-text-equation-token" style="user-select:all;-webkit-user-select:all;-moz-user-select:all"><span></span><span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mstyle mathsize="0.9em"><mn>0</mn></mstyle></mrow><annotation encoding="application/x-tex">\small 0</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.5799960000000001em;vertical-align:0em;"></span><span class="mord sizing reset-size6 size5">0</span></span></span></span></span><span>﻿</span></span>)</p></li></ul></div></p><p id="02a713d6-1a0e-463d-9f3e-49185765fcb3" class="">
</p><p id="0599b2a0-a3ce-497c-9f51-63b36e1fbfdb" class=""><mark class="highlight-blue">Scan (inclusive prefix sum)</mark><div class="indented"><pre id="784c08c5-2cb7-4f93-83fb-18f537482dc4" class="code"><code>MPI_Scan(sbuf,rbuf,count,type,op,comm);</code></pre><p id="273912ed-beb3-4689-b05e-37c267cfba8e" class="">Elementwise prefix sums over <mark class="highlight-gray"><code>sbuf</code></mark><mark class="highlight-gray"> </mark>vectors.</p><p id="e189a49b-6a27-47e5-aa96-51b7ce29c4f2" class="">Rank <mark class="highlight-gray"><code>i</code></mark><mark class="highlight-gray"> </mark>stores sum from rank 0 to i (included).</p></div></p><figure id="aa0b4659-9cd7-43b5-910f-55699a3b0f02" class="image"><a href="MPI%2072068f7d370a4815972d9621a10519f0/Untitled%2043.png"><img style="width:108px" src="MPI%2072068f7d370a4815972d9621a10519f0/Untitled%2043.png"/></a></figure><p id="6f40e6de-9f1a-4b38-9936-5d6d43f14b0c" class="">
</p><p id="5808f3ce-367b-4fad-b729-019aaeec2450" class=""><mark class="highlight-blue">Exscan (exclusive prefix sum)</mark><div class="indented"><pre id="6f8c777a-705f-4f89-89a5-be51c88c25ce" class="code"><code>MPI_Exscan(sbuf,rbuf,count,type,op,comm);</code></pre><p id="186a3162-a009-44d6-a5ab-3b20802a2a9f" class="">Elementwise prefix sums over <mark class="highlight-gray"><code>sbuf</code></mark><mark class="highlight-gray"> </mark>vectors.</p><p id="3c44dcc7-676a-4d2a-81a1-5b7b87650fb8" class="">Rank <mark class="highlight-gray"><code>i</code></mark><mark class="highlight-gray"> </mark>stores sum from rank 0 to i (included).</p><hr id="3e53e2da-0f7e-4240-ae1f-30a879f42835"/><figure id="f1b154b1-cb3c-4aed-b508-9e82a165f9de" class="link-to-page"><a href="MPI%2072068f7d370a4815972d9621a10519f0/Quicksort%20f1b154b1cb3c4aedb5089e82a165f9de.html"><span class="icon">📎</span>Quicksort</a></figure></div></p><figure id="797a6638-4750-48bc-87e4-953899125dd0" class="image"><a href="MPI%2072068f7d370a4815972d9621a10519f0/Untitled%2044.png"><img style="width:108px" src="MPI%2072068f7d370a4815972d9621a10519f0/Untitled%2044.png"/></a></figure><p id="a498c4d7-1338-40d7-9cec-3cda98494d4e" class="">
</p><figure id="a09d4089-1491-4772-95a7-faaadfda2212" class="link-to-page"><a href="MPI%2072068f7d370a4815972d9621a10519f0/Bucket-sort%20a09d40891491477295a7faaadfda2212.html"><span class="icon">📎</span>Bucket-sort</a></figure></div></article></body></html>